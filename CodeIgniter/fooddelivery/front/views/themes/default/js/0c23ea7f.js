"use strict";function makeGetCurrentOrderTime(a){function b(){c="ASAP"===a.orderTime?Date.create():Date.create(a.orderTime)}var c,d=setInterval(b,1e3);return b(),a.$on("$destroy",function(){clearInterval(d)}),function(){return c}}function extractUrlParams(){var a=location.search;a=a.split("+").join(" ");var b,c={},d=/[?&]?([^=]+)=([^&]*)/g;for(b=d.exec(a);b;)c[decodeURIComponent(b[1])]=decodeURIComponent(b[2]),b=d.exec(a);return c}function initAppWithConfig(a,b){var c,d,e="/api",f=null,g=31536e3,h=Cookies;"staging"!==b&&"production"!==b&&(b="staging");var i=extractUrlParams();switch("undefined"!=typeof i.iosVersion?(a="ios",f=i.iosVersion,h("platform",a,{expires:g})):"undefined"!=typeof i.androidVersion?(a="android",f=i.androidVersion,h("platform",a,{expires:g})):h("platform")?a=h("platform"):h("platform",a,{expires:g}),a){case"android":c="YTU1MTdjMWE1YzhjOTBlNjUxYmE4NjAxMjBlMWFjMmM3",d="97D3a046BXH11FATekQWQiV33B7RCC6A8rzHvhyn";break;case"ios":c="YzEwNDM1ODY0Mzc1NjkzNDkzOWUzNDZkYWFmYWU5Zjk5",d="5AFDQtZtTDbOXTuUkwk4Zyid9eqd9SSIAQzkaG3I";break;default:c="MDlkMzY3Nzg3MjU1ZjRkNmY4OWZjNDA0NjBjMTI0MWZl",d="97D3a046BXH11FATekQWQiV33B7RCC6A8rzHvhyn",a="web"}var j={apiKey:c,clientSecret:d,platform:a,environment:b,apiPath:e};switch(b){case"production":j.aboutUsSpreadsheetId="1WuelxYycRpGNEs_CzbP5PolhrrLJSTWj4B4Ff583XXg",Leanplum.setAppIdForProductionMode("app_MdglarogHQJQDHYQL42FAhqC0WRCP8gbd6tdd8VW1zk","prod_bT2QqpykN4vrXVYGsXyK7wrCWMaFGMZRiDmhhoorFMg");break;default:case"staging":j.aboutUsSpreadsheetId="1jsgPlWfnk88Wd6LDlTaTv63tanRSNNhf4IcEVnBFOKs",Leanplum.setAppIdForDevelopmentMode("app_MdglarogHQJQDHYQL42FAhqC0WRCP8gbd6tdd8VW1zk","dev_xoC5El2Gq0cce5aZCWwJIdtLaP4alPqvwAP9buMa6Ik")}null!==f&&(j.appVersion=parseInt(f.replace(/\./g,""),10)),angular.module("dcomApp.config",[]).constant("DcomConfig",j),window.platform=a}angular.module("dcomApp",["ngRoute","ngSanitize","ngTouch","ngClipboard","ui.bootstrap","dcom.directive.dropdown","dcom.directive.datepicker","dcom.directive.carousel","dcom.directive.odometer","dcom.directive.progressbar","dcom.directive.responsiveBackground","dcom.directive.transitionEnd","dcom.service.storage","dcom.service.modal","dcomApp.config","dcomApp.templates","dcomApp.controller.about","dcomApp.controller.merchantSignup","dcomApp.service.device","dcomApp.controller.repeatOrder","dcomApp.controller.repeatOrderCreate"]).config(["$httpProvider","$locationProvider","$provide","$routeProvider","DcomConfig","$compileProvider","DeviceProvider","$tooltipProvider","StorageServiceProvider",function(a,b,c,d,e,f,g,h,i){a.interceptors.push("ConnectionMonitor"),i.setNamespace("dcomApp"),h.options({popupDelay:300,animation:!1}),b.html5Mode(!0).hashPrefix("!"),f.debugInfoEnabled(!1);var j={};j.checkIfUserIsLoggedIn={userLoggedIn:["User",function(a){a.pageRequiresLogin()}]},j.repeatOrderService={LaundryRepeatOrderService:["LaundryRepeatOrderService",function(a){return a}]},j.getRepeatOrders={repeatOrders:["LaundryRepeatOrderService",function(a){return a.getOrders()}]},j.getRepeatOrderDetails={order:["LaundryRepeatOrderService","$route",function(a,b){return a.getOrderDetails(b.current.params.orderId)}]},j.getOrderDetails={order:["OrderAPI","$route",function(a,b){return a.getLaundryOrderWithMinAmount(b.current.params.orderId)}]},j.getPrizes={prizes:["DeliveryPoints",function(a){return a.getPrizes()}]},d.when("/",{templateUrl:"views/home.html",controller:"HomeCtrl",data:{recordScroll:!0},reloadOnSearch:!1,resolve:angular.extend({modalOnLoad:function(){return!1},send404:function(){return!1}},j.getPrizes)}).when("/search",{templateUrl:"views/merchants.html",controller:"MerchantsCtrl",reloadOnSearch:!1}).when("/search/price-compare",{templateUrl:"views/laundryPriceCompareSmall.html",controller:"LaundryPriceCompareCtrl",reloadOnSearch:!1}).when("/search/:group",{templateUrl:"views/merchants.html",controller:"MerchantsCtrl",reloadOnSearch:!1}).when("/merchants/:geo/:urlStub",{templateUrl:"views/merchantDetails.html",controller:"MerchantDetailsCtrl",reloadOnSearch:!1,data:{recordScroll:!0}}).when("/checkout/:vertical/:merchantId",{templateUrl:"views/checkout_info.html",controller:"CheckoutInfoCtrl",resolve:j.checkIfUserIsLoggedIn}).when("/checkout/:vertical/:merchantId/complete",{templateUrl:"views/checkout_complete.html",controller:"CheckoutCompleteCtrl",resolve:j.checkIfUserIsLoggedIn}).when("/account/login",{templateUrl:"views/home.html",controller:"HomeCtrl",resolve:angular.extend({modalOnLoad:function(){return"login"},send404:function(){return!1}},j.getPrizes)}).when("/account/register",{templateUrl:"views/home.html",controller:"HomeCtrl",resolve:angular.extend({modalOnLoad:function(){return"signup"},send404:function(){return!1}},j.getPrizes)}).when("/account/password",{templateUrl:"views/home.html",controller:"HomeCtrl",resolve:angular.extend({modalOnLoad:function(){return"password_reset"},send404:function(){return!1}},j.getPrizes)}).when("/account/orders",{templateUrl:"views/orderHistory.html",controller:"OrderHistoryCtrl",resolve:j.checkIfUserIsLoggedIn}).when("/account/favorites",{templateUrl:"views/orderFavorites.html",controller:"OrderFavoritesCtrl",resolve:j.checkIfUserIsLoggedIn}).when("/account/orders/:orderId",{templateUrl:"views/orderDetails.html",controller:"OrderDetailsCtrl",resolve:j.checkIfUserIsLoggedIn}).when("/account/cards",{templateUrl:"views/manageCards.html",controller:"ManageCardsCtrl",resolve:j.checkIfUserIsLoggedIn}).when("/account/addresses",{templateUrl:"views/listAddresses.html",controller:"ListAddressesCtrl",resolve:j.checkIfUserIsLoggedIn}).when("/account/profile",{templateUrl:"views/profile.html",controller:"ProfileCtrl",resolve:j.checkIfUserIsLoggedIn}).when("/account/tell-a-friend",{templateUrl:"views/tellafriend.html",controller:"TellaFriendCtrl",resolve:j.checkIfUserIsLoggedIn}).when("/account/tell-a-friend/thanks",{templateUrl:"views/tellafriend_thanks.html",controller:"TellaFriendThanksCtrl",resolve:j.checkIfUserIsLoggedIn}).when("/account/repeat-orders",{templateUrl:"views/repeatOrders.html",controller:"RepeatOrderController as repeatOrderCtrl",resolve:angular.extend({},j.getRepeatOrders,j.checkIfUserIsLoggedIn,j.repeatOrderService)}).when("/account/repeat-orders/edit/:orderId",{templateUrl:"views/repeatOrdersCreate.html",controller:"RepeatOrderCreateController as repeatOrderCreateCtrl",data:{edit:!0},resolve:angular.extend({},j.getRepeatOrderDetails,j.checkIfUserIsLoggedIn,j.repeatOrderService)}).when("/account/repeat-orders/create/:orderId",{templateUrl:"views/repeatOrdersCreate.html",controller:"RepeatOrderCreateController as repeatOrderCreateCtrl",data:{edit:!1},resolve:angular.extend({},j.getOrderDetails,j.checkIfUserIsLoggedIn,j.repeatOrderService)}).when("/info/about",{templateUrl:"views/aboutUs.html",controller:"AboutUsCtrl as aboutUsCtrl",reloadOnSearch:!1,data:{customHeader:!0}}).when("/info/about-us/contact",{templateUrl:"views/contactUs.html",controller:"ContactUsCtrl"}).when("/info/legal/terms",{templateUrl:"views/terms.html",controller:"TermsCtrl"}).when("/info/legal/awards-terms",{templateUrl:"views/awardsTerms.html",controller:"AwardsTermsCtrl"}).when("/info/legal/official-rules",{templateUrl:"views/promoTerms.html",controller:"PromoTermsCtrl"}).when("/info/legal/privacy",{templateUrl:"views/privacy.html",controller:"PrivacyCtrl"}).when("/info/maintenance",{templateUrl:"views/maintenance.html",controller:"MaintenanceCtrl as maintenance"}).when("/info/merchants",{templateUrl:"views/merchantSignup.html",controller:"MerchantSignupCtrl as merchantSignupCtrl",reloadOnSearch:!1}).when("/promoSignUp",{templateUrl:"views/promoSignUp.html",controller:"PromoSignUpCtrl"}).when("/delivery-points",{templateUrl:"views/deliveryPoints.html",controller:"DeliveryPointsCtrl",resolve:angular.extend({},j.getPrizes)}).when("/delivery-points/confirmation/:id",{templateUrl:"views/deliverypoints_confirmation.html",controller:"DeliveryPointsConfirmationCtrl",resolve:angular.extend({},j.getPrizes,j.checkIfUserIsLoggedIn)}).when("/share/:id",{template:"",controller:"ShareCtrl"}).when("/share",{template:"",controller:"ShareCtrl"}).when("/cities",{templateUrl:"views/seoTagListCities.html",controller:"SeoTagListCitiesCtrl",data:{recordScroll:!0}}).when("/food",{templateUrl:"views/seoTagListCuisines.html",controller:"SeoTagListCuisinesCtrl",data:{recordScroll:!0}}).when("/alcohol",{templateUrl:"views/seoTagListCities.html",controller:"SeoTagListCitiesCtrl",data:{recordScroll:!0}}).when("/groceries",{templateUrl:"views/seoTagListCities.html",controller:"SeoTagListCitiesCtrl",data:{recordScroll:!0}}).when("/laundry",{templateUrl:"views/seoTagListCities.html",controller:"SeoTagListCitiesCtrl",data:{recordScroll:!0}}).when("/food/:cuisine",{templateUrl:"views/seoTagListCities.html",controller:"SeoTagListCitiesCtrl",data:{recordScroll:!0}}).when("/cities/:city/categories/:group",{templateUrl:"views/merchantsSEO.html",controller:"SeoCitySearchCtrl",reloadOnSearch:!1,data:{recordScroll:!0}}).when("/cities/:city/categories/food/:cuisine",{templateUrl:"views/merchantsSEO.html",controller:"SeoCitySearchCtrl",reloadOnSearch:!1,data:{recordScroll:!0}}).when("/cities/:geo/categories/:vertical/:urlStub",{templateUrl:"views/merchantDetails.html",controller:"MerchantDetailsCtrl",reloadOnSearch:!1,data:{recordScroll:!0}}).when("/cities/:city/categories/:group/neighborhoods/:neighborhood",{templateUrl:"views/merchantsSEO.html",controller:"SeoCitySearchCtrl",reloadOnSearch:!1,data:{recordScroll:!0}}).when("/cities/:city/categories/:group/:cuisine/neighborhoods/:neighborhood",{templateUrl:"views/merchantsSEO.html",controller:"SeoCitySearchCtrl",reloadOnSearch:!1,data:{recordScroll:!0}}).when("/cities/:city/categories/:group/zipcodes/:zipcode",{templateUrl:"views/merchantsSEO.html",controller:"SeoCitySearchCtrl",reloadOnSearch:!1,data:{recordScroll:!0}}).when("/cities/:city/categories/:group/:cuisine/zipcodes/:zipcode",{templateUrl:"views/merchantsSEO.html",controller:"SeoCitySearchCtrl",reloadOnSearch:!1,data:{recordScroll:!0}}).when("/:city/neighborhood/:neighborhood/:cuisine",{templateUrl:"views/merchantsSEO.html",controller:"WildcardCtrl",reloadOnSearch:!1,data:{recordScroll:!0}}).when("/cities/:city/neighborhoods/:neighborhood/cuisines/:cuisine",{templateUrl:"views/merchantsSEO.html",controller:"WildcardCtrl",reloadOnSearch:!1,data:{recordScroll:!0}}).when("/cities/:city/cuisines/:cuisine",{templateUrl:"views/merchantsSEO.html",controller:"WildcardCtrl",reloadOnSearch:!1,data:{recordScroll:!0}}).when("/cities/:city/neighborhoods/:neighborhood",{templateUrl:"views/merchantsSEO.html",controller:"WildcardCtrl",reloadOnSearch:!1,data:{recordScroll:!0}}).when("/:city/neighborhood/:neighborhood",{templateUrl:"views/merchantsSEO.html",controller:"WildcardCtrl",reloadOnSearch:!1,data:{recordScroll:!0}}).when("/:first_keyword/:second_keyword",{templateUrl:"views/wildcard.html",controller:"WildcardCtrl",data:{recordScroll:!0},reloadOnSearch:!1}).when("/404",{templateUrl:"views/home.html",controller:"HomeCtrl",resolve:angular.extend({modalOnLoad:function(){return!1},send404:function(){return!1}},j.getPrizes)}).otherwise({templateUrl:"views/home.html",controller:"HomeCtrl",resolve:angular.extend({modalOnLoad:function(){return!1},send404:function(){return g.isMobileApp()?!1:!0}},j.getPrizes)}),c.decorator("$exceptionHandler",["$delegate","$window",function(a,b){return function(c,d){b.trackJs&&b.trackJs.track(c),a(c,d)}}])}]).run(["$location","$modalStack","$rootScope","$timeout","$templateCache","$compile","$window","SystemMessages","MerchantReferral","Storage","ScrollHandler","DcomConfig","UserAuthToken","Cookies",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){function o(a){if(!a)return!1;var b,c,d,e=!1;return b="object"==typeof a.value.modalScope.item,d=a.value.modalDomEl[0],d&&(c=d.className.indexOf("item-option-modal")>-1),e=b&&c}if(c.page={title:"",canonicalUrl:null,send404:!1},c.header={},c.maintenanceMode=!1,c.currentYear=(new Date).getFullYear(),a.search().auth_token){var p=a.search().auth_token;m.set(p)}c.useWebviewLayout=!1,a.search().webview_layout&&(c.useWebviewLayout=!0),function(){function a(a,b){var d=g.matchMedia("(min-width: "+b+")");c.matchMedia=c.matchMedia||{},c.matchMedia[a]=d.matches?!0:!1,d.addListener(function(b){c.$apply(function(){c.matchMedia[a]=b.matches?!0:!1})})}function b(){for(e=0;e<f.length;e++)a(f[e].name,f[e].minWidth)}var e,f=[{name:"mobile",minWidth:"320px"},{name:"mobileNew",minWidth:"360px"},{name:"mobileLarge",minWidth:"568px"},{name:"smallPortrait",minWidth:"768px"},{name:"small",minWidth:"960px"},{name:"medium",minWidth:"1200px"}];b(),(null!==navigator.userAgent.match(/(iPad|iPhone)/i)||"ios"===l.platform)&&g.addEventListener("orientationchange",function(){b();var a=angular.element(document.body),c=angular.element("<div></div>");a.append(c),d(function(){c.remove()})})}(),c.$on("$routeChangeStart",function(a,c,e){var f=b.getTop(),g="undefined"!=typeof f;if(g&&o(f)&&("MerchantDetailsCtrl"===e.controller||"CheckoutInfoCtrl"===e.controller)){var i=window.scrollY||document.documentElement.scrollTop;a.preventDefault(),b.dismissAll(),d(function(){window.scrollTo(0,i)})}else angular.element(document.body).addClass("page-loading"),h.clear()}),c.$on("$routeChangeSuccess",function(){angular.element(document.body).removeClass("page-loading"),window.scrollTo(0,0),c.hideMainNav&&c.hideMainNav(),c.hideAccountNav&&c.hideAccountNav(),b.dismissAll(),c.page={title:"",canonicalUrl:null,send404:!1},c.header={},d(function(){var b,d=a.path();try{if("/"===d){var e=window.location.search;b=e?e.substr(1):"/"}else b=d.substr(1)}catch(f){b=d}dataLayer.push({virtualUrl:a.url(),event:"viewChange",pageTitle:c.page.title,pageExtension:b})}),window.optimizely=window.optimizely||[],window.optimizely.push(["activate"]),window.optimizely.push("activateUniversalAnalytics")}),c.hideNavigation=!1,c.$on("$routeChangeError",function(){h.clear(),c.header={text:'<div class="logo"><span class="icon-delivery-logo">delivery.com</span></div>'},c.online=!1;var a=f(e.get("views/partials/noconnection.html"))(c);angular.element(document.getElementById("main-content")).html(a)}),c.$on("$routeChangeSuccess",function(a,b){c.online=!0,c.customHeader=!1,angular.isDefined(b.data)&&angular.isDefined(b.data.customHeader)&&(c.customHeader=b.data.customHeader),angular.isDefined(b.data)&&angular.isDefined(b.data.recordScroll)?k.startRecording():k.stopRecording()}),c.$on("fatalError",function(b,d){angular.isDefined(d)&&(angular.isDefined(a.search().code)||(401===d.code?-1===a.path().indexOf("/account/")&&(c.userData=null,m.unset(),n.deleteCookie("rememberMe"),n.deleteCookie("userIdForGA"),a.path("/"),a.search({code:d.code})):503===d.code&&(c.maintenanceMode=!0,c.maintenanceMessage=d.error_message,a.path("/info/maintenance"))))}),g.addEventListener("scroll",function(){g.requestAnimationFrame(function(){k.updatePosition()})}),function(){function b(a){a=a.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var b=new RegExp("[\\?&]"+a+"=([^&#]*)"),c=b.exec(location.search);return null==c?"":decodeURIComponent(c[1].replace(/\+/g," "))}var c=b("uhauid")||a.search().uhauid;c&&j.set("uhauid",c,30)}(),i.loadParam();var q={platform:window.platform,home_reorder:!1,merchant_reorder:!1};Leanplum.setVariables(q),"ios"===l.platform&&Leanplum.start()}]),angular.module("dcomApp.templates",["views/partials/noconnection.html"]),angular.module("views/partials/noconnection.html",[]).run(["$templateCache",function(a){a.put("views/partials/noconnection.html",'<div ng-controller="NoConnectionCtrl"><span class="icon-antenna"></span><p class="message">Oops. We lost you!<br /> Please check your internet connection and try again.</p><button class="button primary retry" ng-click="retry_connection()"> Try again! </button></div>')}]),angular.module("dcomApp").controller("SubnavigationCtrl",["$rootScope","$scope","$window","$location","$routeParams","SearchLocation","Group","Merchant","Urls","ItemSearchKeyword",function(a,b,c,d,e,f,g,h,i,j){b.futureOrdersDisplay=-1!==d.url().search("/cities/")&&"undefined"!=typeof e.geo&&"undefined"!=typeof e.urlStub?"menu":"/search"===d.path()?"search":!1,b.goTo=function(a){var b=!1;if("menu"===a&&-1!==d.url().search("/checkout")?h.getInfo(e.merchantId).then(function(a){d.path(i.getMerchantUrl(a.merchant))},function(){a="merchants",b=!0}):"merchants"===a&&-1!==d.url().search("/checkout")&&(b=!0),"merchants"===a&&"undefined"!=typeof e.geo&&"undefined"!=typeof e.urlStub||b){var c=f.get().query;if("undefined"!=typeof c){var k=g.getCurrentGroupPath();d.path("/search");var l={};""!==k&&(l[k]=!0),l.address=c,""!==j.menuSearchKeyword()&&(l.keyword=j.menuSearchKeyword()),d.search(l)}else a="home"}return"home"===a&&d.url("/"),!1},b.$watch("activeGroup",function(a){angular.isDefined(a)&&(b.futureOrdersDisplay=b.groups[a].show_futureOrdering?"search":!1)}),b.$watch("currentGroup",function(a){if(!angular.isUndefined(a)&&null!==a){var c=g.getGroupFromAnyKey(a,"key");b.futureOrdersDisplay=c.show_futureOrdering&&-1===d.url().search("/checkout/")?"menu":!1}})}]),function(){function a(a,b){a.page={bodyClasses:"page-about",title:"delivery.com | About Us",description:"delivery.com lets you order online from local restaurants, liquor stores and grocers near you, and even get your dry cleaning picked up and delivered."},a.header={backAction:function(){b.history.back()}}}function b(a){var b={};return angular.forEach(a,function(a){b[a.key]=a.value}),b}function c(a){return a.copy=b(a.copy),a}function d(a){return function(b){return a.loading=!b,a.data=b,b}}function e(a,b,c){return function(b){return c(function(){a()}),b}}angular.module("dcomApp.controller.about",["dcom.service.googleSpreadsheet","dcomApp.service.device","dcomApp.config"]).controller("AboutUsCtrl",["$rootScope","$scope","$window","GoogleSpreadsheetService","$anchorScroll","$location","$timeout","Device","DcomConfig",function(b,f,g,h,i,j,k,l,m){var n=this,o=d(f),p=e(i,j,k);return a(b,g),o(),h.get(m.aboutUsSpreadsheetId).then(c).then(o).then(p).catch(function(){o({})}),n.isMobileApp=l.isMobileApp(),n.goTo=function(a,b){a.preventDefault(),j.hash(b),i()},n.voidClickFromMobileApp=function(a){n.isMobileApp&&a.preventDefault()},n}]).directive("backImg",function(){return{restrict:"A",scope:{backImg:"@"},link:function(a,b){var c=a.backImg;b.css({"background-image":"url("+c+")","background-size":"cover"})}}}).directive("scroll",["$window","$rootScope",function(a,b){return{restrict:"A",scope:{scroll:"@"},link:function(c,d){if(b.matchMedia.small){var e="",f=parseFloat(c.scroll),g=angular.element(d);angular.element(a).bind("scroll",function(){"not-fixed"!==e&&this.pageYOffset<f?(g.removeClass("fixed"),e="not-fixed"):"fixed"!==e&&this.pageYOffset>=f&&(g.addClass("fixed"),e="fixed")})}}}}])}(),angular.module("dcomApp").controller("ManageCardsCtrl",["$location","$rootScope","$scope","$window","$modal","User","UserAPI","UserMessages","$route",function(a,b,c,d,e,f,g,h,i){function j(){var b={ccNumber:c.card.number,expMonth:c.card.expMonth,expYear:c.card.expYear,cvv:c.card.cvv,billingZip:c.card.billingZip};g.addCreditCard(b).then(function(){a.search().next?a.url(a.search().next):i.reload(),c.processing=!1},function(a){c.processing=!1,c.handleErrors(a)})}f.getUserAuthToken()&&g.getCreditCards().then(function(a){c.usersCards=a}),c.processing=!1,c.card={},c.errorMsg={cc_number:!1,exp_month:!1,exp_year:!1,cvv:!1,billing_zip:!1},c.showAddForm=!0,c.usersCards={},b.page={bodyClasses:"page-list-cards",title:"Credit Cards"},b.header={backAction:function(){d.history.back()}},c.cardYears=function(){for(var a=[],c=b.currentYear;c<=b.currentYear+10;c++)a.push(c);return a},c.toggleForm=function(){c.showAddForm=!c.showAddForm,c.showAddForm===!1&&(c.errorMsg={cc_number:!1,exp_month:!1,exp_year:!1,cvv:!1,billing_zip:!1})},c.handleErrors=function(a){if(a){c.errorMsg={cc_number:!1,exp_month:!1,exp_year:!1,cvv:!1,billing_zip:!1};var b=0;for(b=0;b<a.length;b++)c.errorMsg[a[b].field]=a[b].user_msg}},c.deleteCard=function(a){e.open({templateUrl:"views/modals/deleteCard.html",controller:["$scope",function(b){b.deleteCard=function(){b.$dismiss(),g.removeCreditCard(a).then(function(){i.reload()},function(a){b.results=a})}}]})},c.submitCardForm=function(){c.processing||(c.processing=!0,j())}}]),angular.module("dcomApp").controller("CartItemsCtrl",["$scope","$modal","MerchantAPI","CartProvider","User","UserMessages","Group","$routeParams","$location","Urls","$window","MerchantSearch","Merchant",function(a,b,c,d,e,f,g,h,i,j,k,l,m){function n(b){angular.forEach(b,function(a){a.optionList=o(a)}),a.items=b}function o(a){for(var b=[a],c=[],d=function(a){b.push(a)};b.length;){var e=b.pop();e.options=e.options||[],e.options.forEach(d),"option"===e.type&&c.unshift(e.name)}return c}function p(a){f.askConfirmation({title:"Delete item",message:"Are you sure you want to remove this item from your bag?",ok:"Ok",cancel:"Cancel"}).then(function(){k.dataLayer.push({event:"OrderAction",eventCategory:"Merchant",eventAction:"Remove From Bag",eventLabel:a.name,ecommerce:{remove:{products:[{name:a.name,id:a.id,price:a.price}]}}}),s.remove(a.item_key),"l"===g.currentGroup()&&l.overrideCacheForNextSearch()})}function q(d){a.editClick!==!0&&(a.editClick=!0,c.getItem(t,d.id).then(function(c){function f(a,b){var c,d,e;if(a)for(c=0;c<a.length;c++)if(a[c].options)for(d=0;d<a[c].options.length;d++)e=a[c].options[d],b[e.id]=parseFloat(e.quantity),e.options&&e.options.length>0&&f(e.options,b)}function h(a,b){function c(a){var b,f,g,h;for(b=0;b<a.length;b++)for(g=a[b],f=0;f<g.children.length;f++)h=g.children[f],d[h.id]>0&&(1===parseFloat(g.min_selection)&&1===parseFloat(g.max_selection)?e.optionGroup[g.id]=h.id:(e.optionGroup[g.id]=e.optionGroup[g.id]||{},e.optionGroup[g.id][h.id]=h.max_qty?d[h.id]:!0)),h.children&&h.children.length>0&&c(h.children)}var d={},e={cartKey:a.item_key,optionGroup:{},itemQty:parseFloat(a.quantity),specialInstructions:a.instructions};return f(a.options,d),c(b.children),e}var i,j;i=c.item[0],i.cartIndex=d.item_key,j=h(d,c.item[0]),a.editClick=!1,b.open({templateUrl:"views/modals/itemOptions.html",windowClass:"item-option-modal",resolve:{item:function(){return i},cart:function(){return s},itemForm:function(){return j}},controller:["$scope","item","cart","itemForm",function(a,b,c,d){a.item=b,a.itemForm=d,a.actionText="Edit item",a.actionTextMobile="Edit",a.processing=!1,a.action=function(d){angular.extend(d,{item_key:b.cartIndex}),c.edit(d).then(function(){"l"===g.currentGroup()&&l.overrideCacheForNextSearch()},function(){e.getUserAuthToken()||e.getGuestAuthToken||e.createGuestSession()}).finally(function(){a.$dismiss("edited cart"),a.processing=!1})}}]})}))}function r(){m.getId().then(function(a){t=a,s=d.get(t),n(s.getItems())})}k.dataLayer=k.dataLayer||[];var s,t;a.currentGroup=g.currentGroup(),a.isCheckout=function(){return i.path().indexOf("/checkout/restaurant/")>-1?!0:void 0},a.goTo=function(){m.getInfo().then(function(a){i.path(j.getMerchantUrl(a.merchant))})},r(),a.removeItem=p,a.editItem=q,a.cartInfo={},a.$on("cartChange",function(){"undefined"!=typeof s&&n(s.getItems())})}]),angular.module("dcomApp").controller("CartInfoCtrl",["$scope","Merchant","CartProvider","CheckoutProvider","$rootScope","Group","$timeout",function(a,b,c,d,e,f,g){function h(){if(angular.extend(a.cartInfo,m.getInfo()),a.updateMinimum(),a.cartInfo.showCheckoutInfo&&n){var b=n.getCheckoutInfo();angular.extend(a.cartInfo,b),a.cartInfo.total=a.cartInfo.checkoutTotal;var c=m.getInfo();if(parseFloat(b.paymentDiscount,10)>parseFloat(c.total,10)&&c.total>0){for(var d=c.total+b.tip,e=0;e<b.adjustments.length;e++){if(b.adjustments[e].amount>d){b.adjustments[e].amount=d,b.adjustments=b.adjustments.slice(0,e+1);break}d-=b.adjustments[e].amount}b.adjustments.length>0&&(a.cartInfo.adjustments=b.adjustments)}if(b.adjustments)for(var f=0;f<b.adjustments.length;f++)b.adjustments[f].pointsValue&&a.cartInfo.delivery_points&&"number"==typeof a.cartInfo.delivery_points&&(a.cartInfo.delivery_points+=b.adjustments[f].pointsValue)}var g=m.getOrderType();"delivery"===g?(a.hasFreeDelivery=!0,angular.forEach(a.cartInfo.fees,function(b){"Delivery Fee"===b.name&&b.value>0&&(a.hasFreeDelivery=!1)})):a.hasFreeDelivery=!1}function i(a){var b={delivery:null,pickup:null};return null!==a.delivery&&(null!==a.delivery.highest?b.delivery=a.delivery.highest:null!==a.delivery.lowest&&(b.delivery=a.delivery.lowest)),b.pickup=a.pickup,b}function j(a,b){var c;return"undefined"!=typeof a&&(c=b-a,c=c>0?c:0),c}function k(){var c=b.getFromCache();if(c){var d=c;l(d.merchant_data)}else a.$on("merchantInfoLoaded",function(a,b){l(b)})}function l(b){a.merchant=b.merchant,m=c.get(a.merchant.id),e.matchMedia.small&&"l"!==f.currentGroup()||(m.reload(),g(function(){e.$broadcast("cartChange")})),n=d.get(a.merchant.id),h()}var m,n;a.merchant=a.merchant||{},a.cartInfo=a.cartInfo||{},a.hasFreeDelivery=!1,a.updateMinimum=function(){var b=m.getOrderType(),c=i(a.merchant.ordering.minimum);a.minimum=c[b],a.remainingMinimum=j(m.getInfo().subtotal,a.minimum)},a.isPromotion=function(a){return"promo"===a.type?!0:!1},a.getDiscountName=function(a){var b="";return a.code&&"marketing"===a.reward&&(b=a.code),"promo"===a.type&&(b+="Promotion","dollar_off"===a.reward&&0!==a.value?b+=" ($"+a.value+" off)":"percent_off"===a.reward&&0!==a.value&&(b+=" ("+a.value+"% off)")),b},a.renderStickyCartItems=function(){var b="";return a.cartInfo&&a.cartInfo.item_count>0?(b=a.cartInfo.item_count+" item",a.cartInfo.item_count>1&&(b+="s")):b="Your bag is empty",b},k(),a.$on("cartChange",function(){m&&h()}),a.$on("CheckoutChange",function(){n&&h()}),a.$on("locationChange",function(){h()})}]),angular.module("dcomApp").controller("CheckoutCompleteCtrl",["$location","$window","$modal","$rootScope","$routeParams","$scope","CheckoutProvider","SearchLocation","User","MerchantAPI","Group","Cookies","MerchantSearch","headerImages","olarkChat","ModalService",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){function q(a){var b={backgroundImage:""};return"f"===f.currentGroup?(b.backgroundImage='url("'+a+'")',b):null}function r(){p.open({templateUrl:"views/modals/gameify.html",controller:"GameifyModalCtrl",className:"small gameify-modal",data:{orderInfo:v,vertical:f.currentGroup}})}b.dataLayer=b.dataLayer||[];var s,t=e.merchantId,u=g.get(t),v=u.getLastOrder();f.showRedCharityCopy=b.showRedCharityCopy,i.getUserAuthToken()&&v&&v.merchant_id===e.merchantId?(f.orderWineLiquor=function(){m.resetFilters(),d.search&&d.search.query?(a.path("/search"),a.search({address:d.search.query,alcohol:!0})):h.isSet()?(a.path("/search"),a.search({address:h.get().query,alcohol:!0})):a.path("/")},f.orderFood=function(){m.resetFilters(),d.search&&d.search.query?(a.path("/search"),a.search({address:d.search.query})):h.isSet()?(a.path("/search"),a.search({address:h.get().query})):a.path("/")},f.getOrderDetailLink=function(){var b="/account/orders/"+f.orderDetails.orderId;a.path(b),"l"===k.currentGroup()&&a.search({laundry:"true"})},f.orderConfirmChat=function(){o.open(),b.dataLayer.push({event:"OrderAction",eventCategory:"Chat",eventAction:"Chat clicked - order confirm",eventLabel:f.orderDetails.merchantName})},f.repeat=function(c){a.path("/account/repeat-orders/create/"+c.orderId),b.dataLayer.push({event:"OrderAction",eventCategory:"Order confirm",eventAction:"Repeat clicked",eventLabel:c.merchantName})},d.page={bodyClasses:"page-checkout",title:"Checkout | delivery.com"},f.orderDetails={orderId:v.order_id,pointsEarned:v.delivery_points},f.currentGroup=k.currentGroup(),j.getMerchantInfo(e.merchantId).then(function(a){s=a.images,f.mainCuisine=n.selectImageHeaderSize(s,b.innerWidth),f.cuisineHeader=q(f.mainCuisine),f.merchantInfo=a.merchant,f.orderDetails.merchantName=f.merchantInfo.summary.name,f.orderDetails.merchantNumber=f.merchantInfo.summary.phone,b.gameify&&!v.hasPlayedGame&&"l"!==f.currentGroup&&r(),u.trackDishRecPurchase(v.order_id)}),f.$watch(function(){return b.innerWidth},function(){f.mainCuisine=n.selectImageHeaderSize(s,b.innerWidth),f.cuisineHeader=q(f.mainCuisine)}),angular.isDefined(l.getCookie("order_tracking"))&&l.deleteCookie("order_tracking")):a.path("/")}]),angular.module("dcomApp").controller("CheckoutInfoCtrl",["$window","$location","$rootScope","$routeParams","$scope","$q","$modal","User","LocationAPI","MerchantAPI","SearchLocation","headerImages","CartProvider","CheckoutProvider","UserMessages","Group","Urls","CartAPI","$timeout","UserAPI","$filter","JqliteHelper","HammerEvents",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v){function w(){var a=f.defer(),b={ccNumber:e.card.number,expMonth:e.card.expMonth,expYear:e.card.expYear,cvv:e.card.cvv,billingZip:e.card.billingZip};return e.card.saveCard||(b.save=!1,b.merchant_id=d.merchantId),t.addCreditCard(b).then(function(b){e.payments.credit=b.cc_id,e.setActivePaymentType("credit"),db.makeNewCCAvailable(b.cc_id),e.hasErrors=!1,e.cardFormWasEdited=!1,a.resolve(b)},function(b){e.processing=!1,e.handleCardErrors(b),a.reject()}),a.promise}function x(a,b){for(var c=.001,d=0;d<a.length;d++){var e,f;try{e=parseFloat(a[d].latitude),f=parseFloat(a[d].longitude)}catch(g){return null}var h=Math.abs(b.latitude-e),i=Math.abs(b.longitude-f);if(c>h&&c>i)return a[d]}return null}function y(){return i.get().then(function(a){var b=k.get(),c=x(a.locations,{latitude:b.latitude,longitude:b.longitude}),d={};return c?(d.id=c.location_id,d.street=c.street,d.city=c.city,d.state=c.state,d.zipCode=c.zip_code,d.phone=c.phone,d.company=c.company,d.unit=c.unit_number,d.crossStreet=c.cross_streets,d.instructions=c.instructions):(d.street=b.street,d.city=b.city,d.state=b.state,d.zipCode=b.zip),d.geolocated=b.geolocated,d.addressModal=b.addressmodal,d})}function z(){return db.getPaymentMethods().then(function(a){var b={credit:null,giftCodes:{},creditBalances:{},promo:null,tabsCount:0,cashDisabled:null};b.paymentMethods=a,(a.cash||-1!==b.paymentMethods.allowed_payment_methods.indexOf("cash"))&&(a.cash||-1===b.paymentMethods.allowed_payment_methods.indexOf("cash")?(b.acceptsCash=!0,b.tabsCount++):""!==b.paymentMethods.disallowed_payment_methods.cash.user_msg&&(b.cashDisabled=b.paymentMethods.disallowed_payment_methods.cash.user_msg,b.acceptsCash=!0,b.tabsCount++)),a.credit_card&&(b.acceptsCredit=!0,b.tabsCount++,a.credit_card.length>0&&(b.credit=a.credit_card[0].id)),a.paypal&&(b.acceptsPayPal=!0,b.tabsCount++),-1!==a.allowed_payment_methods.indexOf("promo")&&(b.acceptsPromo=!0),-1!==a.allowed_payment_methods.indexOf("gift_code")&&(b.acceptsGiftcode=!0);var c;if(a.gift_code)for(c=0;c<a.gift_code.length;c++)b.giftCodes[a.gift_code[c].id]=!1;if(a.credit_balance)for(c=0;c<a.credit_balance.length;c++)b.creditBalances[a.credit_balance[c].id]=!1;return a.promo&&(b.promo=a.promo[0].id),b})}function A(){return angular.isDefined(e.card.number)&&""!==e.card.number&&angular.isDefined(e.card.expMonth)&&""!==e.card.expMonth&&angular.isDefined(e.card.expYear)&&""!==e.card.expYear&&angular.isDefined(e.card.cvv)&&""!==e.card.cvv&&angular.isDefined(e.card.billingZip)&&""!==e.card.billingZip?!0:!1}function B(){return 0===db.getCheckoutInfo().payments.length?!1:"cash"===Z||"paypal"===Z?!0:e.payments.credit?!0:0===parseInt(cb.getInfo().total,10)&&"f"===e.currentGroup||"g"===e.currentGroup?!0:A()?!0:!1}function C(a){if("undefined"!=typeof a&&null!==a){var b=a.toString().replace(/[^0-9]/g,"");if(null!==b)return b}return null}function D(a){var b=a,c=f.defer();if(b.message.length>0&&"loc_multiple_possible"===b.message[0].code){e.addresses=b.addresses;var d=g.open({templateUrl:"/views/modals/merchantAddressError.html",controller:"MerchantAddressModalCtrl as modalCtrl",resolve:{merchantInfo:function(){return e.merchantInfo},ambiguousAddresses:function(){return e.addresses},currentAddress:function(){return e.location}},windowClass:"address-modal"});d.result.then(function(a){e.location.street=a.street,e.location.city=a.city,e.location.state=a.state,e.location.zipCode=a.zip}),c.reject()}else e.location.id=b.location.location_id,c.resolve();return c.promise}function E(){var a,b=f.defer(),c="undefined"!=typeof e.location.id,d=e.locationform.$dirty;
return c&&!d||e.orderPickup===!0?b.resolve():c&&d?(a={id:e.location.id,street:e.location.street,city:e.location.city,state:e.location.state,zipCode:e.location.zipCode,unit:e.location.unit,company:e.location.company,crossStreet:e.location.crossStreet,phone:C(e.location.phone)},i.edit(a).then(function(a){D(a).then(function(){b.resolve()},function(){b.reject(),e.processing=!1})},function(a){o.printError(a),b.reject(),e.processing=!1})):(a={street:e.location.street,city:e.location.city,state:e.location.state,zipCode:e.location.zipCode,unit:e.location.unit,company:e.location.company,crossStreet:e.location.crossStreet,phone:C(e.location.phone)},i.create(a).then(function(a){D(a).then(function(){b.resolve()},function(){b.reject(),e.processing=!1})},function(a){o.printError(a),b.reject(),e.processing=!1})),b.promise}function F(a,b){if(a&&(a.giftCodeId||a.creditBalanceId)){if(b){b.preventDefault();var c;a.giftCodeId?c=document.getElementById("giftCode-"+a.giftCodeId):a.creditBalanceId&&(c=document.getElementById("creditBalance-"+a.creditBalanceId)),c.checked=!c.checked}var d;a.giftCodeId?(d=document.getElementById("giftCode-"+a.giftCodeId).checked,e.payments.giftCodes[a.giftCodeId]=d):a.creditBalanceId&&(d=document.getElementById("creditBalance-"+a.creditBalanceId).checked,e.payments.creditBalances[a.creditBalanceId]=d)}H(Z)}function G(a,b){if(e.payments&&e.payments.cashDisabled){if("cash"===a)return b&&(b.stopPropagation(),b.preventDefault()),!1}else e.payments&&angular.isDefined(e.payments.cashDisabled)&&(e.payments.cashDisabled=null);return!0}function H(a,b){if(!G(a,b))return!1;if(Z=a,"cash"===Z)db.setPaymentMethods({mainPayment:{type:"cash"}});else if("paypal"===Z){var c={mainPayment:{type:"paypal"}};fb.checkout||(c.giftCodes=e.payments.giftCodes,c.creditBalances=e.payments.creditBalances,c.promo=e.payments.promo),db.setPaymentMethods(c)}else db.setPaymentMethods({mainPayment:{type:"credit",id:e.payments.credit},giftCodes:e.payments.giftCodes,creditBalances:e.payments.creditBalances,promo:e.payments.promo})}function I(a){return Z===a}function J(b){db.getPayPalInfo(b).then(function(b){return angular.isDefined(b.paypalUrl)&&""!==b.paypalUrl?void(a.location.href=b.paypalUrl):(o.printAPIMessage(b.message),void(e.processing=!1))})}function K(a){db.payPalCheckout(a).then(function(c){return angular.isDefined(c.order_id)&&""!==c.order_id?(b.path(q.getCheckoutUrl(e.merchantInfo)+"/complete"),O(a),db.sendOrderInfo(a),fb.checkout=!1,void(fb.processed=!1)):(fb.checkout=!1,o.printAPIMessage(c.message),hb=!1,void 0)})}function L(){if(cb.getItems()&&e.ecommerceDataPush(e.merchantName,cb.getItems().concat(e.extractAdditionalEcommerceItems()),"Place Order Clicked",2),e.processing)return!1;var a=cb.getInfo().item_count;return a?e.canCheckout()?(e.processing=!0,B()?void E().then(function(){if(!angular.isDefined(cb))return void(e.processing=!1);cb.getInfo();if("l"===p.currentGroup()){if("Not set yet"===e.getSelectedLaundryPickupTime())return e.pickupTimeError=!0,e.processing=!1,void document.getElementById("pickup-time").focus();if(e.pickupTimeError=!1,"Not set yet"===e.getSelectedLaundryDeliveryTime())return e.deliveryTimeError=!0,e.processing=!1,void document.getElementById("delivery-time").focus();e.deliveryTimeError=!1}A()&&e.showAddCardForm&&e.cardFormWasEdited?w().then(function(){eb=!0,N()}):(eb=!1,N())}):(e.processing=!1,!1)):(e.phoneError=angular.isDefined(e.location)&&angular.isDefined(e.location.phone)&&""!==e.location.phone?!1:!0,!1):!1}function M(b,c,d,e){var f={type:d};f.payment="credit"===b?e?b+"(new)":b+"(saved)":b,f.ordertime="ASAP"===c?"ASAP":"Scheduled",a.dataLayer.push({event:"OrderAction",ecommerce:{checkout_option:{actionField:{step:2,option:JSON.stringify(f)}}}})}function N(){var a={order_type:cb.getOrderType(),order_time:cb.getOrderTime(),location_id:e.location.id,instructions:e.specialInstructions,save_instructions:e.saveSpecialInstructionsFlag};return angular.isDefined(e.location.phone)&&(a.phone_number=C(e.location.phone)),"cash"===Z&&db.setTip("0.00"),"paypal"===Z&&fb.processed===!1?(a.merchant_id=d.merchantId,a.payments=db.getCheckoutInfo().payments,a.tip=db.getTip(),J(a)):"paypal"===Z&&fb.processed===!0&&hb===!1?(hb=!0,a.merchant_id=d.merchantId,a.token=fb.token,K(a)):void(("paypal"!==Z||fb.processed!==!0||hb===!1)&&db.checkout(a).then(function(c){M(Z,c.order_time,c.order_type,eb),b.path(q.getCheckoutUrl(e.merchantInfo)+"/complete"),O(a),db.sendOrderInfo(a)},function(a){eb&&!e.card.saveCard&&(t.removeCreditCard(e.payments.credit),e.payments.credit=null,eb=!1,e.setActivePaymentType("credit")),o.printError(a),e.processing=!1}))}function O(a){var b=p.currentGroup(),c=Leanplum.getVariables();c.home_reorder?Leanplum.track("Place Order",a.cartInfo.subtotal,{"from reorder":"Homepage",vertical:b}):c.merchant_reorder?Leanplum.track("Place Order",a.cartInfo.subtotal,{"from reorder":"Merchant Page",vertical:b}):Leanplum.track("Place Order",a.cartInfo.subtotal,{"from reorder":!1,vertical:b})}function P(){var a=cb.getLaundryPickupTimes();e.pickupTimeOptions=[],angular.forEach(a,function(a){e.pickupTimeOptions.push({name:a.string,value:a.timestamp})})}function Q(a){var b=a.replace(" AM","am");b=b.replace(" PM","pm");var c=Date.create().format("{Dow} {mon} {d}");return b=b.replace(c,"Today")}function R(a){var b={backgroundImage:""};return"f"===e.currentGroup?(b.backgroundImage='url("'+a+'")',b):null}function S(a){function b(a){return function(){e[a]=!1}}e.specialInstructions=a;for(var c=0;c<_.length;c++)s(b(_[c].variable))}function T(a){return function(){var b=-1!==e.specialInstructions.indexOf(a.text);if(b!==e[a.variable]){var c="";c=b?e.specialInstructions.replace(a.text,""):a.text+", "+e.specialInstructions,e.specialInstructions=c.replace(/^\,/,"").replace(/^\ /,"").replace(/\,\ \,\ /,", ").replace(/\ $/,"").replace(/\,$/,"")}}}function U(){var a=f.defer();e.tipCash=!1,e.deliveryPickupHotel=!1,e.deliveryPickupDoorman=!1,e.tipCashText="Tipping in Cash",e.deliveryPickupHotelText="I am staying in a hotel",e.deliveryPickupDoormanText="See doorman for pickup and delivery",e.specialInstructions=e.specialInstructions||"",_=[{variable:"deliveryPickupHotel",text:e.deliveryPickupHotelText},{variable:"deliveryPickupDoorman",text:e.deliveryPickupDoormanText},{variable:"tipCash",text:e.tipCashText}],e.$watch("specialInstructions",function(){for(var a=0;a<_.length;a++){var b=-1!==e.specialInstructions.indexOf(_[a].text);e[_[a].variable]!==b&&(e[_[a].variable]=b)}});for(var b=0;b<_.length;b++)e.$watch(_[b].variable,T(_[b]));return e.$on("tipCash",function(a,b){e.tipCash=b}),a.resolve(),a.promise}function V(){e.currentGroup=p.currentGroup(),null===e.currentGroup&&(e.currentGroup=p.loadFromVerticalUrl()),e.cartInfo={showCheckoutInfo:!0},e.processing=!1,e.phoneError=!1,e.ordering={},e.ordering.timeLeft=null,j.getMerchantInfo(d.merchantId).then(function(d){$=d.images,e.mainCuisine=l.selectImageHeaderSize($,a.innerWidth),e.cuisineHeader=R(e.mainCuisine),e.merchantInfo=d.merchant,e.menuUrl=q.getMerchantUrl(d.merchant),c.header.backUrl=e.menuUrl,e.merchantName=d.merchant.summary.name,s(function(){c.$broadcast("merchantInfoLoaded",d)}),cb.reload().then(function(a){if(e.cartItems=a.cart,e.saveMerchantName(),e.ecommerceDataPush(e.merchantName,e.cartItems,"Checkout Initiated",1),e.ordering.timeLeft=a.minutes_left_for_asap_order,0===a.cart.length&&b.path(e.menuUrl),"l"===p.currentGroup()){var c=cb.getInfo();e.pickupTimeOptions=c.laundry_pickup_options,e.deliveryTimeOptions=c.laundry_delivery_options,e.pickup_time=c.laundry_pickup_time,e.delivery_time=c.laundry_delivery_time,e.pickupTimeError=!1,e.deliveryTimeError=!1,e.deliveryTimeProcessing=!1,e.hideLaundryDisclaimer=!0,angular.isDefined(e.pickupTimeOptions)&&0!==e.pickupTimeOptions.length||P()}})}),e.orderPickup="pickup"===cb.getOrderType()?!0:!1,H("cash"),jb=db.getCheckoutInfo(),angular.isDefined(jb.specialInstructions)&&(e.specialInstructions=jb.specialInstructions),U().then(function(){return y()}).then(function(a){e.location=a||{};var b=e.location.geolocated||e.location.addressModal;angular.isDefined(b)&&(b=b.toString()),e.editAddr=b,e.location.instructions&&S(e.location.instructions),angular.isDefined(jb.addressUnit)&&null!==jb.addressUnit&&(e.location.unit=jb.addressUnit)}),z().then(function(a){e.payments=a,(null===e.payments.credit||0===e.payments.credit.length)&&(e.showAddCardForm=!0),a.acceptsCredit&&e.setActivePaymentType("credit")})}function W(a,b,c){for(var d=0;d<c.length;d++)if(b<=c[d].value)return c[d].value}function X(a,b){if(b["laundry_"+a+"_time"]&&e[a+"TimeOptions"]){var c=W(a,b["laundry_"+a+"_time"],e[a+"TimeOptions"]);if(c)return e[a+"_time"]=c,"pickup"!==a||e.deliveryTimeOptions||e.getLaundryDeliveryTimes(e.pickup_time,!0),!0}}function Y(){if(cb&&!gb){var a=cb.getInfo();X("pickup",a)&&(X("delivery",a),gb=!0)}}a.dataLayer=a.dataLayer||[];var Z,$,_,ab,bb=(b.url(),"/checkout/"+d.merchantId,d.merchantId),cb=m.get(bb),db=n.get(bb),eb=!1,fb={processed:!1},gb=!1,hb=!1;if(e.saveSpecialInstructionsFlag=!1,e.card={saveCard:!0},e.cardFormWasEdited=!1,e.cardErrors={cc_number:!1,exp_month:!1,exp_year:!1,cvv:!1,billing_zip:!1},e.cardYears=function(){for(var a=[],b=c.currentYear;b<=c.currentYear+10;b++)a.push(b);return a},e.cardInfoUpdated=function(){e.cardFormWasEdited=!0},e.handleCardErrors=function(a){if(a){e.hasErrors=!0,e.cardErrors={cc_number:!1,exp_month:!1,exp_year:!1,cvv:!1,billing_zip:!1};var b=0;for(b=0;b<a.length;b++)e.cardErrors[a[b].field]=a[b].user_msg;window.scrollTo(0,v.getOffsetTop("payment-info"))}},e.hasErrors=!1,e.availableCardClick=function(a){e.payments.credit=a.id,H("credit"),e.showAddCardForm=!1},e.cleanCardNumber=function(a){return angular.isString(a)?a.replace(/[^0-9]/g,""):""},e.haveCreditOrPromos=function(){return angular.isDefined(e.payments.paymentMethods.gift_code)&&e.payments.paymentMethods.gift_code.length>0||angular.isDefined(e.payments.paymentMethods.credit_balance)&&e.payments.paymentMethods.credit_balance.length>0||angular.isDefined(e.payments.paymentMethods.promo)&&e.payments.paymentMethods.promo.length>0?!0:!1},e.canCheckout=function(){return B()?!angular.isDefined(e.location)||!angular.isDefined(e.location.phone)||null===e.location.phone||e.location.phone.length<14?!1:!0:!1},e.$watch(function(){return a.innerWidth},function(){e.mainCuisine=l.selectImageHeaderSize($,a.innerWidth),e.cuisineHeader=R(e.mainCuisine)}),e.toggleCardForm=function(){e.showAddCardForm=!e.showAddCardForm,e.showAddCardForm===!1?(e.cardErrors={cc_number:!1,exp_month:!1,exp_year:!1,cvv:!1,billing_zip:!1},e.payments.credit=ab):(ab=e.payments.credit,e.payments.credit=null)},e.ecommerceDataPush=function(b,c,d,e){var f,g=[];for(f=0;f<c.length;f++)g.push({name:c[f].name,id:c[f].id,price:c[f].price/c[f].quantity,quantity:c[f].quantity,brand:b});a.dataLayer.push({event:"OrderAction",eventCategory:"Checkout",eventAction:d,eventLabel:b,ecommerce:{checkout:{actionField:{step:e},products:g}}})},e.orderType=cb.getOrderType(),e.orderTime=cb.getOrderTime(),"ASAP"===e.orderTime)e.orderTime="Today ASAP";else{e.orderTime=Date.create(e.orderTime).format("{Dow} {MM}/{dd}/{yyyy} at {12hr}:{mm}{tt}");var ib=Date.create().format("{Dow} {MM}/{dd}/{yyyy}");e.orderTime=e.orderTime.replace(ib,"Today")}e.promoProcessing=!1,e.promo_gift_code="",e.hasPromoGiftCode=!1;var jb;c.page={bodyClasses:"page-checkout",title:"Checkout | delivery.com"},e.phoneIncomplete=function(a,b){return null!==a&&angular.isDefined(a)&&a.toString().length<b?!0:!1},e.validatePhoneFormat=function(a){e.phoneError=!a.target.checkValidity()||e.phoneIncomplete(e.location.phone,14)?!0:!1},e.extractAdditionalEcommerceItems=function(a,b){var c=[],d=a||db.getCheckoutInfo(),f=b||cb.getInfo();if("undefined"!=typeof f.discount&&0!==f.discount&&c.push({name:"discount",price:-f.discount,quantity:1,brand:e.merchantName}),"undefined"!=typeof d.tip&&0!==d.tip&&c.push({name:"tip",price:d.tip,quantity:1,brand:e.merchantName}),f.fees.length>0)for(var g=0;g<f.fees.length;g++)c.push({name:f.fees[g].name,price:f.fees[g].value,quantity:1,brand:e.merchantName});if(d.adjustments.length>0)for(var h=0;h<d.adjustments.length;h++)c.push({name:d.adjustments[h].type+" - "+d.adjustments[h].name,price:-d.adjustments[h].amount,quantity:1,brand:e.merchantName});return c},e.getSelectedLaundryPickupTime=function(){if(!angular.isDefined(e.pickupTimeOptions)||0===e.pickupTimeOptions.length)return"";if(!angular.isDefined(cb))return"";var a,b,c=cb.getInfo();for(b=0;b<e.pickupTimeOptions.length;b++)if(a=e.pickupTimeOptions[b],a.value===c.laundry_pickup_time)return Q(a.name);return"Not set yet"},e.getSelectedLaundryDeliveryTime=function(){if(!angular.isDefined(e.deliveryTimeOptions)||0===e.deliveryTimeOptions.length)return"";if(!angular.isDefined(cb))return"";var a,b,c=cb.getInfo();for(b=0;b<e.deliveryTimeOptions.length;b++)if(a=e.deliveryTimeOptions[b],a.value===c.laundry_delivery_time)return Q(a.name);return"Not set yet"},e.togglePromo=function(a){e.payments.promo=e.payments.promo===a?null:a,e.savePaymentType()},V();var kb=e.currentGroup;Leanplum.advanceTo("Checkout Page",{vertical:kb}),e.savePhone=function(){db.setPhone(e.location.phone)},e.saveUnit=function(){db.setAddressUnit(e.location.unit)},e.saveInstructions=function(){db.setSpecialInstructions(e.specialInstructions)},e.saveMerchantName=function(){db.setMerchantName(e.merchantName)},e.setLaundryDeliveryTimes=function(a){e.deliveryTimeError=null===a||""===a?!0:!1,e.delivery_time=a,cb.setLaundryDeliveryTime(a)},e.getLaundryDeliveryTimes=function(a,b){if(null===a||""===a)return void(e.pickupTimeError=!0);e.pickupTimeError=!1,e.pickup_time=a,cb.setLaundryPickupTime(a);var c={merchant:bb,orderType:cb.getOrderType()};e.deliveryTimeProcessing=!0,r.getCart(c,a).then(function(a){e.deliveryTimeOptions=[],angular.forEach(a.laundry_delivery_times,function(a){e.deliveryTimeOptions.push({name:a.string,value:a.timestamp})}),b||e.setLaundryDeliveryTimes(null),e.deliveryTimeProcessing=!1})},e.deliveryTimeDefaultLabel=function(){return e.deliveryTimeProcessing?"Loading...":e.pickup_time?"Select a delivery time":"Select a pickup time first"},e.hasPromoGiftCodeEntered=function(){e.hasPromoGiftCode=angular.isDefined(e.promo_gift_code)&&null!==e.promo_gift_code&&""!==e.promo_gift_code?!0:!1},e.applyPromo=function(){e.promoProcessing=!0,t.applyPromoDealByCode(e.promo_gift_code,bb).then(function(a){e.promo_gift_code="",e.promoProcessing=!1,e.promoSuccess=!0,e.promoGiftErrors=!1,s(function(){e.promoSuccess=!1,e.hasPromoGiftCode=!1},2e3);var b=e.payments.promo,c=e.payments.giftCodes;z().then(function(d){if(e.payments=d,d.acceptsCredit){e.setActivePaymentType("credit"),jb=db.getCheckoutInfo(),angular.isDefined(jb.tip)&&null!==jb.tip&&db.setTip(jb.tip),cb.reload();var f=!1;a.deal?angular.forEach(e.payments.paymentMethods.promo,function(b){return b.id===a.deal.id?(e.payments.promo=a.deal.id,f=!0,void H(Z)):void 0}):e.payments.promo=b,f?e.payments.giftCodes=c:angular.forEach(e.payments.giftCodes,function(a,b){e.payments.giftCodes[b]=angular.isDefined(c[b])?c[b]:!0})}})},function(a){e.promoProcessing=!1,a&&(e.promoGiftErrors=a[0])})},e.getDiscountName=function(a){var b="";return a.code?"marketing"===a.reward?b+=a.code:(b+="Promotion - "+a.code,"dollar_off"===a.reward&&0!==a.value?b+=" ($"+a.value+" off)":"percent_off"===a.reward&&0!==a.value&&(b+=" ("+a.value+"% off)")):b=a.name,b},e.getDiscountDesc=function(a,b){var c="";return"promo"===b?"marketing"===a.reward?c+=a.checkout_message:(a.first_order===!0&&(c+="First-time purchase only."),a.minimum&&(""!==c&&(c+=" "),c+="Minimum subtotal of $"+a.minimum+" required."),a.valueLimit&&(""!==c&&(c+=" "),c+="Maximum $"+a.valueLimit+" in savings."),a.first_order===!1&&1===a.total_uses&&(""!==c&&(c+=" "),c+="Limit one per customer."),a.expires&&(""!==c&&(c+=" "),c+="Offer ends "+u("date")(a.expires,"shortDate")+", "+u("date")(a.expires,"shortTime").toLowerCase()+" EST")):"giftcard"===b?a.expires?c="Gift card expires"+u("date")(a.expires,"shortDate")+", "+u("date")(a.expires,"shortTime").toLowerCase()+" EST":a.name&&(c=a.name):"credit"===b&&a.name&&(c=a.name),c},e.$watch("[pickupTimeOptions, deliveryTimeOptions]",Y,!0),e.$on("cartChange",function(){if(fb.checkout=b.search().pp?!0:!1,fb.checkout?(fb.token=b.search().token,fb.processed=!0,H("paypal"),N()):fb.checkout=!1,!fb.checkout&&fb.processed&&(fb.processed=!1),"undefined"!=typeof cb){if("undefined"!=typeof db){var a=db.getCheckoutInfo();z().then(function(b){e.promo_gift_code="",e.promoGiftErrors=!1,e.payments.paymentMethods=b.paymentMethods,a=db.getCheckoutInfo(),angular.isDefined(a.tip)&&null!==a.tip&&db.setTip(a.tip),angular.extend(e.cartInfo,cb.getInfo()),c.$broadcast("CheckoutChange"),e.payments.acceptsCash=b.acceptsCash,e.payments.cashDisabled=b.cashDisabled,G(Z)||"cash"!==Z||H("credit")})}angular.extend(e.cartInfo,cb.getInfo())}}),e.submit=L,e.setActivePaymentType=H,e.isActivePaymentType=I,e.savePaymentType=F,e.paypal=fb}]),angular.module("dcomApp").controller("ContactUsCtrl",["$rootScope","$scope","$window","FeedbackAPI","UserMessages",function(a,b,c,d,e){function f(){a.page={bodyClasses:"page-contact",title:"delivery.com | Contact Us By Phone Or Email",description:"Call our customer service for any issue you may be experiencing. Your business is important to us."},a.header={backAction:function(){c.history.back()}},b.contact={},b.contact.reason="Reason for contact",b.processing=!1}b.submitContactForm=function(){return b.processing?!1:(b.processing=!0,void b.sendComments(b.contact.email,b.contact.name,b.contact.phone,b.contact.reason,b.contact.comments).then(function(){b.toggleForm()},function(a){e.printError(a)}).finally(function(){b.processing=!1}))},b.sendComments=function(a,b,c,e,f){var g={email:a,name:b,phone:c,reason:e,comments:f};return d.sendcontactForm(g)},b.toggleForm=function(){b.submitted=!b.submitted,f()},b.submitted=!1,f()}]),angular.module("dcomApp").controller("GameifyModalCtrl",["$window","$rootScope","$scope","MarketingAPI","UserMessages","DateService",function(a,b,c,d,e,f){function g(b){a.dataLayer.push({event:"OrderAction",eventCategory:"displayed"===b?"Order Confirm":"Game displayed",eventAction:"Game "+b,eventLabel:"displayed"===b?"":c.ngDialogData.vertical+" - "+c.promoText.join(" ")})}var h=["The fortune you seek","is in another cookie."],i=!1;c.showText=!1,c.cookieClass="delayShake";var j=f.formatCurrentDay();c.currentDay=j.join("/"),c.showPromoText=function(){c.showText=!0,c.footerClass=c.winner?"expand winner":"expand loser"},c.getPromo=function(){i||(i=!0,c.cookieClass="shake",d.getFortuneCookieText(c.ngDialogData.orderInfo.order_id).then(function(a){c.winner=angular.isDefined(a.flag)&&a.flag||!1,c.promoText=a.message||h},function(){c.winner=!1,c.promoText=h}).finally(function(){c.cookieClass="open",c.ngDialogData.orderInfo.hasPlayedGame=!0,g("interaction")}))},g("displayed")}]),angular.module("dcomApp").controller("DishRecommendationCtrl",["$rootScope","$scope","$window","$location","$modal","$q","MerchantAPI","CartProvider","Schedule","Urls","UserMessages","User",function(a,b,c,d,e,f,g,h,i,j,k,l){function m(a){var c="";return a&&a.length&&(c+='<p class="name">'+b.data.name+"</p>",c+='<p class="desc">'+a+"</p>"),c}function n(){var a=document.querySelector(".tooltip.dish-recommendation");a&&document.querySelector(".tooltip.dish-recommendation").remove()}function o(a,b,c){var d=a.setOrderTime(c.orderTime,b),e=a.setOrderType(c.orderType,b);return f.all([e,d])}function p(a){return"l"===a.id[0].toLowerCase()}function q(a){return!a.available}function r(a){return a.toLowerCase().replace(/ /g,"")}function s(a,b){return a&&b?-1===r(a).indexOf(r(b)):!1}function t(a){a=a||{};var b=l.getUserAuthToken()?"Logged In":"Logged Out",d=c.igb?"BaskPredict":"Top Dishes",e={"Added To Cart":{label:a.item.name+" - "+a.item.merchant_name,value:a.item.price},Clicked:{label:a.item.name+" - "+a.item.merchant_name,value:a.index+1},"Add Error":{label:a.item.name+" ("+a.itemId+") - "+a.item.merchant_name,value:""},"Name Error":{label:a.item.merchant_name+"("+a.item.merchand_id+") "+a.item.name+" - "+a.modalName,value:a.entityId+" - "+a.navigationId}};c.dataLayer.push({event:"OrderAction",eventCategory:"Dish Reco",eventAction:"Dish Reco "+a.action+" - "+d+", "+b,eventLabel:e[a.action].label,eventValue:e[a.action].value})}c.dataLayer=c.dataLayer||[];var u=!1,v={invalidTime:"Sorry, this menu item is not available for the specified time. Please try another recommendation.",invalidMenu:"Sorry, the menu was recently updated and this item cannot be added to cart. Please try another recommendation."};b.data.star_rating&&(b.viewStarRating=b.data.star_rating),b.tooltipDesc=m(b.data.description),b.itemClick=function(a,b){if(!u){u=!0,n();var c,f,l=a.igb_uid||null,m=h.get(a.merchant_id);m.reload().then(function(){return c={orderTime:i.getOrderTime("search"),orderType:i.getOrderType("search")},o(m,a.merchant_id,c)}).then(function(){return f="E"+a.item_id,g.getItem(a.merchant_id,f,c.orderTime)}).then(function(b){var c=b.item[0];p(c)?(k.printMessage({message:v.invalidMenu}),t({action:"Add Error",item:a,itemId:c.id})):s(c.name,a.name)?(k.printMessage({message:v.invalidMenu}),t({action:"Name Error",modalName:c.name,entityId:f,navigationId:c.id,item:a})):q(c)?k.printMessage({message:v.invalidTime}):e.open({templateUrl:"views/modals/itemOptions.html",windowClass:"item-option-modal",resolve:{item:function(){return c},cart:function(){return m},merchantUrl:function(){return a.url},igbId:function(){return l}},controller:["$window","$scope","item","cart","merchantUrl","igbId",function(b,c,e,f,g,h){c.item=e,c.actionText="Add to cart";var i=b.dishRec&&b.igb&&"gb"||b.dishRec&&"dcom"||null;c.action=function(b){f.add(b,i,h).then(function(){c.$dismiss("added to cart"),t({action:"Added To Cart",item:a}),d.url(j.getMerchantUrl(g,!0))},function(){c.$dismiss()})}}]})}).catch(function(a){k.printAPIMessage(a)}).finally(function(){u=!1}),t({action:"Clicked",item:a,index:b})}}}]),angular.module("dcomApp").controller("HeaderCtrl",["User","$location","$rootScope","$scope","$timeout","TafAPI","Group","ModalPages","$window","DcomConfig","olarkChat","numberFilter","HammerEvents","Device",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){function o(){var a=document.querySelectorAll(".menu-overlay");a.length>1&&a[0].remove()}d.tafNavActive=!1,d.hiwNavActive=!1,d.accountNavActive=!1,i.dataLayer=i.dataLayer||[],d.$watch(function(){return g.currentGroup()},function(){d.hiwLaundry="l"===g.currentGroup()?!0:!1}),d.isMobileApp=n.isMobileApp,d.toggleAccountNav=function(){return c.userData?(d.closeOnClickOut(d.accountNavActive,d.toggleAccountNav),d.accountNavActive=!d.accountNavActive,d.tafNavActive=!1,void(d.hiwNavActive=!1)):(h.openPage("login"),void i.dataLayer.push({event:"HeaderAction",eventCategory:"Header",eventAction:"Log in clicked"}))},d.hideAccountNav=function(){d.accountNavActive=!1},d.login=function(){d.hideAccountNav(),h.openPage("login")},d.logout=function(){d.accountNavActive&&(d.hideAccountNav(),angular.element(document.getElementById("menu-overlay")).remove()),a.logout()},d.toggleTafNav=function(){d.accountNavActive=!1,d.hiwNavActive=!1,d.closeOnClickOut(d.tafNavActive,d.toggleTafNav),d.tafNavActive=!d.tafNavActive},d.toggleHiwNav=function(){d.accountNavActive=!1,d.tafNavActive=!1,d.closeOnClickOut(d.hiwNavActive,d.toggleHiwNav),d.hiwNavActive=!d.hiwNavActive},d.toggleHiwDisplay=function(){d.hiwLaundry=!d.hiwLaundry},d.headerChat=function(){k.open(),i.dataLayer.push({event:"HeaderAction",eventCategory:"Chat",eventAction:"Chat clicked - header",eventLabel:b.path()})},d.applyOverlay=function(a){var b=angular.element('<div class="menu-overlay" id="menu-overlay"></div>'),c=document.getElementById("site-wrapper");document.body.insertBefore(b[0],c),m.onClick(b[0],a)},d.closeOnClickOut=function(a,b){if(a){var c=document.getElementById("menu-overlay");c.parentNode.removeChild(c)}else o(),d.applyOverlay(b);e(function(){d.$apply()},20)},d.$on("$destroy",o),c.maintenanceMode||(d.$watch(function(){return c.userData},function(){c.userData&&f.share().then(function(a){d.shareLink=b.host()+"/share?code="+a.share_info.share_code})}),f.getBounty().then(function(a){d.bountyType=a.bounty.referrer_reward_type,d.bountyAmount=l(a.bounty.referrer_reward_amount,0)}))}]),angular.module("dcomApp").controller("BreadCrumbCtrl",["$route","$location","$scope","$routeParams","SEOUrlBuilder",function(a,b,c,d,e){function f(a){var b=a.replace(/-/g," ");return b.charAt(0).toUpperCase()+b.slice(1)}function g(a){var b=e.getShortUrl(a);return b?b:a}function h(a){var b="";a.group.path&&(c.crumbs.push({path:g(b+a.group.path),name:f(a.group.text)}),b+=a.group.path),a.item.path&&(c.crumbs.push({path:g(b+a.item.path),name:f(a.item.text)}),b+=a.item.path),a.city.path&&(c.crumbs.push({path:g(a.city.path+"/categories"+a.group.path+a.item.path),name:f(a.city.text)}),b=a.city.path+"/categories"+a.group.path+a.item.path),a.category.path&&(c.crumbs.push({path:g(a.city.path+"/categories"+a.category.path),name:f(a.category.text)}),b=a.city.path+"/categories"+a.category.path),a.neighborhood.path?(c.crumbs.push({path:g(b+a.neighborhood.path),name:f(a.neighborhood.text)}),b+=a.neighborhood.path):a.zip.path&&(c.crumbs.push({path:g(b+a.zip.path),name:f(a.zip.text)}),b+=g(a.zip.path))}c.crumbs=[],c.$on("updateBreadCrumbs",function(a,b){h(b)})}]),angular.module("dcomApp").controller("OrderSettingsCtrl",["$controller","$timeout","$scope","$rootScope","$window","$q","$modal","MerchantAPI","CartAPI","CartProvider","Cookies","Group",function(a,b,c,d,e,f,g,h,i,j,k,l){function m(a){var b,c,d=[];return b=null!==a.ordering.availability.next_pickup_time||null!==a.ordering.availability.last_pickup_time,c=null!==a.ordering.availability.next_delivery_time||null!==a.ordering.availability.last_delivery_time,b&&d.unshift("pickup"),c&&d.unshift("delivery"),d}function n(a){var b=f.defer(),c=t("globalOrderType"),d=t(a.id+"_orderType"),e="delivery";return c?e=c:d&&(e=d),-1===x.availableOrderTypes.indexOf(e)&&(e=x.availableOrderTypes[0]),b.resolve(e),b.promise}function o(a){var b=f.defer(),c=Date.create(),e=1..hoursAfter(c),g=t("globalOrderTime"),h=t(a.id+"_orderTime"),i="ASAP";return g?i=g:h&&(i=h),"ASAP"!==i&&Date.create(i).isBefore(e)&&(i="ASAP"),d.$broadcast("orderTimeUpdate",x.orderTime),b.resolve(i),b.promise}function p(a){if(x.orderableTimes){if(!x.orderTime){var b=t("globalOrderTime");if(!b)return;x.orderTime=b}var c=f.defer(),e=x.orderTime,g=x.orderableTimes[0];return e="ASAP"===e?s(a)?e:g:r(e)?e:g,x.orderTime=e,d.$broadcast("orderTimeUpdate",x.orderTime),q().then(function(a){a.message.length>0&&"Xerror_nat"===a.message[0].code?u(a).then(function(){c.resolve()},function(){c.reject()}):c.resolve()},function(){c.reject()}),c.promise}}function q(){var a=f.defer(),b={orderType:x.orderType,orderTime:x.orderTime};return x.cartProvider.reload(b).then(function(b){a.resolve(b)},function(b){a.reject(b)}),a.promise}function r(a){if(x.orderableTimes){var b="{yyyy}-{MM}-{dd}T{HH}:{mm}:{ss}{tz}",c="ASAP"===a?a:Date.create(a).format(b),d=!1;return-1!==x.orderableTimes.indexOf(c)&&(d=!0),d}}function s(a){if(x.orderType&&a.ordering){var b;return"delivery"===x.orderType?b=null===a.ordering.availability.next_delivery_time:"pickup"===x.orderType&&(b=null===a.ordering.availability.next_pickup_time),b}}function t(a){var b=angular.isDefined(k.getCookie(a)),c=b?k.getCookie(a):!1;return c}function u(a){var b=f.defer(),c={};c.cart=a,c.orderType=x.orderType,c.orderTime=x.orderTime,c.merchantInfo=x.merchantInfo,c.saveSettings=x.saveSettings,c.currentGroup=l.currentGroup();var d=g.open({templateUrl:"views/modals/itemsUnavailable.html",windowClass:"invalid-items-modal",resolve:{orderSettings:function(){return c}},controller:"InvalidCartItemsModalCtrl as modalCtrl"});return x.processing=!1,d.result.then(function(a){"remove items"===a?b.resolve():b.reject()}),b.promise}function v(a){a=a||{},q().then(function(b){x.cartInfo=b,x.orderableTimes=x.cartInfo.orderable_times,x.orderDayOptions=x.getDays(),x.orderTimeOptions=x.getTimesForDay(),p(x.merchantInfo).then(function(){x.splitOrderTime(x.orderTime).then(function(){x.changeSelectedDay()}).finally(function(){x.cartProvider.setOrderTime(x.orderTime),x.selectedDayLabel=x.selectedDay===x.todayFormatted?"Today":x.selectedDay,x.selectedTimeLabel="ASAP"===x.selectedTime?"ASAP":Date.create(x.selectedTime).format(x.timeFormat),a.successFn&&a.successFn(),d.$broadcast("cartChange"),x.disableToggle=!(x.typeIsAvailable("pickup")&&x.typeIsAvailable("delivery")),x.setSearchAddress(a.address),x.setTooltips(),x.initialized=!0})},function(){x.cancelSettingsChange()})})}function w(){if(angular.isDefined(c.merchantInfo.id)){var a,b;x.dateFormat="{Dow} {MM}/{dd}/{yyyy}",x.timeFormat="{12hr}:{mm}{tt}",x.todayFormatted=Date.create().format(x.dateFormat),x.asapAvailable=s,x.validateSettings=p,x.merchantInfo=c.merchantInfo,x.cartInfo=c.cart||{},x.availableOrderTypes=m(x.merchantInfo),x.getPreviousSettings=t,x.cartProvider=j.get(x.merchantInfo.id),a=n(x.merchantInfo),b=o(x.merchantInfo),f.all([a,b]).then(function(a){x.setOrderType(a[0]),x.orderTime=a[1],x.cartProvider.setOrderType(x.orderType),v()})}}var x=this;x=angular.extend(x,a("OrderSettingsHelperCtrl",{$scope:c})),c.orderSettings=x,x.getCartWithLatestSettingsAndUpdate=v,w(),c.$on("cartChange",function(a,b){if(b&&"orderType"===b.change){var c;x.cartInfo&&!x.cartInfo.item_count?(c=t("globalOrderType"),x.setOrderType(c,!1),v()):(c=t("globalOrderType"),x.setOrderType(c,!0))}}),c.$on("locationChange",function(a,b){x.cartInfo&&!x.cartInfo.item_count&&v({address:b})}),c.$watch(function(){return c.merchantInfo},function(){x.merchantInfo=c.merchantInfo,x.setSearchAddress(),x.needsAddressGA&&x.sendGAaddress()},!0)}]),angular.module("dcomApp").controller("OrderSettingsHelperCtrl",["$scope","$modal","$rootScope","$window","$q","$timeout","Cookies","Animation","Group",function(a,b,c,d,e,f,g,h,i){function j(){angular.element(document.getElementById("site-wrapper")).append('<div class="content-overlay invisible" id="content-overlay"></div>'),F.processing=!0}function k(){var a=document.getElementById("content-overlay");a&&angular.element(a).remove(),f(function(){F.processing=!1},I)}function l(a){return-1!==F.availableOrderTypes.indexOf(a)}function m(a){d.dataLayer=d.dataLayer||[],d.dataLayer.push({event:"OrderAction",eventCategory:"Merchant",eventAction:"Change type and time",eventLabel:i.getGroupFromAnyKey(i.currentGroup(),"key").name+"-"+F.merchantInfo.summary.name+":"+a})}function n(){d.dataLayer=d.dataLayer||[];var a=i.getGroupFromAnyKey(i.currentGroup(),"key").name,b=Math.round((F.orderTime-Date.now())/36e5);d.dataLayer.push({event:"OrderAction",eventCategory:"Merchant",eventAction:"Change type and time",eventLabel:a+"-"+F.merchantInfo.summary.name+":"+F.orderType,eventValue:b}),Leanplum.track("Future order module triggered","Merchant page",{vertical:a,type:F.orderType,timeChange:b})}function o(){if(F.merchantInfo&&F.merchantInfo.search_address){var a=F.merchantInfo.search_address;d.dataLayer=d.dataLayer||[],d.dataLayer.push({event:"OrderAction",eventCategory:"Merchant",eventAction:"Add address",eventLabel:i.getGroupFromAnyKey(i.currentGroup(),"key").name+"-"+F.merchantInfo.summary.name+":"+F.orderType,eventValue:[a.street,a.city,a.state,a.zip_code].join(", ")})}}function p(a,b){l(a)&&a!==F.orderType&&(q(a,b),m(a))}function q(a,b){l(a)&&a!==F.orderType&&(F.orderType=a,b&&(F.merchantInfo&&!F.merchantInfo.deliverable&&"delivery"===a?u():C()))}function r(){"delivery"===F.orderType&&l("pickup")?(F.setOrderType("pickup",!0),m("pickup")):"pickup"===F.orderType&&l("delivery")&&(F.setOrderType("delivery",!0),m("delivery"))}function s(){F.deliveryTooltip=l("delivery")?"":G,F.pickupTooltip=l("pickup")?"":H}function t(a){var b=a||F.merchantInfo&&F.merchantInfo.search_address;b&&(F.searchAddress=b.street+", "+(b.zip_code||b.zip))}function u(){var a=b.open({templateUrl:"views/modals/merchantAddressError.html",controller:"MerchantAddressModalCtrl as modalCtrl",resolve:{merchantInfo:function(){return F.merchantInfo},ambiguousAddresses:function(){return void 0
}},windowClass:"address-modal"});a.result.then(function(){F.needsAddressGA=!0}).catch(function(){c.$broadcast("cartChange",{change:"orderType"})})}function v(){if(F.orderableTimes&&F.dateFormat){for(var a,b,c,d=Date.create(),e=[],f=0;f<F.orderableTimes.length;f++)a=Date.create(F.orderableTimes[f]).format(F.dateFormat),0===f&&a!==d.format(F.dateFormat)&&F.asapAvailable(F.merchantInfo)?c={name:"Today",value:d.format(F.dateFormat)}:(b=a===d.format(F.dateFormat)?"Today":a,c={name:b,value:a}),-1===B(e).indexOf(c.value)&&e.push(c);return e}}function w(a){if(F.orderableTimes){for(var b,c,d,e,f=Date.create(),g="ASAP"===a?f:Date.create(a),h=[],i=0;i<F.orderableTimes.length;i++)b=Date.create(F.orderableTimes[i]),c=b.format(F.dateFormat),d=b.format(F.timeFormat),e={name:d,value:b},c===g.format(F.dateFormat)&&h.push(e);return g.format(F.dateFormat)===f.format(F.dateFormat)&&(F.asapAvailable(F.merchantInfo)||F.asapAvailable(F.cartInfo))&&(e={name:"ASAP",value:"ASAP"},h.unshift(e)),h}}function x(a){var b,c=e.defer(),d=Date.create();return F.selectedDay={},F.selectedTime={},b="ASAP"===F.orderTime?d:Date.create(a),b===d?(F.selectedTime="ASAP",F.selectedDay=d.format(F.dateFormat)):(F.selectedTime=b.format(F.timeFormat),F.selectedDay=b.format(F.dateFormat)),c.resolve(),c.promise}function y(){if(F.selectedDay&&F.selectedTime){if(F.orderTimeOptions=w(F.selectedDay),0===F.orderTimeOptions.length){var a=new Date(F.selectedDay);F.selectedDay=new Date(a.setDate(a.getDate()+1)).format(F.dateFormat),F.orderTimeOptions=w(F.selectedDay)}if("ASAP"===F.selectedTime&&-1===B(F.orderTimeOptions).indexOf("ASAP"))return void(F.selectedTime=F.orderTimeOptions[0].value);var b=Date.create(F.selectedTime).format(F.timeFormat),c=B(F.orderTimeOptions,F.timeFormat),d=c.indexOf(b);F.selectedTime=-1===d?F.orderTimeOptions[0].value:F.orderTimeOptions[d].value}}function z(){F.orderType=F.getPreviousSettings(F.merchantInfo.id+"_orderType"),F.orderTime=F.getPreviousSettings(F.merchantInfo.id+"_orderTime"),c.$broadcast("orderTimeUpdate",F.orderTime),x(F.orderTime).then(function(){y(),F.initialized=!0,F.removeProcessingOverlay()})}function A(a){var b=angular.element(document.getElementById("order-time-edit")).hasClass("hide");a?b?(angular.element(document.getElementById("order-time-label")).addClass("hide"),h.slide("down","order-time-edit",I/1e3,!0,function(){angular.element(document.getElementById("order-time-edit")).removeClass("hide")})):h.slide("up","order-time-edit",I/1e3,!1,function(){angular.element(document.getElementById("order-time-edit")).addClass("hide"),angular.element(document.getElementById("order-time-label")).removeClass("hide")}):b?(angular.element(document.getElementById("order-time-label")).addClass("hide"),angular.element(document.getElementById("order-time-edit")).removeClass("hide")):(angular.element(document.getElementById("order-time-label")).removeClass("hide"),angular.element(document.getElementById("order-time-edit")).addClass("hide"))}function B(a,b){var c,d=a.map(function(a){return c=angular.isDefined(b)?Date.create(a.value).format(b):a.value});return d}function C(){F.addProcessingOverlay();g.getCookie(F.merchantInfo.id+"_orderTime");F.getCartWithLatestSettingsAndUpdate({successFn:function(){F.removeProcessingOverlay(),g.setCookie("globalOrderType",F.orderType,{expires:g.setExpInHours(1)}),g.setCookie(F.merchantInfo.id+"_orderType",F.orderType,{expires:g.setExpInHours(3)})}})}function D(){F.selectedTime&&(E(),n())}function E(a){F.orderTime=F.selectedTime,F.addProcessingOverlay(),F.validateSettings(F.merchantInfo).then(function(){F.splitOrderTime(F.orderTime),F.cartProvider.setOrderTime(F.orderTime),g.setCookie("globalOrderTime",F.orderTime),c.$broadcast("orderTimeUpdate",F.orderTime),F.selectedDayLabel=F.selectedDay===F.todayFormatted?"Today":F.selectedDay,F.selectedTimeLabel=F.selectedTime,a||F.toggleEditForm(!0),F.splitOrderTime(F.orderTime).then(function(){F.changeSelectedDay(),c.$broadcast("cartChange"),F.removeProcessingOverlay()})},function(){F.cancelSettingsChange()})}var F=a.orderSettings,G="This business is only available for pickup",H="This business is only available for delivery",I=280;F.addProcessingOverlay=j,F.removeProcessingOverlay=k,F.typeIsAvailable=l,F.setOrderTypeFromClick=p,F.setOrderType=q,F.toggleOrderType=r,F.setTooltips=s,F.setSearchAddress=t,F.openAddressErrorModal=u,F.getDays=v,F.getTimesForDay=w,F.splitOrderTime=x,F.changeSelectedDay=y,F.cancelSettingsChange=z,F.toggleEditForm=A,F.mapOptionValues=B,F.saveSettings=E,F.saveSettingsFromClick=D,F.sendGAaddress=o}]),angular.module("dcomApp").controller("HomeCtrl",["User","UserAPI","$rootScope","$scope","$location","$window","$modal","$filter","$timeout","$interval","$q","TafAPI","Cookies","Group","OrderAPI","CartAPI","SearchLocation","UserMessages","ScheduleProvider","ModalPages","modalOnLoad","send404","NewUserPromo","Reorder","HomeImages","prizes",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z){function A(){o.getRecentOrders(5).then(function(a){d.recentOrders=a;for(var b=a.length,c=0;b>c;c++)d.recentOrders[c].remainingTooltipItems=B(a[c])}),o.getFavoriteOrders(5).then(function(a){a.sort(function(a,b){return parseInt(b.favorite_order_id)-parseInt(a.favorite_order_id)}),d.favoritedOrders=a;for(var b=a.length,c=0;b>c;c++)d.favoritedOrders[c].remainingTooltipItems=B(a[c])}),d.getOtherAccounts()}function B(a){for(var b=[],c=a.itemNames.length,d=0;c>d;d++)b.push(a.itemNames[d]);return b.splice(b.indexOf(a.maxPricedItem.name),1),b=b.join("\n\n- ")}function C(a){for(var b,c=[],d=angular.copy(a),e=D();d.length>0;)b=d.splice(0,e),c.push(b);return c}function D(){var a={f:3,b:2,g:1,l:1},b={f:5,b:2,g:1,l:2},e={f:9,b:3,g:2,l:3};return c.matchMedia.small?a[d.currentGroup]:c.matchMedia.smallPortrait?b[d.currentGroup]:e[d.currentGroup]}function E(){return c.matchMedia.medium?"desktop_hd_380x200":c.matchMedia.small?"desktop_300x200":c.matchMedia.smallPortrait?"tablet_364x200":"tablet_748x200"}function F(){return c.matchMedia.medium?"desktop_780x200":c.matchMedia.small?"desktop_620x200":c.matchMedia.smallPortrait?"tablet_364x200":"tablet_748x200"}function G(){d.cuisinesColumns=C(T),d.citiesColumns=C(U[d.currentGroup]),d.imageSize=E(),d.longCityImageSize=F()}function H(a){for(var b,c,d=a.length;0!==d;)c=Math.floor(Math.random()*d),d--,b=a[d],a[d]=a[c],a[c]=b;return a}function I(){var a=0;for(var b in W)W[b].length>a&&(a=W[b].length);return a}function J(a){var b=a?a:d.currentGroup,c=Y[Z%Y.length];return c>W[b].length-1?(Z++,J(a)):W[b][c]}function K(a){var b=k.defer(),c=new Image;return c.src=a,c.onload=function(){b.resolve()},c.onerror=function(){b.reject()},b.promise}function L(a,b){d.divClasses[b].style={"background-image":"url("+a+")"}}function M(a){var b=y.getDimensions(d.dimensions);return"/images/static/home-backgrounds/"+a+"_"+b+".jpg"}function N(){"next"===d.nextKey?(d.nextKey="current",d.currentKey="next"):(d.nextKey="next",d.currentKey="current"),d.divClasses[d.currentKey].class="in",d.divClasses[d.nextKey].class="out"}function O(a){V&&i.cancel(V),angular.isUndefined(a)&&(a=$),V=i(function(){var a=J(),b=M(a);K(b).then(function(){L(b,d.nextKey),N(),d.currentImageName=a,Z++,O()},function(){Z<I()&&(Z++,O())})},a)}function P(){d.currentImageName=J();var a=M(d.currentImageName);K(a).then(function(){L(a,d.currentKey),Z++,O()},function(){Z<I()&&(Z++,P())})}if(window.optimizely=window.optimizely||[],window.bLazy=null,d.isPrerender=!1,d.buckets=z.prizes.buckets,-1!==navigator.userAgent.search("prerender")&&(d.isPrerender=!0),v)return void e.path("/404");u&&!e.search().logout&&t.openPage(u),window.optimizely.push(["activate"]),window.activatePromo&&w.activateModal(),l.getBounty(e.search().sharer).then(function(a){var b="Join me on delivery.com and get ";a&&("P"===a.bounty.referrer_reward_type?(d.reward_message=h("number")(parseInt(a.bounty.referrer_reward_amount),0)+" extra points",b+=" "+d.reward_message+" on "):(d.reward_message="$"+h("number")(a.bounty.referrer_reward_amount,0),b+=" "+d.reward_message+" off "),b+="your next order of food, alcohol, groceries or laundry.",e.search().sharer&&(c.page.description=b))}),d.getSearchPlaceholder=function(){return"Street Address, City, State"},d.removeTaFBanner=function(){m.setCookie("removetafbanner","yes",{expires:365}),d.removeBanner="yes"};var Q="Join me on delivery.com and get $7 off your next order of food, alcohol, groceries or laundry.",R="Order from local restaurants, liquor and grocery stores; even schedule laundry and dry cleaning online for pickup and delivery. Free to use.";c.page={title:"delivery.com | Order Food, Alcohol, Laundry & More Online",description:e.search().sharer?Q:R,bodyClasses:"page-home"},"/"===e.url()&&(c.page.canonicalUrl=e.absUrl().substring(0,e.absUrl().length-1)),"/404"===e.path()&&(c.send404=!0),d.activeTab="recent",d.toggleTab=function(a){d.activeTab=a},d.goToDeliveryPointsPage=function(){e.path("/delivery-points"),f.dataLayer.push({event:"UserAction",eventCategory:"Homepage",eventAction:"Delivery points"})},d.groups=n.getHomeEnabled(),d.setGroupByKey=function(a){n.currentGroup(a),d.currentGroup=a},d.switchTab=function(a,b,c){c&&c.preventDefault(),a!==d.currentGroup&&(e.search("food"!==b?b:{}),d.setGroupByKey(a),Z=0,O(0))};var S={f:["See who delivers"," in your neighborhood."],b:["Order beer, wine and"," liquor on demand."],g:["Find groceries and"," home essentials."],l:["Connect with the"," best local cleaners."]};d.getHeaderText=function(a){return S[d.currentGroup][a]},d.getOtherAccounts=function(){b.getUserInfo().then(function(a){d.accounts=a.user.roles,d.userEmail=a.user.email;for(var b=[],c=[{name:"MERCHANT_ADMIN",label:"Merchant",link:"https://admin.delivery.com/login.php?email="+d.userEmail},{name:"PARTNER",label:"Partner",link:"https://admin.delivery.com/login.php?email="+d.userEmail},{name:"API",label:"API",link:"https://admin.delivery.com/login.php?email="+d.userEmail}],e=c.map(function(a){return a.name}),f=0;f<d.accounts.length;f++)-1!==e.indexOf(d.accounts[f])&&b.push({label:c[e.indexOf(d.accounts[f])].label,link:c[e.indexOf(d.accounts[f])].link});d.accounts=b,d.otherAccounts=d.accounts.length>0})},d.buildLinkUrl=function(a,b){if("cuisine"===a)return"/food"+("See all cuisines"!==b.name?"/"+b.param:"");if("city"===a){var c="/cities";return"f"!==d.currentGroup&&(c=d.verticalParam(d.currentGroup)),"See all cities"===b.name?c:"/"+b.param+d.verticalParam(d.currentGroup)}},d.tooltipEnabled=function(){return c.matchMedia.small},d.repeat=function(a){e.path("/account/repeat-orders/create/"+a.order_id),f.dataLayer.push({event:"OrderAction",eventCategory:"Homepage",eventAction:"Repeat clicked",eventLabel:a.name})},d.reorder=function(a){var b;if(a.type||(a.type="delivery"),!d.processing){d.processing=!0;var c=a.vertical?a.vertical.label:a.type,g=a.name,h=c+"-"+g;f.dataLayer.push({event:"OrderAction",eventCategory:"Homepage",eventAction:"Re-order clicked",eventLabel:h});var i=Leanplum.getVariables();i.home_reorder=!0,i.merchant_reorder=!1,Leanplum.setVariables(i),Leanplum.track("Reorder","Homepage",{vertical:c}),b=a.is_laundry_order?"laundry":"default";var j=!0;x.reorder(a,b,j).then(function(a){e.path("/cities/"+a.url.geo_tag+"/categories/"+a.url.merchant_type+"/"+a.url.short_tag)}).finally(function(){d.processing=!1})}},d.currentGroup||n.currentGroup()?d.setGroupByKey(n.currentGroup()):e.search().alcohol?(d.setGroupByKey("b"),c.page.title="delivery.com | Same Day Alcohol Delivery | Order Online",c.page.description="Use delivery.com to order beer, wine and more online from local liquor stores for same day delivery. Free to use. Earn Delivery Points with every order."):e.search().groceries?(d.setGroupByKey("g"),c.page.title="delivery.com | Order Groceries & Essentials Online",c.page.description="Use delivery.com to order groceries and other home essentials online for local, same-day delivery. Free to use. Earn Delivery Points with every order."):e.search().laundry?(d.setGroupByKey("l"),c.page.title="delivery.com | Laundry, Dry Cleaning Pickup & Delivery",c.page.description="Use delivery.com to get your laundry and dry cleaning picked up and delivered by local cleaners. Free to use. Organic cleaners and tailors also available."):d.setGroupByKey("f"),d.removeBanner="no","yes"===m.getCookie("removetafbanner")&&(d.removeBanner="yes"),d.favoritedOrders=[],d.recentOrders=[],d.otherAccounts=!1,a.getUserAuthToken()&&A(),"yes"===e.search().deal_applied&&m.getCookie("deal_id")?d.message="You are enrolled in "+e.search().deal_name:"no"===e.search().deal_applied&&(d.message="Sorry "+e.search().deal_name+" has expired."),d.$on("authSuccess",function(){A()});var T=[{name:"American",param:"american"},{name:"Asian",param:"asian"},{name:"Bagels",param:"bagels"},{name:"BBQ",param:"bbq"},{name:"Breakfast",param:"breakfast"},{name:"Burgers",param:"burgers"},{name:"Deli",param:"deli"},{name:"Desserts",param:"desserts"},{name:"Fusion",param:"fusion"},{name:"Indian",param:"indian"},{name:"Italian",param:"italian"},{name:"Japanese",param:"japanese"},{name:"Mediterranean",param:"mediterranean"},{name:"Middle Eastern",param:"middle-eastern"},{name:"Sandwiches",param:"sandwiches"},{name:"Vegetarian",param:"vegetarian"},{name:"Wings",param:"wings"},{name:"See all cuisines",param:""}],U={f:[{name:"Arlington, VA",param:"arlington"},{name:"Atlanta, GA",param:"atlanta"},{name:"Boston, MA",param:"boston"},{name:"Bronx, NY",param:"bronx"},{name:"Brooklyn, NY",param:"brooklyn"},{name:"Cambridge, MA",param:"cambridge"},{name:"Dallas, TX",param:"dallas"},{name:"Denver, CO",param:"denver"},{name:"Hoboken, NJ",param:"hoboken"},{name:"Jersey City, NJ",param:"jersey-city"},{name:"Miami, FL",param:"miami"},{name:"Philadelphia, PA",param:"philadelphia"},{name:"Queens, NY",param:"queens"},{name:"San Jose, CA",param:"san-jose"},{name:"Somerville, MA",param:"somerville"},{name:"Stamford, CT",param:"stamford"},{name:"Washington, DC",param:"dc"},{name:"See all cities",param:""}],b:[{name:"Boston, MA",param:"boston"},{name:"Brooklyn, NY",param:"brooklyn"},{name:"Hoboken, NJ",param:"hoboken"},{name:"Queens, NY",param:"queens"},{name:"Washington, DC",param:"dc"},{name:"See all cities",param:""}],g:[{name:"Brooklyn, NY",param:"brooklyn"},{name:"Hoboken, NJ",param:"hoboken"},{name:"Jersey City, NJ",param:"jersey-city"},{name:"See all cities",param:""}],l:[{name:"Boston, MA",param:"boston"},{name:"Brooklyn, NY",param:"brooklyn"},{name:"Hoboken, NJ",param:"hoboken"},{name:"Queens, NY",param:"queens"},{name:"Washington, DC",param:"dc"},{name:"See all cities",param:""}]};d.verticalParam=function(a){var b=n.getGroupFromAnyKey(a,"key").name.toLowerCase();return"/"+b},G();var V,W={f:["HP_1_food","HP_2_food","HP_3_food","HP_4_food"],b:["HP_1_alcohol","HP_2_alcohol","HP_3_alcohol"],g:["HP_1_groceries","HP_2_groceries","HP_3_groceries","HP_4_groceries"],l:["HP_1_laundry","HP_2_laundry","HP_3_laundry"]},X=new Array(I()).join(" ").split(" ").map(function(a,b){return b}),Y=H(X),Z=0,$=5e3;d.divClasses={next:{"class":"out",style:""},current:{"class":"in",style:""}},d.nextKey="next",d.currentKey="current",d.setInitialImage=function(a){d.dimensions=a,P(a)},d.setImageOnResize=function(a){d.dimensions=a;var b=M(d.currentImageName);K(b).then(function(){L(b,d.currentKey)})},f.onresize=function(){G(),d.$apply()},d.$on("$destroy",function(){i.cancel(V)}),d.$watch(function(){return d.currentGroup},function(){d.citiesColumns=C(U[d.currentGroup])});var _=location.search.substring(1);_||(_="food");var ab=Leanplum.getVariables();ab.home_reorder=!1,ab.merchant_reorder=!1,Leanplum.setVariables(ab),Leanplum.advanceTo("Homepage",_)}]),angular.module("dcomApp").controller("ListAddressesCtrl",["$location","$rootScope","$scope","$window","$modal","$route","User","LocationAPI",function(a,b,c,d,e,f,g,h){function i(a){if("undefined"!=typeof a&&null!==a){var b=a.toString().replace(/[^0-9]/g,"");if(null!==b)return b}return null}b.page={title:"Addresses",bodyClasses:"page-list-addresses"},b.header={backAction:function(){d.history.back()}},c.errorMsg={street:!1,city:!1,unit:!1,zip_code:!1,phone:!1},c.savedAddresses={},c.address={},c.addingAddress=!1,c.submitLabel="Save address",c.currId=0,c.processing=!1,c.phoneIncomplete=function(a,b){return null!==a&&angular.isDefined(a)&&a.toString().length<b?!0:!1},c.setAddress=function(a){var b=0;if(!c.addingAddress)for(b=0;b<c.savedAddresses.locations.length;b++)if(c.savedAddresses.locations[b].location_id===a){c.currId=a,c.address=c.savedAddresses.locations[b],c.openForm=!0,c.addingAddress=!1;break}},c.deleteAddress=function(b){e.open({templateUrl:"views/modals/deleteAddress.html",controller:["$scope",function(c){c.deleteAddress=function(){c.$dismiss(),h.remove(b).then(function(){a.search().next?a.url(a.search().next):f.reload()})}}]})},c.toggleAddAddressForm=function(){c.addingAddress=!c.addingAddress,c.addingAddress===!0&&(c.address={},c.currId=0,c.errorMsg={street:!1,city:!1,unit:!1,zip_code:!1,phone:!1})},c.$watch("addingAddress",function(a){a===!0?(c.submitLabel="Add address",c.addingAddress=!0):(c.submitLabel="Save address",c.addingAddress=!1)}),c.submitAction=function(){c.addingAddress===!0?c.addAddress():c.editAddress()},c.handleErrors=function(a){c.errorMsg={street:!1,city:!1,unit:!1,zip_code:!1,phone:!1};var b=0;for(b=0;b<a.length;b++)c.errorMsg[""+a[b].field]=a[b].user_msg},c.editAddress=function(){if(c.processing)return!1;c.processing=!0;var b={id:c.address.location_id,street:c.address.street,city:c.address.city,state:c.address.state,zipCode:c.address.zip_code,unit:c.address.unit_number,company:c.address.company,phone:i(c.address.phone)};h.edit(b).then(function(){a.search().next?a.url(a.search().next):f.reload(),c.processing=!1},function(a){c.processing=!1,c.handleErrors(a)})},c.addAddress=function(){if(c.processing)return!1;c.processing=!0;var b={street:c.address.street,city:c.address.city,state:c.address.state,zipCode:c.address.zip_code,unit:c.address.unit_number,company:c.address.company,phone:i(c.address.phone)};h.create(b).then(function(){a.search().next?a.url(a.search().next):f.reload(),c.processing=!1},function(a){c.processing=!1,c.handleErrors(a)})},g.getUserAuthToken()&&h.get().then(function(a){c.savedAddresses=a},function(a){c.results=a})}]),angular.module("dcomApp").controller("LoginCtrl",["User","$location","$modal","$modalStack","$rootScope","$scope","$window","UserAPI","ModalPages",function(a,b,c,d,e,f,g,h,i){g.dataLayer=g.dataLayer||[];var j=b.search().next||b.path();f.resetPassword=function(a){f.resetProcessing=!0,h.resetPassword(a).then(function(){f.resetSuccess=!0,f.resetProcessing=!1,g.dataLayer.push({event:"UserAction",eventCategory:"User",eventAction:"Forgot password"})},function(a){f.resetProcessing=!1,f.reset={messages:a}})},f.resetPasswordToggle=function(){f.resetPasswordShow?(f.resetSuccess=!1,f.login.userName=f.reset.email):f.reset={email:f.login.userName},f.resetPasswordShow=!f.resetPasswordShow},f.goToRegistration=function(){i.openPage("signup")},f.submitLogin=function(){f.loginProcessing=!0,a.authenticateUser(angular.element(document.getElementById("email")).val(),angular.element(document.getElementById("password")).val(),document.getElementById("remember-me-chk").checked)},f.login={rememberMe:!0},f.loginProcessing=!1,f.resetProcessing=!1,f.resetPasswordShow=!1,f.nextPageExists=b.search().next,a.getUserAuthToken()&&(a.updateUserInfo(),angular.isDefined(d.getTop())&&d.dismissAll()),g.dataLayer.push({event:"UserAction",eventCategory:"User",eventAction:"Log in initiated",eventLabel:j}),f.$on("authSuccess",function(){g.dataLayer.push({event:"UserAction",eventCategory:"User",eventAction:"Log in",eventLabel:j}),b.search().next&&b.url(b.search().next),d.dismissAll()}),f.$on("authFailure",function(a,b){f.login.messages=b.messages,f.loginProcessing=!1})}]),angular.module("dcomApp").controller("MainNavCtrl",["User","$location","$rootScope","$scope","$timeout","HammerEvents",function(a,b,c,d,e,f){c.mainNavActive=!1,c.toggleMainNav=function(){c.matchMedia.small||(d.closeOnClickOut(c.mainNavActive,c.toggleMainNav),c.mainNavActive=!c.mainNavActive)},c.hideMainNav=function(){c.mainNavActive=!1},d.loginWithRedirect=function(){var a=b.url();b.path("/account/login"),b.search({next:a})},d.logout=function(){a.logout()},d.applyOverlay=function(a){var b=angular.element('<div class="menu-overlay" id="menu-overlay"></div>'),c=document.getElementById("site-wrapper");document.body.insertBefore(b[0],c),f.onClick(b[0],a)},d.closeOnClickOut=function(a,b){if(a){var c=document.getElementById("menu-overlay");c.parentNode.removeChild(c)}else d.applyOverlay(b);e(function(){d.$apply()},20)}}]),angular.module("dcomApp").controller("AccountSideNavCtrl",["User","$location","$rootScope","$scope",function(a,b,c,d){d.currentPage=b.path().split("/")[2],d.logout=function(){a.logout()}}]),angular.module("dcomApp").controller("LaundryPriceCompareCtrl",["$controller","$rootScope","$scope","$window","$location","LaundryPriceCompare","PriceCompareAPI",function(a,b,c,d,e,f,g){function h(){return["blanket","blouse-top","button","coat","comforter","dress","help","jacket","pants","patch","pillow","scarf","shirt","shorts","skirt","suit","sweater","tag","tie","zipper"]}function i(){for(var a=100,b=5,c=[{value:0,name:"0 lbs"},{value:1,name:"1 lbs"}],d=b;a>=d;d+=b)c.push({value:d,name:d+" lbs"});return c}function j(){var a=f.getWnfQuantityFromItem();return a?a:c.weightOptions[0].value}function k(){var a=c.itemsToDisplay.Laundry[0];f.addItem(a)}function l(){c.itemsToDisplay=f.priceCompareItems(),c.extraCartItems=f.getExtraCartItems()}function m(a){var b="/search";a?e.search("frompc","true"):e.search("frompc",null),e.path(b)}function n(a,c){c.then(function(){a?m(!0):(d.scrollTo(0,0),b.$broadcast("priceCompareChange"))},function(){a&&m(!0)})}function o(a,b){var c={expand:{action:"Expand full list of items",label:"Laundry : price compare : see full list"},collapse:{action:"Collapse full list of items",label:"Laundry : price compare : collapse full list"},apply:{action:"Apply price compare",label:"Laundry : price compare : apply"},clear:{action:"Clear price compare",label:"Laundry : price compare : clear"}};b&&(c.click={action:"Price compare item clicked",label:"Laundry : "+(b.category&&b.category.toLowerCase())+" : "+b.name}),d.dataLayer.push({event:"OrderAction",eventCategory:"Search Results",eventAction:c[a].action,eventLabel:c[a].label})}d.dataLayer=d.dataLayer||[],l();var p=25;c.showAllItems=!1,c.helpText="Fill your virtual bag of laundry or dry cleaning and compare merchant prices",c.weightOptions=i(),c.weightSelected={},c.weightSelected.selected=j(),c.processing=!1,c.stopPropagation=function(a){a.target.hasAttribute("data-close-dropdown")||a.stopPropagation()},c.closeAndSendToSearch=function(){m(!1)},c.getIconName=function(a,b){if(b&&"washnfold"===b.toLowerCase()&&!/entire/gi.test(a)&&!/load/gi.test(a))return"icon-laundry";var c=h();return a&&"pillow case"===a.toLowerCase()&&(a="pillow"),a=a.replace(/\//g,"-").toLowerCase(),-1!==c.indexOf(a)?"icon-laundry-"+a:"tailoring"===b.toLowerCase()?"icon-laundry-thimble":"icon-listing-dry-cleaning"},c.inCurCart=function(a){return f.inCurrentCart(a)},c.washFoldInCart=function(){return c.weightSelected.selected>0},c.getCountText=function(a,b){return f.getCountText(a,b)},c.getCartNbItems=function(){return f.getCartNbItems("current",c.weightSelected.selected)},c.getShowItemsText=function(){return c.showAllItems?"See popular items only":"See full list of items"},c.toggleShowAllItems=function(){c.showAllItems=!c.showAllItems;var a=c.showAllItems?"expand":"collapse";o(a)},c.itemClick=function(a){c.addOne(a),f.inCurrentCart(a.id)||o("click",a)},c.wnfItemClick=function(){return c.weightSelected.selected>0?!1:void(c.weightSelected.selected=p)},c.addOne=function(a){var b=angular.copy(a);f.addItem(b)},c.removeOne=function(a){f.removeLastItem(a.id)},c.applyCart=function(a){var b=c.weightSelected.selected;b>0&&!f.getWnfQuantityFromItem()?k():f.getWnfQuantityFromItem()&&0===b&&f.removeWashFoldFromCurrent();var d,e=f.currentCart(),h=f.formatCartForPost(e,{wnfQuantity:b});d=h.length>0?g.addItems(h,{clearExisting:!0}):g.clearAnonCart(),n(a,d),o("apply")},c.clearCart=function(a){if(c.weightSelected.selected=c.weightOptions[0].value,f.clearCurrentCart(),f.previousCart().length>0){var b=g.clearAnonCart();n(a,b)}o("clear")},c.$on("setPriceCompare",function(){l(),c.weightSelected.selected=j()})}]),angular.module("dcomApp").controller("MerchantsCtrl",["$controller","$location","$route","$rootScope","$scope","$timeout","$window","MerchantSearch","$routeParams","SearchAPI","SearchLocation","Group","Cookies","User",function(a,b,c,d,e,f,g,h,i,j,k,l,m){e.SearchResultsHelper=a("MerchantSearchResultsHelperCtrl",{$scope:e}),e.SearchResultsHelper.initializeSearchVariables(),e.search={},e.currentSearchKeyword="",e.address=b.search().address,e.orderType=m.getCookie("globalOrderType")?m.getCookie("globalOrderType"):"delivery",e.orderTime=m.getCookie("globalOrderTime")?m.getCookie("globalOrderTime"):"ASAP",d.search.query=b.search().address,b.search().keyword?(e.search.keyword=b.search().keyword,e.currentSearchKeyword=e.search.keyword,e.SearchResultsHelper.filteringByKeyword=!0):(e.search.keyword="",e.currentSearchKeyword="",e.SearchResultsHelper.filteringByKeyword=!1),d.page={bodyClasses:"page-merchants",title:l.getGroupFromUrl().SEOname+" near "+e.address+" | delivery.com"},d.header={backUrl:"/"},e.scrollToTop=function(){g.scrollTo(0,0)},e.processResults=function(a){e.SearchResultsHelper.processSearchResults(a)},e.runMerchantSearch=function(a,c,f,i,j,m){if(angular.isDefined(a)){var n=0===a.indexOf("Near ");n&&(a=a.replace("Near ",""))}h.search(a,c,f,i,m).then(function(a){if(e.postSearchProcessing=!1,e.processResults(a),e.geolocated=b.search().geolocation,e.addressModal=b.search().addressmodal,angular.isDefined(a.search_address)){e.address=a.search_address.street+", "+a.search_address.city+", "+a.search_address.state+", "+a.search_address.zip_code,d.header.text=e.address;var c=k.get();angular.isDefined(a.search_address.laundry_location_id)&&(c.location_id=a.search_address.laundry_location_id),c.geolocated=e.geolocated,c.addressmodal=e.addressModal,k.set(c,365)}if(angular.isDefined(i)&&""!==i){var f,h=l.getGroupFromUrl().name;f=angular.isDefined(j)&&1===j?"Search "+h+" from search page":"Search "+h+" from homepage",g.dataLayer.push({event:"OrderAction",eventCategory:"Item Search",eventAction:f,eventLabel:e.currentSearchKeyword.toLowerCase(),eventValue:e.filteredAndSortedResultsCount})}g.dataLayer.push({event:"OrderAction",eventCategory:"Address Validation",eventAction:"Success",eventLabel:e.address})},function(a){if(a.redirect_link){var c=a.redirect_link;g.dataLayer.push({event:"OrderAction",eventCategory:"Address Validation",eventAction:"Redirect",eventLabel:c}),b.search({}),b.path(c).replace()}else a.message&&(e.results_message_length=a.message.length,e.messages=a.message),a.addresses&&(e.results_addresses=a.addresses),g.dataLayer.push({event:"OrderAction",eventCategory:"Address Validation",eventAction:"Failure",eventLabel:e.address})})};var n=b.search().frompc;b.search("frompc",null),e.runMerchantSearch(e.address,e.orderTime,e.orderType,e.search.keyword,0,n),"f"===l.getGroupFromUrl().key&&e.SearchResultsHelper.initDishRecommendations(),e.SearchResultsHelper.addSearchWatchers(),e.$on("resultsChange",function(){c.reload()}),e.$watch(function(){return b.search().address},function(a,b){a!==b&&c.reload()},!0)}]),angular.module("dcomApp").controller("MerchantSearchResultsHelperCtrl",["$location","$rootScope","$scope","$timeout","$window","orderByFilter","Group","User","MerchantSearch","ScheduleProvider","Urls","SearchLocation","currencyFilter","numberFilter","Animation","JqliteHelper","StorageService","ItemSearchKeyword","LaundryPriceCompare","PriceCompareAPI","$routeParams","MerchantAPI","DateService",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w){function x(a){return y(a,c.groups[c.activeGroup])}function y(a,b){if("undefined"!=typeof b&&null!==a.summary.categories)for(var c=0;c<a.summary.categories.length;c++)if(-1!==b.categories.indexOf(a.summary.categories[c].name))return!0;return!1}function z(a){return a.summary.banner_ad.active===!0&&null!==a.summary.banner_ad.url?!0:!1}function A(a){return a.summary.is_promoted===!0?!0:!1}function B(a){if(a.length>0){var b=[],c=[0,5,4,3,2,1];angular.forEach(a,function(a){for(var d=c[a.summary.promoted_priority],e=0;d>e;e++)b.push(a)});var d=Math.floor(Math.random()*b.length);return void 0===b[d]?[]:[b[d]]}return[]}function C(){bb.filtersShowing=!1,bb.searchFieldShowing=!1,bb.SEOmobileSearchFieldShowing=!1}function D(a){var b,c=[];return"Single"===a?b=bb.singleFilters:"Category"===a?b=bb.categoryFilters:"Services"===a&&(b=bb.serviceFilters),angular.forEach(b,function(a,b){a&&c.push(b)}),c}function E(a){return 0===a.ordering.delivery_charge&&0===a.ordering.delivery_percent?!0:!1}function F(a){return-1!==a.toString().indexOf(".")?n(a,2):a}function G(a){return null===a.ordering.specials||a.ordering.specials&&0===a.ordering.specials.length?0:a.ordering.specials.reduce(function(a,b){var c=b.name?b.name.indexOf("%"):-1;if(0>c)return a;var d=b.name.substr(0,c);return Math.max(a,d)},0)}function H(a){var b=[];return a&&a.forEach(function(a){var c=hb[a.name];void 0!==c&&b.push(c)}),b}function I(a){var b=Date.create(a.ordering.last_or_next_order_time),c=b.format("{h}:{mm}{tt}"),d=w.getRelativeDayOfTheWeek(b);return"Next "+bb.getOrderType()+" time: "+d+" at "+c}function J(a){var b=a.ordering.minutes_left_for_ASAP;return a.ordering.is_open&&15>=b&&b>0?a.ordering.minutes_left_for_ASAP+" minutes left to order.":a.ordering.is_open?null:I(a)}function K(a){var b=a.ordering.availability.laundry_window_minutes,c=Date.create(a.ordering.availability.next_pickup_time),d=Date.create(a.ordering.availability.next_pickup_time).addMinutes(b),e=Date.create(a.ordering.availability.next_delivery_time),f=Date.create(a.ordering.availability.next_delivery_time).addMinutes(b);a.ordering.availability.firstPickupWindow=c.format("{Dow} {h}:{mm} - ")+d.format("{h}:{mm}{tt}"),a.ordering.availability.firstDeliveryWindow=e.format("{Dow} {h}:{mm} - ")+f.format("{h}:{mm}{tt}")}function L(){angular.isDefined(c.SEO)?c.filteredAndSortedResults=c.seoMerchants:(c.filteredAndSortedResults=bb.filterAndSortResults(c.openMerchants).concat(bb.filterAndSortResults(c.closedMerchants)),bb.lastPage=Math.ceil(c.filteredAndSortedResults.length/cb)),angular.isDefined(c.filteredAndSortedResults)&&(bb.setCurrentPageResults(),c.filteredAndSortedResultsCount=c.filteredAndSortedResults.length)}function M(a,b,d,f,g){e.dataLayer.push({event:"OrderAction",eventCategory:"Search Results",eventAction:"Merchant clicked - position",eventLabel:a+":"+b+":"+d,eventValue:f}),e.dataLayer.push({event:"OrderAction",eventCategory:"Search Results",eventAction:"Merchant clicked - distance",eventLabel:a+":"+b+":"+d,eventValue:g}),c.currentSearchKeyword&&""!==c.currentSearchKeyword&&e.dataLayer.push({event:"OrderAction",eventCategory:"Search Results",eventAction:"Merchant clicked - keyword searched",eventLabel:c.currentSearchKeyword.toLowerCase(),eventValue:f})}function N(a){var b=!1;return angular.forEach(a,function(a){"loc_multiple_possible"===a.code&&(b=!0,e.dataLayer.push({event:"OrderAction",eventCategory:"Address Validation",eventAction:"Multiple choice",eventLabel:c.address}))}),b}function O(){var a=i.sortBy();"string"!=typeof a&&a.key&&(a=a.key),bb.setSortField(a,c.sortOptions)}function P(a){for(var b=!1,d=0;d<c.groups.length;d++)c.groups[d].key===a.key&&(c.groups[d]=a,b=!0);b||c.groups.push(a)}function Q(){(b.matchMedia.smallPortrait||c.SEO)&&!function(){d(function(){new Blazy},100)}()}function R(a){var b;c.sortOptions=c.sortOptions.concat(bb.dynamicSortFields[a]);for(var d=0;d<c.sortOptions.length;d++)if(c.sortOptions[d].key===a){b=d;break}bb.setSortField(c.sortOptions[b].key,c.sortOptions),c.activeSort=c.sortOptions[b]}function S(b,c){a.search("algo",c),a.search("keyword",b).replace()}function T(){c.search.keyword="",c.currentSearchKeyword="",S(null,null)
}function U(){i.otherFilters({singleFilters:bb.singleFilters,categoryFilters:bb.categoryFilters,ratingFilter:bb.ratingFilter,minimumFilter:bb.minimumFilter})}function V(){var a=i.otherFilters();for(var b in a)bb[b]=a[b]}function W(){var b=bb.getOrderType(),d=bb.getOrderTime(),e=a.search().address;c.real_categories={f:[],b:[],g:[],l:[]},c.SearchResultsHelper.currentPageResults=[],bb.filtersShowing=!1,c.postSearchProcessing=!0,c.itemsInAnonCart=!1,c.priceCompareActive=!1,c.runMerchantSearch(e,d,b,null,0,!0)}function X(a){for(var b=[],c=[],d=0;d<a.length;d++)-1===c.indexOf(a[d].id)&&(b.push(a[d]),c.push(a[d].id));return b}function Y(a){for(var b=0;b<c.anonymousCartUnique.length;b++)if(c.anonymousCartUnique[b].id===a)return void c.anonymousCartUnique.splice(b,1)}function Z(a,d){a&&s.priceCompareItems(a),d&&(c.anonymousCart=d,c.anonymousCartUnique=X(d),s.previousCart(angular.copy(d)),d.length>0&&(c.priceCompareActive=!0,c.itemsInAnonCart=!0,s.syncCarts())),b.$broadcast("setPriceCompare")}function $(a){var b=[];for(var c in a)a[c]&&b.push(c.toLowerCase().replace(" ","_"));return b}function _(a){var b={restaurant:"R",caterer:"C"};return a.map(function(a){return b[a]})}function ab(a,b,d,e){v.getDishRecommendations(a,b,d,e).then(function(a){c.recsToShow=4,c.recSlideStep=4,c.dishRecommendations=a,a.length&&bb.trackDishRec("Displayed"),a.length<4&&(c.recsToShow=a.length)},function(){c.dishRecommendations=[]}).finally(function(){c.recoProcessing=!1})}e.dataLayer=e.dataLayer||[];var bb=this,cb=60;b.matchMedia.smallPortrait&&(cb=80);var db=!1,eb={},fb=[{label:"< $5",value:5},{label:"< $10",value:10},{label:"< $15",value:15},{label:"< $20",value:20}],gb=[{label:"< $10",value:10},{label:"< $25",value:25},{label:"< $50",value:50},{label:"< $75",value:75}],hb={Grocery:{icon:"icon-groceries",tooltip:"Groceries"},"Wine and Liquor":{icon:"icon-listing-wine-liquor",tooltip:"Wine and Liquor"},"Butcher Shop":{icon:"icon-vertical-t",tooltip:"Butcher"},Beer:{icon:"icon-listing-beer",tooltip:"Beer"},Tobacco:{icon:"icon-listing-tobacco",tooltip:"Tobacco"},"Wash & fold":{icon:"icon-listing-laundry",tooltip:"Wash & fold"},"Dry cleaning":{icon:"icon-listing-dry-cleaning",tooltip:"Dry cleaning"},Tailoring:{icon:"icon-listing-tailoring",tooltip:"Tailoring"},Organic:{icon:"icon-listing-organic",tooltip:"Organic"}},ib={noFilterResults:{type:"alert",text:"There are no results for your filter(s) or search criteria"}};c.resultsSectionClass={"no-merchants-wrapper":!c.hasOpenMerchantsInGroup&&c.results_message_length>0,"full-width":0===c.results_merchants_length||c.noCurrentGroupResultsbutResults&&!("l"===bb.currentGroup&&c.itemsInAnonCart)},bb.filteringByKeyword=!1,bb.displayTabIndex=0,bb.filtersShowing=!1,bb.searchFieldShowing=!0,bb.SEOmobileSearchFieldShowing=!1,bb.SEOpopularCuisinesCount=6,bb.showPopularCuisines=!0,bb.showAllNeighborhoods=!0,bb.showAllZips=!0,bb.filterCollapse={},bb.filters=[],bb.singleFilters={},bb.categoryFilters={},bb.filterCuisines={},bb.filterNeighborhoods={},bb.filterZips={},bb.ratingFilter={value:null},bb.minimumFilter={value:null},bb.activeCuisinesText="",bb.activeNeighborhoodsText="",bb.activeZipText="",bb.notices=[],bb.currentGroup=g.currentGroup(),null===bb.currentGroup&&(bb.currentGroup=g.getGroupFromUrl().key);var jb=c.address,kb=Leanplum.getVariables();kb.home_reorder=!1,kb.merchant_reorder=!1,Leanplum.setVariables(kb),Leanplum.advanceTo("Search results",{vertical:bb.currentGroup,address:jb}),bb.defaultSortOptions=[{key:"rating",displayName:"Rating",activeText:"rating",sortField:["-summary.rounded_rating","-summary.num_ratings"]},{key:"distance",displayName:"Distance",activeText:"distance",sortField:"location.distance"},{key:"minimumOrder",displayName:"Minimum",activeText:"minimum",sortField:function(a){return a.ordering.minimum?parseFloat(a.ordering.minimum):0}},{key:"name",displayName:"ABC",activeText:"name",sortField:"summary.name"}],bb.defaultSortOptionsLogged=[{key:"default",displayName:"Default",activeText:"default",sortField:["-summary.re_order_count","-summary.cuisine_weight","-summary.rounded_rating","-summary.num_ratings"]}],bb.dynamicSortFields={best_match:{key:"best_match",displayName:"Best Match",activeText:"best match",sortField:"summary.best_match_order"},price:{key:"price",displayName:"Price",activeText:"price",sortField:"ordering.anonymous_cart_price"}},bb.filterPartials={groups:{templatePath:"/template-cache/merchantSearchResults/filters/groups.html"},neighborhoods:{templatePath:"/template-cache/merchantSearchResults/filters/neighborhoods.html"},zips:{templatePath:"/template-cache/merchantSearchResults/filters/zips.html"},single:{templatePath:"/template-cache/merchantSearchResults/filters/single.html"},cuisines:{templatePath:"/template-cache/merchantSearchResults/filters/cuisines.html"},categories:{templatePath:"/template-cache/merchantSearchResults/filters/categories.html"},rating:{templatePath:"/template-cache/merchantSearchResults/filters/rating.html"},minimums:{templatePath:"/template-cache/merchantSearchResults/filters/minimums.html"}},bb.singleFiltersOrdered=[{name:"New",count:0},{name:"Special offers",count:0},{name:"Order tracker",count:0},{name:"Free delivery",count:0}],bb.ratingFilters=[{label:"only",value:5},{label:"& up",value:4},{label:"& up",value:3},{label:"& up",value:2}],bb.getGroupCounts=function(a){var b={};return angular.forEach(a,function(a){var c=g.getGroupFromAnyKey(a.name,"name");null!==c&&(c.count=a.total_count,c.free_delivery_count=a.free_delivery_fee_count,c.special_offers_count=a.special_offers_count,c.new_count=a.new_count,c.order_tracker_count=a.order_tracker_count,b[c.key]=c.count)}),b},bb.setSingleFilterCounts=function(a){angular.forEach(bb.singleFiltersOrdered,function(b){var c=g.getGroupFromAnyKey(a,"key");switch(b.name){case"New":b.count=c.new_count;break;case"Special offers":b.count=c.special_offers_count;break;case"Free delivery":b.count=c.free_delivery_count;break;case"Order tracker":b.count=c.order_tracker_count}})},bb.initializeSearchVariables=function(){c.updateAddress=function(c){b.search.query=c,a.search({address:c})},c.contactLink=function(){var a=g.getGroupFromAnyKey(bb.currentGroup,"key").name,b="Let me know when you have "+a+" merchants serving "+lb.search_address.zip_code+"!",c="mailto:notifyme@delivery.com?subject="+b;e.open(c)},b.search=b.search||{},c.seoErrorMsg="",c.groups=[],c.real_categories={f:[],b:[],g:[],l:[]},c.unknownGroup=!1,c.showingMoreFilters=1,c.filterPageText="See more",c.singleFiltersOrdered=[],c.sortOptions=[],c.results_merchants_length=0,c.results_message_length=0};var lb={};bb.processFilterSearch=function(a,b){lb=a,lb.message&&(c.results_message_length=lb.message.length,c.messages=lb.message,"no_seo_results"===lb.message.code&&(c.filterTextError=!0,bb.updateNotices(ib.noFilterResults)));var d=b||g.getGroupFromUrl(),e=0;angular.forEach(c.groups,function(a){return a.key.toLowerCase()===d.key.toLowerCase()?void bb.setGroup(e,{filterText:!0}):void e++}),bb.preprocessMerchants(lb.merchants,lb.server_timestamp),db=!0},bb.appendSearchResults=function(a){var b;if(lb=a,bb.preprocessMerchants(lb.merchants,lb.server_timestamp),db=!0,lb.merchants)for(c.gotResponse=!0,bb.postSearchProcessing=!1,c.results_merchants_length=lb.merchants.length,b=0;b<c.results_merchants_length;b++)x(lb.merchants[b])&&(c.hasMerchantsInGroup=!0,c.hasOpenMerchantsInGroup=!0,c.noCurrentGroupResultsbutResults=!1,A(lb.merchants[b])&&c.sponsoredMerchants.push(lb.merchants[b]),z(lb.merchants[b])&&c.merchantsWithBanners.push(lb.merchants[b]),c.seoMerchants.push(lb.merchants[b]));bb.currentPageResults=c.seoMerchants,Q()},bb.processSearchResults=function(a){if(a){Z(a.price_compare_items,a.anonymous_cart);var d;lb=a;var f=[],h=g.getGroupFromUrl();if(null===h&&null!==g.currentGroup()&&(h=g.getGroupFromAnyKey(g.currentGroup(),"key")),lb.message&&(c.results_message_length=lb.message.length,c.messages=lb.message,c.isAmbiguousAddress=N(lb.message)),lb.addresses&&(c.results_addresses=lb.addresses),null!==h&&(h.count=0,P(h),f.push(h.key)),c.SEO)angular.forEach(lb.groups,function(a){var b=g.getGroupFromAnyKey(a.name,"name");null!==b&&(b.count=a.merchant_count,b.show_search&&-1===c.groups.indexOf(b)&&P(b))});else{var j=bb.getGroupCounts(lb.vertical_breakdown_count);angular.forEach(j,function(a,b){var d=g.getGroupFromAnyKey(b,"key");d.count=a,d.show_search&&-1===c.groups.indexOf(d)&&(P(d),lb.search_address&&e.dataLayer.push({event:"OrderAction",eventCategory:"Search Results",eventAction:"Merchant results",eventLabel:lb.search_address.zip+":"+b,eventValue:d.count}))})}c.groups.length>0&&(c.groups=g.sortByOrder(c.groups)),0===c.groups.length&&(h=g.getGroupFromAnyKey("f","key"),h.count=0,P(h)),bb.preprocessMerchants(lb.merchants,lb.server_timestamp);var k=0;for(angular.forEach(c.groups,function(a){return a.key.toLowerCase()===h.key.toLowerCase()?void bb.setGroup(k,{preserveKeyword:!0}):void k++}),c.filterText=i.filterText(),"undefined"!=typeof c.filterText&&c.filterText.length>0&&(c.search.keyword=c.filterText),bb.filterCuisines={},d=0;d<i.cuisineFilters().length;d++)bb.filterCuisines[i.cuisineFilters()[d]]=!0;if(V(),c.SEO){for(bb.filterNeighborhoods={},d=0;d<i.neighborhoodFilters().length;d++)bb.filterNeighborhoods[i.neighborhoodFilters()[d]]=!0;for(bb.filterZips={},d=0;d<i.zipFilters().length;d++)bb.filterZips[i.zipFilters()[d]]=!0}if(c.sortOptions=angular.isArray(h.sort)&&h.sort.length>0?bb.defaultSortOptions.concat(h.sort):bb.defaultSortOptions,b.userData&&(c.sortOptions=c.sortOptions.concat(bb.defaultSortOptionsLogged)),c.SEO?(c.sortOptions=[{key:"rating",displayName:"Rating",activeText:"rating",sortField:["-summary.rounded_rating","-summary.num_ratings"]},{key:"minimumOrder",displayName:"Minimum",activeText:"minimum",sortField:function(a){return a.ordering.minimum?parseFloat(a.ordering.minimum):0}},{key:"name",displayName:"A-Z",activeText:"name",sortField:"summary.name"}],c.SEO.activeSort=c.sortOptions[0]):(""!==c.currentSearchKeyword?R("best_match"):"l"===h.key&&c.itemsInAnonCart?R("price"):(O(),c.activeSort=i.sortBy()),L()),c.SEO?c.cuisines=lb.cuisines:(c.cuisines=[],angular.forEach(lb.cuisines,function(a){a.name_count=a.name+" ("+a.count+")",c.cuisines.push(a)})),bb.popularCuisines=[],c.neighborhoods=lb.neighborhoods,c.SEO){lb.categories=[],h=g.getGroupFromAnyKey(g.currentGroup(),"key");for(var l=h.categories,m=0;m<l.length;m++)if(lb&&lb.categories_seo&&lb.categories_seo.length)for(var n=0;n<lb.categories_seo.length;n++)l[m].toLowerCase()===lb.categories_seo[n].name.toLowerCase()&&lb.categories.push(lb.categories_seo[n])}if(c.categories=lb.categories,c.zip_codes=[],angular.forEach(lb.zip_codes,function(a,b){c.zip_codes.push({zip_code:b,merchant_count:a})}),angular.forEach(lb.popular_cuisines,function(a){a.name_count=a.name+" ("+a.count+")",bb.popularCuisines.push(a)}),c.SEO&&bb.popularCuisines.splice(bb.SEOpopularCuisinesCount),angular.isDefined(lb.categories))for(var o=0;o<lb.categories.length;o++)for(var p=lb.categories[o],q=0;q<c.groups.length;q++)-1!==c.groups[q].categories.indexOf(p.name)&&(c.real_categories[c.groups[q].key].push(p),bb.categoryFilters[p.name]||(bb.categoryFilters[p.name]=!1));angular.forEach(c.real_categories,function(a,b){c.real_categories[b].sort(function(a,b){return a.count-b.count}).reverse()}),!angular.isDefined(c.SEO)&&c.unknownGroup===!1&&!angular.isDefined(lb.addresses)&&!c.hasMerchantsInGroup&&c.results_merchants_length>0&&(c.noCurrentGroupResultsbutResults=!0),c.isAmbiguousAddress=N(lb.message),db=!0}},bb.addSearchWatchers=function(){c.$watch("filterText",function(a){"undefined"!=typeof a&&i.filterText(a)}),c.SEO||c.$watch("SearchResultsHelper.filterCuisines",function(a,b){var d=[];"undefined"!=typeof a&&("f"!==g.currentGroup()&&(c.SearchResultsHelper.filterCuisines={}),angular.forEach(a,function(a,b){a===!0&&d.push(b)}),d.length>0?i.cuisineFilters(d):0===d.length&&Object.keys(b).length>0&&i.cuisineFilters([]),c.SearchResultsHelper.activeCuisinesText=0===d.length?"":1===d.length?d[0]:d.length+" selected",d.length>0&&Leanplum.track("Cuisine filter triggered","Search results",{vertical:bb.currentGroup,"active cuisine filters":d}))},!0)},bb.preprocessMerchants=function(a){var b=0,d=1;angular.forEach(a,function(a){if(a.summary.icons=H(a.summary.categories),a.ordering.freeDelivery=E(a),a.ordering.highestDiscount=G(a),a.summary.rounded_rating=a.summary.num_ratings>5?a.summary.star_ratings:0,a.summary.merchantUrl=k.getMerchantUrl(a),""!==c.currentSearchKeyword&&(a.summary.best_match_order=d,d++),null!==a.ordering.specials&&a.ordering.specials.length>0)for(a.ordering.all_specials="",b=0;b<a.ordering.specials.length;b++)""!==a.ordering.all_specials&&(a.ordering.all_specials+="<br />"),a.ordering.all_specials+=a.ordering.specials[b].name;if(a.is_closed=!1,"LA"!==a.summary.type&&(a.summary.timeConstraints=J(a),a.is_closed=!a.ordering.is_open),"LA"===a.summary.type&&K(a),a.topItems=bb.formatTopDishes(a.summary.recommended_items),a.isNew=bb.isNew(a),a.summary.merchant_logo&&(c.matchMedia.smallPortrait||c.SEO)&&(a.merchant_logo=a.summary.merchant_logo+"&w=94&h=94"),a.merchant_cuisines=a.summary.cuisines?a.summary.cuisines.join(", "):"&nbsp",a.ordering.minimum=n(a.ordering.minimum,0),a.summary.is_order_tracker=a.summary.logistics_enabled&&!a.summary.is_promoted,"delivery"===c.orderType&&(a.ordering.delivery_charge||a.ordering.delivery_percent)){var e;e=c.matchMedia.smallPortrait?" delivery fee":" fee",a.deliveryFee=a.ordering.delivery_charge?"$"+F(a.ordering.delivery_charge)+e:100*a.ordering.delivery_percent+"%"+e}a.location.distance&&(a.location.distance=n(a.location.distance,1))})},bb.filterAndSortResults=function(a){var b,d;return angular.isArray(a)?(b=a.filter(function(a){return c.SEO?bb.hasCuisines(a)&&bb.hasNeighborhoods(a)&&bb.hasZips(a)&&bb.singleFiltering(a)&&bb.categoryFiltering(a)&&bb.ratingFiltering(a)&&bb.minimumFiltering(a)&&bb.textFilter(a):"l"===bb.currentGroup?bb.hasCuisines(a)&&bb.singleFiltering(a)&&bb.categoryFiltering(a)&&bb.ratingFiltering(a)&&bb.minimumFiltering(a)&&bb.localTextFilter(a):bb.hasCuisines(a)&&bb.singleFiltering(a)&&bb.categoryFiltering(a)&&bb.ratingFiltering(a)&&bb.minimumFiltering(a)&&bb.textFilter(a)}),c.sortField||O(),d=f(b,c.sortField)):[]},bb.setPage=function(b){var c=parseInt(b,10);return 1>c?void a.search("page",1).replace():void(c===bb.currentPage||isNaN(c)||(bb.currentPage=c,a.search("page",c).replace()))},bb.getPageUrl=function(b){var c=a.path(),d=angular.copy(a.search());d.page=b;var e=[];return angular.forEach(d,function(a,b){e.push(b+"="+encodeURIComponent(a))}),c+"?"+e.join("&").replace("%2C",",")},bb.resetSearchIfDifferentGroup=function(a,b){angular.isDefined(a)&&a!==b&&(c.filterText="",c.search.keyword="",i.resetFilters())},bb.setGroup=function(b,d){d=d||{};var f;d.event&&(f=!0);var j;if(d.preserveKeyword||c.currentSearchKeyword&&c.currentSearchKeyword.length>0&&T(),angular.isDefined(c.noCurrentGroupResultsbutResults)&&(c.noCurrentGroupResultsbutResults=!1),bb.resetSearchIfDifferentGroup(c.activeGroup,b),c.activeGroup=b,g.currentGroup(c.groups[b].key.toLowerCase()),bb.currentGroup=g.currentGroup(),bb.setSingleFilterCounts(bb.currentGroup),("f"===bb.currentGroup||"l"===bb.currentGroup)&&(h.getUserAuthToken()||h.getGuestAuthToken()||h.createGuestSession()),c.hasMerchantsInGroup=!1,c.hasOpenMerchantsInGroup=!1,c.unknownGroup=!0,c.selectedSponsor=[],c.sponsoredMerchants=[],c.merchantsWithBanners=[],c.seoMerchants=[],c.openMerchants=[],c.closedMerchants=[],lb.merchants)for(c.gotResponse=!0,c.results_merchants_length=lb.merchants.length,j=0;j<c.results_merchants_length;j++)x(lb.merchants[j])&&(c.hasMerchantsInGroup=!0,angular.isDefined(c.SEO)?(c.seoMerchants.push(lb.merchants[j]),c.hasOpenMerchantsInGroup=!0,c.hasMerchantsInGroup=!0,c.noCurrentGroupResultsbutResults=!1):lb.merchants[j].ordering.is_open?(c.hasOpenMerchantsInGroup=!0,!A(lb.merchants[j])||"l"===bb.currentGroup&&c.itemsInAnonCart||c.sponsoredMerchants.push(lb.merchants[j]),z(lb.merchants[j])&&c.merchantsWithBanners.push(lb.merchants[j]),c.openMerchants.push(lb.merchants[j])):c.closedMerchants.push(lb.merchants[j]));c.resultsSetSort=[{results:c.selectedSponsor,name:"sponsored"},{results:c.filteredAndSortedResults,name:"regular"}],angular.isDefined(lb.merchants)&&c.results_merchants_length>0&&(c.unknownGroup=!1),"f"===bb.currentGroup?(bb.minimumFilters=fb,d.filterText||(bb.popularCuisines=lb.popular_cuisines)):bb.minimumFilters=gb,c.SEO||(angular.isArray(c.groups[b].sort)&&c.groups[b].sort.length>0?(c.sortOptions=bb.defaultSortOptions.concat(c.groups[b].sort),"l"===g.currentGroup()&&c.itemsInAnonCart&&R("price")):c.sortOptions=bb.defaultSortOptions),-1===c.sortOptions.indexOf(c.activeSort)&&O();var k=g.getGroupFromAnyKey(g.currentGroup(),"key");bb.filters=k.filters,bb.resetAllFilters(),bb.checkForLastSort();for(var l=!1,m=0;m<c.sortOptions.length;m++)"function"!=typeof c.sortOptions[m].sortField&&-1!==c.sortOptions[m].sortField.indexOf(c.sortField)&&(l=!0);if(l||(i.setDefaultSort(),bb.setSortField(i.sortBy(),c.sortOptions)),L(),c.noCurrentGroupResultsbutResults||0!==c.selectedSponsor.length||0!==c.closedMerchants.length||0!==c.openMerchants.length||angular.isDefined(c.SEO)||(c.noCurrentGroupResultsbutResults=!0),lb.search_address&&e.dataLayer.push({event:"OrderAction",eventCategory:"Search Results",eventAction:"View vertical tab",eventLabel:lb.search_address.zip+":"+k.SEOname,eventValue:k.count}),!c.SEO){var n=c.groups[b],o=n.param;if(angular.isDefined(a.search().address)){var p={};""!==o&&(p[o]=!0);var q=angular.copy(a.search());angular.isDefined(q[o])||(q.alcohol?delete q.alcohol:q.groceries?delete q.groceries:q.laundry&&delete q.laundry,f&&(bb.filteringByKeyword=!1)),p=angular.extend(p,q),a.search(p).replace(),g.currentGroup(n.key),bb.currentGroup=n.key,u.group&&a.path("/search")}}},bb.localTextFilter=function(a){var b,d;return c.filterText?(b=c.filterText.toLowerCase(),a.summary.name.toLowerCase().indexOf(b)>=0?!0:(d=a.summary.cuisines?a.summary.cuisines.join():"",d.toLowerCase().indexOf(b)>=0?!0:!1)):!0},bb.textFilter=function(a){return""!==c.search.keyword&&"l"!==bb.currentGroup?a.is_matching_cuisine||a.is_matching_items||a.is_matching_name?!0:!1:!0};{var mb=30,nb=mb.daysBefore(Date.now()),ob=j.set("search");i.cuisineFilters()}bb.isNew=function(a){return nb.isBefore(a.summary.activation_date)?!0:!1},bb.getOrderType=function(){return ob.getOrderType()},bb.getOrderTime=function(){return ob.getOrderTime("search")},bb.isOrganicLaundromat=function(a){return a.summary.categories.filter(function(a){return"Organic"===a.name}).length>0},bb.hasCuisines=function(a){var b,c=i.cuisineFilters();if(0===c.length)return!0;for(b=0;b<c.length;b++)if(a.summary.cuisines&&a.summary.cuisines.indexOf(c[b])>=0)return!0;return!1},bb.hasNeighborhoods=function(a){var b,c=i.neighborhoodFilters();if(0===c.length)return!0;for(b=0;b<c.length;b++)if(a.location.neighborhood&&a.location.neighborhood===c[b])return!0;return!1},bb.hasZips=function(a){var b,c=i.zipFilters();if(0===c.length)return!0;for(b=0;b<c.length;b++)if(a.location.zip&&a.location.zip===c[b])return!0;return!1},bb.categoryFiltering=function(a){if(0===bb.getActiveFiltersCount(bb.categoryFilters))return!0;for(var b=0;b<a.summary.categories.length;b++)if(bb.categoryFilters[a.summary.categories[b].name])return!0;return!1},bb.ratingFiltering=function(a){switch(bb.ratingFilter.value){case 5:if(5!==Math.floor(a.summary.star_ratings))return!1;break;case 4:if(Math.floor(a.summary.star_ratings)<4)return!1;break;case 3:if(Math.floor(a.summary.star_ratings)<3)return!1;break;case 2:if(Math.floor(a.summary.star_ratings)<2)return!1}return!0},bb.minimumFiltering=function(a){return null!==bb.minimumFilter.value&&a.ordering.minimum>bb.minimumFilter.value?!1:!0},bb.singleFiltering=function(a){var b=!0;return angular.forEach(bb.singleFilters,function(c,d){if(c){if("New"===d){var e=new Date,f=30,g=Date.parse(a.summary.activation_date);if(e.setDate(e.getDate()-f),g-e.getTime()<0)return void(b=!1)}if("Special offers"===d&&(null===a.ordering.specials||a.ordering.specials&&0===a.ordering.specials.length))return void(b=!1);if("Free delivery"===d&&(0!==a.ordering.delivery_charge||0!==a.ordering.delivery_percent))return void(b=!1);if("Order tracker"===d&&!a.summary.logistics_enabled)return void(b=!1)}}),b},bb.setSortField=function(a,b){var d;for(d=0;d<b.length;d++)if(b[d].key===a)return c.activeSort=b[d],c.activeSortText=b[d].activeText,c.sortField=b[d].sortField,i.sortBy(b[d]),void e.dataLayer.push({event:"OrderAction",eventCategory:"Search Results",eventAction:"Sort by changed",eventLabel:c.currentGroup+":"+c.activeSort})},bb.checkForLastSort=function(){var a=q.local.get("dcomApp","lastSort-"+bb.currentGroup);a&&bb.setSortField(a,c.sortOptions)},bb.resetFilter=function(a,b){"Cuisine"===a&&(bb.filterCuisines={}),"Neighborhood"===a&&(bb.filterNeighborhoods={}),"Zip"===a&&(bb.filterZips={}),"Category"===a&&angular.forEach(bb.categoryFilters,function(a,b){bb.categoryFilters[b]=!1}),"Rating"===a&&(bb.ratingFilter.value=null),"Minimum delivery"===a&&(bb.minimumFilter.value=null),"Single"===a&&angular.forEach(bb.singleFiltersOrdered,function(a){bb.singleFilters[a.name]=!1}),"undefined"!=typeof b&&(b.stopPropagation&&b.stopPropagation(),b.preventDefault&&b.preventDefault(),b.cancelBubble=!0,b.returnValue=!1)},bb.resetAllFilters=function(){bb.resetFilter("Category"),bb.resetFilter("Rating"),bb.resetFilter("Minimum delivery"),bb.resetFilter("Single"),bb.resetFilter("Cuisine")},bb.handleRadio=function(a,b){a.value=null!==a.value&&b===a.value?null:b},bb.moveGroupRight=function(){var a=3,b=Math.ceil(c.groups.length/a),d=bb.displayTabIndex+1;return d>b?!1:void(bb.displayTabIndex=d)},bb.moveGroupLeft=function(){var a=bb.displayTabIndex-1;return 0>a?!1:void(bb.displayTabIndex=a)},bb.getTabClassname=function(a,b){var d=[];return c.activeGroup===a&&d.push("active"),b&&b.name&&d.push(b.name.toLowerCase()),0===a&&d.push("tab-index-"+bb.displayTabIndex),1===a&&d.push("tab-index-"+(bb.displayTabIndex-1)),d.join(" ")},bb.toggleFilterCollapse=function(a){bb.filterCollapse[a]=bb.filterCollapse[a]===!0?!1:!0},bb.toggleFilters=function(){bb.filtersShowing?(bb.filtersShowing=!1,bb.searchFieldShowing===!1&&(bb.searchFieldShowing=!0)):(C(),bb.filtersShowing=!0,b.matchMedia.small||e.dataLayer.push({event:"OrderAction",eventCategory:"Search Results",eventAction:"Expand filters",eventLabel:c.currentGroup}))},bb.sortResults=function(){bb.setSortField(c.activeSort.key,c.sortOptions),"best_match"!==c.activeSort.key&&q.local.set("dcomApp","lastSort-"+bb.currentGroup,c.activeSort.key),Leanplum.track("Sort by triggered","search results",{vertical:bb.currentGroup,"sort by":c.activeSort.displayName})},bb.openSortSelect=function(){var a=!1,b=document.getElementById("sortby-combo");if(document.createEvent){var c=document.createEvent("MouseEvents");c.initMouseEvent("mousedown",!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,null),a=b.dispatchEvent(c)}else b.fireEvent&&(a=b.fireEvent("onmousedown"))},bb.renderResultsTopMessage=function(){var a=c.filteredAndSortedResultsCount;if(0===a)return"l"===g.currentGroup()&&c.itemsInAnonCart?"There are <span class='highlight cleaners'>"+a+"</span> cleaners nearby":null;var b;return b="f"===g.currentGroup()?"":"l"===g.currentGroup()?"cleaners":"b"===g.currentGroup()?"liquor":"groceries",1===a?bb.filteringByKeyword?"There is <span class='highlight "+b+"'>"+a+"</span> result matching \"<span class='highlight "+b+"'>"+c.currentSearchKeyword+'</span>"':bb.getAllFiltersCount()>0?"There is <span class='highlight "+b+"'>"+a+"</span> result matching search criteria":"f"===g.currentGroup()?"There is <span class='highlight'>"+a+"</span> restaurant nearby":"l"===g.currentGroup()?"There is <span class='highlight cleaners'>"+a+"</span> cleaner nearby":"b"===g.currentGroup()?"There is <span class='highlight liquor'>"+a+"</span> liquor store nearby":"There is <span class='highlight groceries'>"+a+"</span> grocery store nearby":bb.filteringByKeyword?"There are <span class='highlight "+b+"'>"+a+"</span> results matching \"<span class='highlight "+b+"'>"+c.currentSearchKeyword+'</span>"':bb.getAllFiltersCount()>0?"There are <span class='highlight "+b+"'>"+a+"</span> results matching search criteria":"f"===g.currentGroup()?"There are <span class='highlight'>"+a+"</span> restaurants nearby":"l"===g.currentGroup()?"There are <span class='highlight cleaners'>"+a+"</span> cleaners nearby":"b"===g.currentGroup()?"There are <span class='highlight liquor'>"+a+"</span> liquor stores nearby":"There are <span class='highlight groceries'>"+a+"</span> grocery stores nearby"},bb.toggleSearchInResultsField=function(){b.matchMedia.smallPortrait!==!0&&(bb.searchFieldShowing?bb.searchFieldShowing=!1:(C(),bb.searchFieldShowing=!0))},bb.toggleSEOSearchInResultsField=function(){b.matchMedia.small!==!0&&(bb.SEOmobileSearchFieldShowing?bb.SEOmobileSearchFieldShowing=!1:(C(),bb.SEOmobileSearchFieldShowing=!0))},bb.togglePopularCuisines=function(){if(c.firstRun=!1,bb.showPopularCuisines){if(p.isVisible(document.getElementById("all-cuisine-filters")))return!1;bb.showPopularCuisines=!1,c.showPopularCuisines=!1,o.slide("up","popular-cuisines-wrapper",.28,!1,function(){o.slide("down","all-cuisine-filters",.28,!0)})}else{if(p.isVisible(document.getElementById("popular-cuisines-wrapper")))return!1;bb.showPopularCuisines=!0,c.showPopularCuisines=!0,o.slide("up","all-cuisine-filters",.28,!1,function(){o.slide("down","popular-cuisines-wrapper",.28,!0)})}},bb.toggleNeighborhoods=function(){if(c.firstRun=!1,bb.showAllNeighborhoods){if(p.isVisible(document.getElementById("all-neighboorhood-filters")))return!1;bb.showAllNeighborhoods=!1,c.showPopularNeighborhoods=!1,o.slide("up","popular-neighborhoods-wrapper",.28,!1,function(){o.slide("down","all-neighborhood-filters",.28,!0)})}else{if(p.isVisible(document.getElementById("popular-neighborhoods-wrapper")))return!1;bb.showAllNeighborhoods=!0,c.showPopularNeighborhoods=!0,o.slide("up","all-neighboorhood-filters",.28,!1,function(){o.slide("down","popular-neighborhoods-wrapper",.28,!0)})}},bb.toggleZips=function(){if(c.firstRun=!1,bb.showAllZips){if(p.isVisible(document.getElementById("all-zip-filters")))return!1;bb.showAllZips=!1,c.showPopularZipcodes=!1,o.slide("up","popular-zips-wrapper",.28,!1,function(){o.slide("down","all-zip-filters",.28,!0)})}else{if(p.isVisible(document.getElementById("popular-zips-wrapper")))return!1;bb.showAllZips=!0,c.showPopularZipcodes=!0,o.slide("up","all-zip-filters",.28,!1,function(){o.slide("down","popular-zips-wrapper",.28,!0)})}},bb.getCheckedCuisinesCount=function(){return i.cuisineFilters().length},bb.getCheckedNeighborhoodCount=function(){return i.neighborhoodFilters().length},bb.getCheckedZipCount=function(){return i.zipFilters().length},bb.getGroupPluralName=function(a){if("undefined"!=typeof c.groups[a]){var b=c.groups[a].name.toLowerCase();return"groceries"===b&&(b="grocery"),b+" merchants"}return"merchants"},bb.getActiveFiltersCount=function(a){var b=0;return angular.forEach(a,function(a){a&&b++}),b},bb.getAllFiltersCount=function(){return c.SEO?bb.getActiveFiltersCount(bb.singleFilters)+bb.getActiveFiltersCount(bb.categoryFilters)+(bb.minimumFilter.value?1:0)+(bb.ratingFilter.value?1:0)+bb.getActiveFiltersCount(bb.filterCuisines)+bb.getActiveFiltersCount(bb.filterNeighborhoods)+bb.getActiveFiltersCount(bb.filterZips):bb.getActiveFiltersCount(bb.singleFilters)+bb.getActiveFiltersCount(bb.categoryFilters)+(bb.minimumFilter.value?1:0)+(bb.ratingFilter.value?1:0)+bb.getActiveFiltersCount(bb.filterCuisines)},bb.getSelectionText=function(a){if("Cuisine"===a)return bb.activeCuisinesText;if("Neighborhood"===a)return bb.activeNeighborhoodsText;if("Zip"===a)return bb.activeZipsText;var b=0;return"Category"===a&&(b=bb.getActiveFiltersCount(bb.categoryFilters),b>0)?b>1?b+" selected":D("Category")[0]:"Rating"===a?5===bb.ratingFilter.value?"5 stars only":bb.ratingFilter.value+" stars & up":"Minimum delivery"===a?"< $"+bb.minimumFilter.value:""},bb.formatTopDishes=function(a){var b=[];if(a){for(var c in a)b.push(a[c].name);return b.join(", ")}return""},bb.trackSponsor=function(a){"sponsored"===a&&c.selectedSponsor.length>0&&e.dataLayer.push({event:"sponsoredClicked",merchant_id:c.selectedSponsor[0].id,merchant_name:c.selectedSponsor[0].summary.url.short_tag})},bb.trackSponsorShown=function(){c.selectedSponsor.length>0&&e.dataLayer.push({event:"sponsoredShown",merchant_id:c.selectedSponsor[0].id,merchant_name:c.selectedSponsor[0].summary.url.short_tag})},bb.foodMerchantClick=function(b,d,e){e&&e.preventDefault();var f=bb.currentPage;if(-1===d?bb.trackSponsor("sponsored"):d=(f-1)*cb+d,!b.ordering.is_open){var g=j.set("menu"),h=Date.create(b.ordering.last_or_next_order_time).format(Date.ISO8601_DATETIME);g.setOrderTime(h,b.id)}r.menuSearchKeyword(c.currentSearchKeyword),b.matched_items&&r.setMatchedItems(b.matched_items),M(b.summary.name,b.summary.rounded_rating,b.ordering.is_open,d,b.location.distance),a.url(b.summary.merchantUrl)},bb.laundryClick=function(b,c,d){d&&d.preventDefault();var e=bb.currentPage;-1===c?bb.trackSponsor("sponsored"):c=(e-1)*cb+c,M(b.summary.name,b.rounded_rating,b.ordering.is_open,c,b.location.distance),a.url(b.summary.merchantUrl)},bb.searchFilterChanged=function(a){c.search.processing=!0,eb.search&&d.cancel(eb.search),eb.search=d(function(){c.filterText=a},500),eb.spinner&&d.cancel(eb.spinner),eb.spinner=d(function(){c.search.processing=!1},800)},bb.searchPlaceholderText=function(){return"f"===bb.currentGroup?"What are you hungry for?":"l"===bb.currentGroup?"Search by cleaner name":"What are you looking for?"},bb.updateNotices=function(a){-1===bb.notices.indexOf(a)&&bb.notices.push(a)},bb.setSEOCurrentPageResults=function(){bb.currentPageResults=c.filteredAndSortedResults,Q()},bb.setCurrentPageResults=function(){var a,b;if(angular.isArray(c.filteredAndSortedResults)){if(0===c.filteredAndSortedResults.length)return bb.currentPageResults=[],bb.updateNotices(ib.noFilterResults),void(c.selectedSponsor=[]);if(bb.notices=[],a=(bb.currentPage-1)*cb,b=a+cb,a>c.filteredAndSortedResults.length-1)return void bb.setPage(bb.lastPage);c.filteredAndSortedResults.length<b&&(b=c.filteredAndSortedResults.length),bb.currentPageResults=c.filteredAndSortedResults.slice(a,b),bb.currentPageResultsCount=bb.currentPageResults.length,bb.resetSponsor(),Q()}},bb.resetSponsor=function(){angular.isDefined(c.sponsoredMerchants)&&(c.selectedSponsor=B(bb.filterAndSortResults(c.sponsoredMerchants,!0)),bb.trackSponsorShown())},"undefined"==typeof a.search().page&&bb.setPage(1),bb.updatePage=function(a,b){bb.setPage(a,b),angular.isDefined(c.SEO)?bb.setSEOCurrentPageResults():(bb.setCurrentPageResults(),e.scrollTo(0,0))},bb.itemSearch=function(b,d){var f=bb.getOrderType(),h=bb.getOrderTime(),j=a.search().address;if(b&&b.length>0&&b!==c.currentSearchKeyword&&!d)if(bb.filteringByKeyword=!0,c.search.keyword=b,S(null,null),"l"===bb.currentGroup)c.filterText=b;else{c.filterText="",c.real_categories={f:[],b:[],g:[],l:[]},c.postSearchProcessing=!0,c.SearchResultsHelper.currentPageResults=[],bb.filtersShowing=!1,i.resetFilters(),S(b,r.getDefaultAlgo());var k=1;c.runMerchantSearch(j,h,f,b,k),bb.initDishRecommendations()}else if(d||0===b.length&&bb.filteringByKeyword){"l"!==bb.currentGroup?(c.postSearchProcessing=!0,c.real_categories={f:[],b:[],g:[],l:[]},bb.filtersShowing=!1,r.menuSearchKeyword(""),c.SearchResultsHelper.currentPageResults=[],c.runMerchantSearch(j,h,f)):c.filterText="";var l=g.getGroupFromUrl().name;e.dataLayer.push({event:"OrderAction",eventCategory:"Item Search",eventAction:"Search Cancelled "+l,eventLabel:c.currentSearchKeyword.toLowerCase()}),T(),bb.initDishRecommendations(),bb.filteringByKeyword=!1,i.setDefaultSort()}c.currentSearchKeyword=c.search.keyword,c.currentSearchKeyword&&Leanplum.track("Search Triggered","Search results",{vertical:bb.currentGroup,"searched keywords":c.currentSearchKeyword})},c.priceCompareActive=!1,c.itemsInAnonCart=!1,c.priceCompareOpen=!1,c.priceCompareHelpText="Fill your virtual bag of laundry or dry cleaning and compare merchant prices",bb.trackPriceCompare=function(a){var b=g.getGroupFromUrl().name,c={click:{action:"Price compare module button clicked",label:b+" : price compare "},remove:{action:"Remove items after price compare applied",label:b+" : price compare : applied : remove item"},clear:{action:"Clear all items after price compare applied",label:b+" : price compare : applied : remove item"}};
e.dataLayer.push({event:"OrderAction",eventCategory:"Search Results",eventAction:c[a].action,eventLabel:c[a].label})},bb.priceCompareButtonClick=function(){bb.trackPriceCompare("click"),a.path("/search/price-compare")},bb.clearAnonCart=function(a){a&&a.stopPropagation(),t.clearAnonCart().then(function(){s.clearCurrentCart(),W()}),bb.trackPriceCompare("clear")},bb.getAnonTileText=function(a){return!a.category||"washnfold"!==a.category.toLowerCase()||/entire/gi.test(a.name)||/load/gi.test(a.name)?s.getCountText(a.id,a.name):a.quantity+" lbs Wash & Fold"},bb.removeAllItemsById=function(a){Y(a),s.removeAllItemsById(a);var b,c=s.currentCart();if(c.length>0){var d=s.formatCartForPost(c);b=t.addItems(d,{clearExisting:!0})}else b=t.clearAnonCart();b.then(function(){W()}),bb.trackPriceCompare("remove")},bb.getAnonymousCartLength=function(){return s.getCartNbItems("previous")};var pb;bb.trackDishRec=function(a){var b=e.igb?"BaskPredict":"Top Dishes",d=h.getUserAuthToken()?"Logged In":"Logged Out";e.dataLayer.push({event:"OrderAction",eventCategory:"Dish Reco",eventAction:"Dish Reco "+a+" - "+b+", "+d,eventLabel:c.address+", Filters: "+JSON.stringify(pb)+", Keyword: "+c.currentSearchKeyword,eventValue:c.dishRecommendations.length})},bb.initDishRecommendations=function(){if(b.matchMedia.small&&"f"===bb.currentGroup&&e.dishRec){c.recoProcessing=!0,pb={single:$(bb.singleFilters),cuisine:$(bb.filterCuisines),category:$(bb.categoryFilters),min:bb.minimumFilter.value,rating:bb.ratingFilter.value,verticals:_(g.getGroupFromUrl().verticals)},bb.filteringByKeyword&&(pb.keyword=c.search.keyword.toLowerCase());var a=bb.getOrderType(),d=bb.getOrderTime()||"ASAP";ab(c.address,a,d,pb)}},c.$on("priceCompareChange",function(){W()}),c.$watch(function(){return a.search().page},function(a){angular.isDefined(c.SEO)||bb.updatePage(a)},!0),c.$watch(function(){var a={single:bb.singleFilters,cuisines:i.cuisineFilters(),categories:bb.categoryFilters,rating:bb.ratingFilter,minimum:bb.minimumFilter,text:c.filterText,sort:c.sortField};return c.SEO&&angular.extend(a,{neighborhoods:i.neighborhoodFilters(),zips:i.zipFilters()}),a},function(b,d){if(!angular.equals(b,d)&&(b.text!==d.text&&"l"!==g.currentGroup()||b.filteredAndSortedResultsCount!==d.filteredAndSortedResultsCount||(L(),U(),d.sort===b.sort&&bb.initDishRecommendations()),db)){var e=1;angular.isDefined(a.search().page)&&(e=a.search().page),c.SEO||bb.setPage(e)}},!0),c.$watch(function(){return bb.currentGroup},function(b,d){b===d||angular.isDefined(a.search().page)||c.SEO||bb.setPage(1),bb.checkForLastSort()},!0)}]),angular.module("dcomApp").controller("MerchantDetailsCtrl",["$route","$scope","$controller","$location","$rootScope","$modal","$routeParams","$q","$window","SearchLocation","MerchantAPI","Merchant","CartProvider","User","headerImages","MerchantSearch","Group","$filter","OrderAPI","ScheduleProvider","Urls","CartAPI","UserMessages","$timeout","Reorder","DateService","SessionCache",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A){function B(){switch(b.currentGroup){case"f":return void(b.schemaType="http://schema.org/Restaurant");case"l":return void(b.schemaType="http://schema.org/DryCleaningOrLaundry");default:b.schemaType="http://schema.org/LocalBusiness"}}function C(a,b){var c=a;for(var d in b)c=c.replace(new RegExp("{"+d+"}","g"),b[d]);return c}function D(a,b){return a[b.tab][b.type]||a[b.tab].generic||"delivery.com - Your neighborhood. Delivered."}function E(a,c){var f={tab:b.activeTab,type:(c.summary.type||"").toLowerCase(),name:c.summary.name||"",street:c.location.street||"",city:c.location.city||""},g=D(jb,f),h=D(kb,f),i=C(g,f),j=C(h,f);e.page.title=i,e.page.description=j;var k=d.protocol()+"://"+d.host()+d.path();k.indexOf("tab=")<0&&(k+="?tab="+b.activeTab),e.page.canonicalUrl=k}function F(a){var c=["menu","info","reviews"],e=d.search();b.activeTab=-1!==c.indexOf(e.tab)?e.tab:"menu",-1!==c.indexOf(a)&&(d.url("?tab="+a),b.activeTab=a),b.merchantInfo&&E(b.activeTab,b.merchantInfo)}function G(a){return d.path()+"?tab="+a}function H(a){angular.isDefined(a.summary.url)&&g.geo&&g.geo!==a.summary.url.geo_tag&&d.path(u.getMerchantUrl(a))}function I(a,b,c){for(var d=0;d<c.length;d++)if(b<=c[d].value)return c[d].value}function J(a,c){if(c["laundry_"+a+"_time"]&&b[a+"TimeOptions"]){var d=I(a,c["laundry_"+a+"_time"],b[a+"TimeOptions"]);if(d)return b[a+"_time"]=d,"pickup"===a&&b.getLaundryDeliveryTimes(b.pickup_time),!0}}function K(){var a=ab.getInfo();b.cartTotal=a.subtotal,b.cart_points=a.delivery_points,b.cartItemsQty=a.item_count,b.orderTime=ab.getOrderTime(),b.orderType=ab.getOrderType(),b.ordering.timeLeft=a.minutes_left_for_asap_order}function L(a){null!==a.delivery.highest?b.deliveryMinimum=a.delivery.highest:null!==a.delivery.lowest&&(b.deliveryMinimum=a.delivery.lowest),b.pickupMinimum=a.pickup}function M(a){var c,d=a.delivery_charge,e=a.delivery_percent,f=null===d?!1:!0;f&&0!==d?c="$"+d.toFixed(2)+" delivery fee":a.delivery_percent>0?c=100*e+"% delivery fee":f&&0===d&&(c="Free delivery"),b.deliveryFee=c}function N(a){return"Cleaner"===a.summary.type}function O(a){return null!==a.feedback}function P(a){return a.length&&!O(a[0])?a[0]:null}function Q(a){angular.isDefined(e.userData)&&null!==e.userData&&s.getRecentMerchantOrders(a.id,2,N(a)).then(function(a){b.recentOrders=a,b.orderToRate=P(a);for(var c=a.length,d=0;c>d;d++)b.recentOrders[d].remainingTooltipItems=R(a[d])})}function R(a){for(var b=[],c=a.itemNames.length,d=0;c>d;d++)b.push(a.itemNames[d]);return b.splice(b.indexOf(a.maxPricedItem.name),1),b=b.join("\n\n- ")}function S(a){var b=a.summary.notes;return angular.isDefined(b)?b.map(function(a){return{type:"notice",text:a}}):[]}function T(a){var c,d,e,f,g=[],h=null;if(N(a))return g;if(cb&&angular.isDefined(bb)&&g.push({type:"alert",text:a.summary.name+" delivers using <strong>"+bb+"</strong>. Please contact "+bb+" at "+a.summary.phone+" if there is an issue with your order."}),!angular.isDefined(fb)||fb.getOrderTime()===!1&&(b.isDelivering!==!1||!b.next_delivery_time))return g;if(!angular.isDefined(gb))return g;if(c=fb.getOrderTime(),d=gb.getOrderTime(a.id),e=Date.create(d),f=z.getRelativeDayOfTheWeek(e),"ASAP"!==c&&c!==!1&&c!==d){var i,j="ASAP"===d;i=j?"Today at ASAP":f+e.format(" {MM}/{dd}/{yyyy} at {12hr}:{mm}{tt}"),g.push({type:"alert",text:"<span> This merchant is not available for the specified time but taking scheduled orders. </span>\n<strong>Next Available: "+i+"</strong>"})}else"ASAP"!==c&&c!==!1||b.isDelivering!==!1||!b.next_delivery_time&&!b.next_pickup_time||(h=!1,b.next_delivery_time&&"delivery"===b.orderType?h=b.next_delivery_time:b.next_pickup_time&&"pickup"===b.orderType&&(h=b.next_pickup_time),h&&g.push({type:"alert",text:"<span>  This merchant is closed but taking scheduled orders.</span>\n<strong>Next Available: "+h+"</strong>"}));return g}function U(a){"Cleaner"!==a.summary.type&&(gb=t.set("menu"),fb=t.set("search"))}function V(a){var c={backgroundImage:""};return"f"===b.currentGroup&&"undefined"!=typeof a?(c.backgroundImage='url("'+a+'")',c):null}function W(a){var b=Date.create(a),c=z.getRelativeDayOfTheWeek(b);return c+b.format(" {MM}/{dd}/{yyyy} at {12hr}:{mm}{tt}")}function X(){return l.getInfo(g.urlStub).then(function(a){p.removeOverrideMerchantCache(),_=a.images,b.mainCuisine=o.selectImageHeaderSize(_,i.innerWidth),b.cuisineHeader=V(b.mainCuisine);var c=a.merchant.ordering.availability.next_delivery_time,d=a.merchant.ordering.availability.next_pickup_time;cb=a.merchant.ordering.is_rds,bb=a.merchant.ordering.rds_name,b.isDelivering=a.merchant.ordering.availability.delivery,b.merchantInfo=a.merchant,b.setMerchantOrderingSpecials(),c&&(b.next_delivery_time=W(c)),d&&(b.next_pickup_time=W(d)),H(b.merchantInfo),E(q.currentGroup(),b.merchantInfo);var e,f=a.merchant.summary.menu_template;e=ib[f],angular.isDefined(e)||(e="restaurant"),b.merchantTemplate=e,Q(b.merchantInfo),ab=m.get(a.merchant.id),i.prerenderReady=!0},function(){d.path("/404")})}function Y(a,c){angular.isDefined(a)&&ab.clearCachedCart(),ab.reload().then(function(a){b.cart=ab,K(),hb=S(b.merchantInfo),U(b.merchantInfo),b.orderType=ab.getOrderType(),"l"===q.currentGroup()&&b.merchantHelper.getLaundryPickupTimes(),a.message&&a.message.length>0&&"Xerror_nat"===a.message[0].error_code?f.open({templateUrl:"views/modals/itemsUnavailable.html",windowClass:"invalid-items-modal",resolve:{cart:function(){return ab},data:function(){return a},init:function(){return Z}},controller:["$scope","cart","data","init",function(a,b,c,d){a.itemInfo=c.message,a.dateFormat="{dow} {month} {ord}",a.timeFormat="{12hr}:{mm}{tt}",a.invalidTime=Date.create(c.order_time),a.displayDate=a.invalidTime.format(a.dateFormat)===Date.create().format(a.dateFormat)?"Today":a.invalidTime.format(a.dateFormat),a.displayTime=c.asap?"ASAP":a.invalidTime.format(a.timeFormat),a.hideCancel=!0,a.removeItems=function(){a.processing=!0;for(var c=[],e=0;e<a.itemInfo.length;e++)c.push(a.itemInfo[e].item_key);b.remove(c.join()).then(function(){a.processing=!1,Y(),d(),a.$dismiss()})}}]}):K(),"undefined"!=typeof c&&c()})}function Z(){var a,c;if(b.setActiveTab=F,b.ordering={},b.ordering.timeLeft=null,F(),g.address){var d=JSON.parse(g.address);b.address=d.query,j.set(d,365)}else b.address=j.isSet()?j.get().query:null;!p.getOverrideMerchantCache();a=X(),B(),c=n.initializeSession(),b.safeToReloadCart=!1,h.all([a,c]).then(function(){},function(){b.mainCuisine=o.selectImageHeaderSize(_,i.innerWidth),b.cuisineHeader=V(b.mainCuisine)})}function $(){if(ab){var a=ab.getInfo();J("pickup",a)&&J("delivery",a)}}i.prerenderReady=!1,i.dataLayer=i.dataLayer||[];var _,ab,bb,cb=!1;b.merchantInfoFail=!1,b.cuisineHeader=null,b.showSeoSearch=p.showSeoSearch(),b.currentGroup=q.currentGroup();var db=q.loadFromVerticalUrl(),eb=b.currentGroup;Leanplum.advanceTo("Merchant Page",eb);var fb,gb,hb=[];e.header={backAction:function(){i.history.back()}},b.closeKeyboard=function(){document.getElementById("search-filter").blur()},(null===b.currentGroup||null!==db&&b.currentGroup!==db)&&(b.currentGroup=db),b.pickup_time=null,b.delivery_time=null,b.pickupTimeOptions=[],b.deliveryTimeOptions=[],b.pickupTimeError=!1,b.deliveryTimeError=!1,b.deliveryTimeProcessing=!1;var ib={I:"groceries",M:"restaurant",L:"laundry"},jb={menu:{generic:"{name}, {city} Menu | Order Online | delivery.com","wine and liquor store":"{name}, {city} Delivery Menu | delivery.com",cleaner:"{name} | Laundry Pickup & Delivery Online | delivery.com"},info:{generic:"{name}, {city} Delivery Hours & Phone Number | delivery.com"},reviews:{generic:"Read Reviews From {name}, {city} | delivery.com"}},kb={menu:{generic:"View the menu from {name} on {street} in {city} and order delivery online. Takeout may also available.","wine and liquor store":"Order liquor from {name} in {city} online for local, same day delivery.",cleaner:"View prices from {name} in {city} and schedule your next laundry pickup and delivery online. "},info:{generic:"View delivery and pickup hours from {name} in {city}. "},reviews:{generic:"Read reviews from {name} on {street} in {city}. Order online for free."}};b.setMerchantOrderingSpecials=function(){if(null===b.merchantInfo.ordering.specials||b.merchantInfo.ordering.specials&&0===b.merchantInfo.ordering.specials.length)return void(b.merchantOrderingSpecials="");for(var a="",c=0;c<b.merchantInfo.ordering.specials.length;c++)""!==a&&(a+=", "),a+=b.merchantInfo.ordering.specials[c].name;b.merchantOrderingSpecials=a},b.$watch(function(){return b.safeToReloadCart},function(a,b){a!==b&&a===!0&&Y()}),b.getCheckoutCTAText=function(){if(0===b.cartItemsQty)return"Checkout";if(b.cartTotal>=b.minimum||"l"===q.currentGroup())return"Checkout";var a=b.minimum-b.cartTotal;return angular.isDefined(a)&&!isNaN(a)?"Add "+r("currency")(a)+" to Checkout":"Checkout"},b.deliveryTimeDefaultLabel=function(){return b.deliveryTimeProcessing?"Loading...":b.pickup_time?"Select a delivery time":"Select a pickup time first"},b.merchantHelper=c("MerchantHelperCtrl",{$scope:b}),b.checkout=b.merchantHelper.checkout,b.stickyCheckout=function(){var a=!0;b.cartTotal>=b.minimum&&(a=!1);var c=q.getGroupFromAnyKey(b.currentGroup,"key").name;c+="-"+b.merchantInfo.id,c+=":"+a,i.dataLayer.push({event:"Sticky Checkout Clicked",eventCategory:"Merchant",eventAction:"Sticky Checkout",eventLabel:c,eventValue:b.cartTotal}),b.checkout()},b.stickyArrowClickHandler=function(){var a=q.getGroupFromAnyKey(b.currentGroup,"key").name;a+="-"+b.merchantInfo.id,i.dataLayer.push({event:"Sticky back to top button",eventCategory:"Merchant",eventAction:"Back to top",eventLabel:a})},b.reorder=function(c){var d="default",e="f";if(b.currentGroup&&"l"===b.currentGroup&&(d="laundry",e="l"),!b.processing){b.processing=!0,l.getInfo(g.urlStub).then(function(a){var b=a.merchant.summary.name;i.dataLayer.push({event:"OrderAction",eventCategory:"Merchant",eventAction:"Re-order clicked",eventLabel:e+"-"+b})});var f=Leanplum.getVariables();f.home_reorder=!1,f.merchant_reorder=!0,Leanplum.setVariables(f),Leanplum.track("Reorder","Merchant Page",{vertical:d});var h=!1;y.reorder(c,d,h).finally(function(){Y(!0,function(){a.reload()}),b.processing=!1})}},b.getLaundryDeliveryTimes=b.merchantHelper.getLaundryDeliveryTimes,b.setLaundryDeliveryTimes=b.merchantHelper.setLaundryDeliveryTimes,b.getTabUrl=G,Z(),b.$watch(function(){return i.innerWidth},function(){b.mainCuisine=o.selectImageHeaderSize(_,i.innerWidth),b.cuisineHeader=V(b.mainCuisine)}),b.$on("cartChange",function(){ab&&angular.isDefined(ab.getInfo().total)&&(b.safeToReloadCart=!0,angular.isDefined(fb)&&angular.isDefined(gb)||U(b.merchantInfo),K(),b.notices=T(b.merchantInfo).concat(hb),L(b.merchantInfo.ordering.minimum),b.minimum="pickup"===b.orderType?b.pickupMinimum:b.deliveryMinimum,b.remaining=Math.round(100*(b.minimum-b.cartTotal))/100,M(b.merchantInfo.ordering.fees))}),b.$on("locationChange",function(){X().then(function(){b.safeToReloadCart=!0})}),b.$on("$routeUpdate",function(){F()}),b.showStickyCart=!1,b.showStickyArrow=!1,e.matchMedia.small&&(b.$on("cartWrapperOutsideViewport",function(){b.showStickyCart=!0,b.showStickyArrow=!0,b.$$phase||b.$apply()}),b.$on("cartWrapperInsideViewport",function(){b.showStickyCart=!1,b.showStickyArrow=!1,b.$$phase||b.$apply()})),b.$watch("[pickupTimeOptions, deliveryTimeOptions]",$,!0),b.$on("$destroy",function(){A.clear("merchant")})}]),angular.module("dcomApp").controller("MerchantGroceriesCtrl",["$rootScope","$controller","$scope","MerchantAPI","$routeParams","UserMessages",function(a,b,c,d,e){function f(a){for(var b=c.navigation.path,d=(c.navigation.current,0);d<b.length;d++)if(a===b[d])return b.splice(d+1,b.length-(d+1)),void(c.navigation.current=b[d]);c.navigation.current=a,b.push(a)}function g(a){"menu"===a.type&&f(a)}function h(){c.$broadcast("hideSearch")}function i(){d.getMenu(e.urlStub).then(function(a){c.schedule=a.schedule,c.warnings=a.warnings,c.menu=a.menu,f({name:"Categories",type:"menu",children:a.menu})})}c.navigation={current:null,path:[]},a.page=a.page||{},a.page.bodyClasses="page-merchant groceries active-tab-"+c.activeTab,i(),c.categoryClick=g,c.hideSearch=h}]),angular.module("dcomApp").controller("MerchantHelperCtrl",["$rootScope","$window","$scope","$timeout","$modal","$modalStack","MerchantAPI","$routeParams","$location","User","SearchLocation","$filter","Group","Urls","CartAPI","CartProvider","ModalPages","Cookies","MerchantSearch",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s){function t(a){D="ASAP"!==a&&"l"!==m.currentGroup()&&c.merchantInfo&&!r.getCookie("futureConfirmShown-"+c.merchantInfo.id)?!0:!1}function u(){angular.isDefined(c.cart)||(c.cart=p.get(c.merchantInfo.id));var a=Date.create(c.cart.getOrderTime()).format("{Dow} {MM}/{dd}/{yyyy}");a===Date.create().format("{Dow} {MM}/{dd}/{yyyy}")&&(a="Today");var b=Date.create(c.cart.getOrderTime()).format("{12hr}:{mm}{tt}");return a+" at "+b}function v(a,f){b.dataLayer=b.dataLayer||[],b.dataLayer.push({event:"OrderAction",eventCategory:"Scheduled Order Warning",eventAction:"Displayed",eventLabel:c.merchantInfo.summary.name}),e.open({templateUrl:"views/modals/futureConfirm.html",windowClass:"future-confirm-modal",resolve:{merchantId:function(){return c.merchantInfo.id},formattedOrderTime:function(){return u()}},controller:["$scope","merchantId","formattedOrderTime",function(b,c,e){b.merchantId=c,b.formattedOrderTime=e,b.action=function(c){"next"===c&&(r.setCookie("futureConfirmShown-"+b.merchantId,"true",{expires:1}),D=!1,b.$dismiss("close"),d(function(){a(f)}))}}]})}function w(a){angular.isDefined(c.cart)||(c.cart=p.get(c.merchantInfo.id));var b=c.cart;e.open({templateUrl:"views/modals/itemOptions.html",windowClass:"item-option-modal",resolve:{item:function(){return a},cart:function(){return b},processing:function(){return c.processingAddToCart}},controller:["$scope","item","cart","processing",function(a,b,c,d){a.item=b,a.actionText="Add to cart",a.actionTextMobile="Add",a.processing=d,a.footerNotes=null,"l"===m.currentGroup()&&(a.footerNotes="Some styles & materials subject to an extra charge"),a.action=function(b){c.add(b).then(function(){"l"===m.currentGroup()&&s.overrideCacheForNextSearch()},function(){j.getUserAuthToken()||j.getGuestAuthToken||j.createGuestSession()}).finally(function(){a.$dismiss("added to cart"),a.processing=!1})}}]})}function x(a,b){if(!b){angular.isDefined(c.cart)||(c.cart=p.get(c.merchantInfo.id));var d=c.cart;angular.isDefined(d)||(d=p.get(c.merchantInfo.id)),angular.isDefined(c.orderType)||(c.orderType=d.getOrderType()),"pickup"===c.orderType||"delivery"===c.orderType&&c.merchantInfo.deliverable?D?v(w,a):w(a):e.open({templateUrl:"views/modals/merchantAddressError.html",controller:"MerchantAddressModalCtrl as modalCtrl",resolve:{merchantInfo:function(){return c.merchantInfo},ambiguousAddresses:function(){return null}},windowClass:"address-modal"})}}function y(){var a=n.getCheckoutUrl(c.merchantInfo),b=("delivery"===c.orderType?c.deliveryMinimum:c.pickupMinimum,Leanplum.getVariables());if(b.home_reorder?Leanplum.track("Checkout from reorder","Homepage"):b.merchant_reorder&&Leanplum.track("Checkout from reorder","Merchant Page"),!j.getUserAuthToken())return i.search({next:a}),void q.openPage("login");if("delivery"===c.orderType&&!c.merchantInfo.deliverable)return void e.open({templateUrl:"views/modals/merchantAddressError.html",controller:"MerchantAddressModalCtrl as modalCtrl",resolve:{merchantInfo:function(){return c.merchantInfo}},windowClass:"address-modal"});if(!(c.cartItemsQty<=0||c.remaining>0&&"l"!==m.currentGroup())){if("l"===m.currentGroup()){if(null===c.pickup_time||""===c.pickup_time)return void(c.pickupTimeError=!0);if(c.pickupTimeError=!1,null===c.delivery_time||""===c.delivery_time)return void(c.deliveryTimeError=!0);c.deliveryTimeError=!1;var d=c.cart;angular.isDefined(d)&&(d.setLaundryPickupOptions(c.pickupTimeOptions),d.setLaundryDeliveryOptions(c.deliveryTimeOptions))}i.path(a)}}function z(){D?v(y):y()}function A(){var a=c.cart,b=a.getLaundryPickupTimes();angular.forEach(b,function(a){c.pickupTimeOptions.push({name:a.string,value:a.timestamp})})}function B(a){var b=c.cart;if(null===a||""===a)return void(c.pickupTimeError=!0);c.pickupTimeError=!1,c.pickup_time=a,b.setLaundryPickupTime(a);var d={merchant:c.merchantInfo.id,orderType:b.getOrderType()};c.deliveryTimeProcessing=!0,o.getCart(d,a).then(function(a){c.deliveryTimeOptions=[],angular.forEach(a.laundry_delivery_times,function(a){c.deliveryTimeOptions.push({name:a.string,value:a.timestamp})}),c.deliveryTimeProcessing=!1})}function C(a){if(null===a||""===a)return void(c.deliveryTimeError=!0);var b=c.cart;c.deliveryTimeError=!1,c.delivery_time=a,b.setLaundryDeliveryTime(a)}var D=!1;this.checkout=z,this.itemClickHandler=x,this.getLaundryPickupTimes=A,this.getLaundryDeliveryTimes=B,this.setLaundryDeliveryTimes=C,c.$on("orderTimeUpdate",function(a,b){b&&t(b)})}]),angular.module("dcomApp").controller("MerchantInfoCtrl",["$controller","$scope","$routeParams","Schedule","Merchant","FeedbackAPI","Group",function(a,b,c,d,e,f,g){function h(a){d.getSchedule(a).then(function(a){b.currentSchedule={delivery:[],business:[]},angular.isDefined(a.current_schedule.delivery)&&angular.forEach(a.current_schedule.delivery,function(a){if(angular.isDefined(a.times_open[0])){var c=Date.create(a.times_open[0].start),d=c.format("{Dow} {MM}/{dd}");b.currentSchedule.delivery.push({list_date:c,day:d,hours:a})}}),angular.isDefined(a.current_schedule.business)&&angular.forEach(a.current_schedule.business,function(a){if(angular.isDefined(a.times_open[0])){var c=Date.create(a.times_open[0].start),d=c.format("{Dow} {MM}/{dd}"),e=c.format("{Dow}").substring(0,2);b.currentSchedule.business.push({list_date:c,day:d,hours:a,day_label:e})}}),b.currentSchedule.availability=a.current_schedule.availability,b.currentSchedule.servicesOffered=a.current_schedule.services_offered})}function i(a){f.getMerchantReviews(a).then(function(a){b.merchantReviews=a.reviews})}e.getInfo(c.urlStub).then(function(a){var b=a.merchant;h(b.id),i(b.id)});var j=g.currentGroup();Leanplum.track("Info tab triggered","Info",{vertical:j})}]),angular.module("dcomApp").controller("MerchantRestaurantCtrl",["$controller","$location","$modal","$rootScope","$route","$routeParams","$scope","$window","MerchantSearch","User","UserMessages","MerchantAPI","Merchant","CartProvider","PopularItemsProvider","SearchLocation","CartAPI",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o){function p(){l.getMerchantInfo(f.urlStub).then(function(a){var b=a.merchant;g.merchantInfo=b,g.pickupMinimum=b.ordering.minimum.pickup,q=n.get(b.id),g.cart=q},function(){g.merchantInfoFail=!0})}h.dataLayer=h.dataLayer||[];var q,r=null;g.showSeoSearch=i.showSeoSearch(),d.page=d.page||{},d.page.bodyClasses="page-merchant restaurant active-tab-"+g.activeTab,g.merchantInfoFail=!1,r=o.getNewInterface(),g.popularItemsList=r,p(),l.getMenu(f.urlStub).then(function(a){g.menu=a.menu,g.schedule=a.schedule,g.warnings=a.warnings})}]),angular.module("dcomApp").controller("MerchantReviewsCtrl",["$controller","$scope","$routeParams","MerchantAPI","FeedbackAPI","$window",function(a,b,c,d,e,f){function g(){e.getMerchantReviews(h.id).then(function(a){b.merchantReviews=a.reviews,f.prerenderReady=!0})}f.prerenderReady=!1;var h;b.$on("reviewAction",g),d.getMerchantInfo(c.urlStub).then(function(a){h=a.merchant,g()});var i=c.vertical;Leanplum.track("Review tab triggered","Reviews",{vertical:i})}]),angular.module("dcomApp").controller("MerchantLaundryCtrl",["$rootScope","$controller","$scope","MerchantAPI","$routeParams","UserMessages",function(a,b,c,d,e){function f(a){for(var b=c.navigation.path,d=(c.navigation.current,0);d<b.length;d++)if(a===b[d])return b.splice(d+1,b.length-(d+1)),void(c.navigation.current=b[d]);c.navigation.current=a,b.push(a)}function g(a){"menu"===a.type&&f(a)}function h(){d.getMenu(e.urlStub).then(function(a){c.schedule=a.schedule,c.warnings=a.warnings,c.menu=a.menu,angular.forEach(c.menu,function(a){"Get My Clothes"===a.name&&(c.getMyClothesItem=a.children[0])}),f({name:"Categories",type:"menu",children:a.menu})})}c.navigation={current:null,path:[]},a.page=a.page||{},a.page.bodyClasses="page-merchant laundry active-tab-"+c.activeTab,h(),c.categoryClick=g}]),function(){angular.module("dcomApp.controller.merchantSignup",[]).controller("MerchantSignupCtrl",["$rootScope","$scope","$window","$anchorScroll","$location","$timeout","$q",function(a,b,c,d,e){var f=this;return b.sections=["overview","services","marketing","storefront","testimonials","join"],a.page={bodyClasses:"page-merchant-signup",title:"delivery.com | For Merchants",description:"delivery.com means more customers and more orders. Join the ultimate destination for online ordering and start growing your business today."},d.yOffset=60,f.goTo=function(a,b){a.preventDefault(),e.hash(b),d()},f}]).directive("navigationScrollSpy",["$window",function(a){return{restrict:"A",link:function(b){function c(b){var c=b.getBoundingClientRect().top,d=b.getBoundingClientRect().bottom,e=2.5;return c<a.innerHeight/e&&d>=0}var d=function(){for(var a,d=b.sections.length-1;d>=0;d--)if(a=document.getElementsByClassName("section "+b.sections[d])[0],c(a))return b.sections[d]};angular.element(a).bind("scroll",function(){b.activeSection=d(),b.$apply()}),b.$on("$destroy",function(){angular.element(a).unbind("scroll")})}}}]).directive("sticky",["$window","$rootScope",function(a,b){return{restrict:"A",scope:{sticky:"@"},link:function(c,d){if(b.matchMedia.smallPortrait){var e="",f=parseFloat(c.sticky),g=angular.element(d);angular.element(a).bind("scroll",function(){"not-fixed"!==e&&this.pageYOffset<f?(g.removeClass("fixed"),e="not-fixed"):"fixed"!==e&&this.pageYOffset>=f&&(g.addClass("fixed"),e="fixed")})}}}}]).directive("rotatingHeaderImages",["$window","$rootScope",function(){return{restrict:"E",scope:{},template:'<div class="header-img in"></div><div class="header-img out"></div>',link:function(a){function b(){f=document.getElementsByClassName("header-img in")[0],g=document.getElementsByClassName("header-img out")[0]}function c(b){return"images/static/merchant-headers/"+a.headerImages[b]}function d(b){a.headerImageIndex>a.headerImages.length-1&&(a.headerImageIndex=0),b.setAttribute("style","background-image: url("+c(a.headerImageIndex)+")"),a.headerImageIndex++}function e(){b(),d(f),a.rotateHeaderImages()}var f,g;a.changeImage=function(){b(),d(g),a.preloadBackgroundImage(g).then(function(){g.className="header-img in",f.className="header-img out"})},e()},controller:["$scope","$q","$timeout",function(a,b,c){var d;a.headerImages=["merchant-header1.jpg","merchant-header2.jpg","merchant-header3.jpg","merchant-header4.jpg"],a.headerImageIndex=0,a.preloadBackgroundImage=function(a){var c=a.style.backgroundImage.slice(4,-1).replace(/"/g,""),d=b.defer(),e=new Image;return e.src=c,e.onload=function(){d.resolve()},e.onerror=function(){d.reject()},d.promise},a.rotateHeaderImages=function(){c.cancel(d),d=c(function(){a.changeImage(),a.rotateHeaderImages()},2e4)},a.$on("$destroy",function(){c.cancel(d)})}]}}]).directive("merchantSlideshow",["$window","$rootScope","$timeout",function(){return{restrict:"E",templateUrl:"/views/partials/merchantSlideshow.html",scope:{},link:function(a){function b(){f=document.getElementsByClassName("slideshow-img in")[0],g=document.getElementsByClassName("slideshow-img out")[0]}function c(){var c=a.slideshowImgKeys[a.slideshowImageIndex];b(),g.setAttribute("style","background-image: url("+a.slideshowImages[c].src+")"),a.preloadImage(a.slideshowImages[c].src).then(function(){g.className="slideshow-img in",f.className="slideshow-img out"}),a.rotateSlideshowImages()}function d(a,b){return 0>a?a=b:a>b&&(a=0),a}function e(){c()}var f,g;a.slideshowImageIndex=0,a.gotoSlide=function(b){a.slideshowImageIndex=d(b,a.slideshowImgKeys.length-1),c()},a.changeSlide=function(b){var c;"next-slide"===b?c=a.slideshowImageIndex+1:"previous-slide"===b&&(c=a.slideshowImageIndex-1),a.gotoSlide(c)},e()},controller:["$scope","$q","$timeout",function(a,b,c){var d,e="images/static/merchant-slideshow/";a.slideshowImages={"email-promotions":{src:e+"email-promotions.png",name:"Email promotions"},"social-media":{src:e+"social-media-marketing.png",name:"Social media marketing"},"marketing-collateral":{src:e+"marketing-collateral.png",name:"Marketing collateral"},"out-of-home-ads":{src:e+"out-of-home-advertisements.png",name:"Out-of-home advertisements"},"digital-ads":{src:e+"digital-advertisements.png",name:"Digital advertisements"}},a.slideshowImgKeys=Object.keys(a.slideshowImages),a.preloadImage=function(a){var c=b.defer(),d=new Image;return d.src=a,d.onload=function(){c.resolve()},d.onerror=function(){c.reject()},c.promise},a.rotateSlideshowImages=function(){c.cancel(d),d=c(function(){a.changeSlide("next-slide"),a.rotateSlideshowImages()},1e4)},a.$on("$destroy",function(){c.cancel(d)})}]}}])}(),angular.module("dcomApp").controller("GroceriesNavigationCtrl",["$scope","$rootScope","$controller",function(a,b,c){function d(b){a.navigation.focus=b,a.hideSearchIcon=!0}function e(b){return a.navigation.focus===b}function f(){return a.navigation.path.length<=1}function g(){var b=a.matchMedia.smallPortrait?4:3;return a.navigation.path.length>b}function h(){a.search.query=""}a.itemSearch=c("ItemSearch",{$scope:a}),a.navigation=a.navigation||{path:[]},a.navigation.focus="pathNavigation",a.minimizedPath=!1,a.focusOn=d,a.isFocused=e,a.isStartPage=f,a.$watch("matchMedia",function(){a.minimizedPath=g()},!0),a.path=a.navigation.path,a.$watchCollection("path",function(){a.minimizedPath=g()}),a.$on("hideSearch",h)}]),angular.module("dcomApp").controller("RestaurantNavigationCtrl",["$scope","$rootScope","$controller",function(a,b,c){function d(){b.matchMedia.mobileLarge!==!0&&(a.searchbar.show=!a.searchbar.show)}function e(){a.menuNavigation.show=!a.menuNavigation.show}function f(a){return a.map(function(a){return{name:a.name,value:a.id}})}a.itemSearch=c("ItemSearch",{$scope:a}),a.searchbar={show:!1},a.menuNavigation={show:!1,menus:[]},a.toggleSearchBar=d,a.toggleMenuNavigation=e,a.$watch("menu",function(b){b=b||[],a.menuNavigation.menus=f(b||[]),a.searchbar.show=!0})}]),angular.module("dcomApp").controller("NewUserPromoCtrl",["$scope","Cookies","NewUserPromo",function(a,b,c){a.imageUrl=window.promoImage||!1,a.promoUrl=window.promoLink||!1,a.dismiss=function(){a.$dismiss("user closed modal")},a.closePromo=function(){a.dismiss(),c.setPromoCookie()}}]),angular.module("dcomApp").controller("OrderDetailsCtrl",["$location","$modal","$rootScope","$routeParams","$scope","$window","User","CartAPI","OrderAPI","ScheduleProvider","LocationAPI","SearchLocation","UserMessages","Group","MerchantAPI","$filter","DcomConfig","Reorder",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r){f.dataLayer=f.dataLayer||[],c.page={bodyClasses:"page-order-details",title:"Order details for "+d.orderId},e.orderId=d.orderId,e.orderIsFavorited=!1,e.collapsedRatings=!1,e.orderName="",c.header={backAction:function(){f.history.back()}},e.hideReviewTitle=!0,e.renderPaymentMethod=function(a){if(a){var b;return a.payments_used.credit_card&&"Cash"!==a.payment_method?(b=a.payment_method+" **** ",a.last_four&&(b+=""+a.last_four)):b=a.payment_method,b}},e.repeat=function(b){a.path("/account/repeat-orders/create/"+b.order_id),f.dataLayer.push({event:"OrderAction",eventCategory:"Order details",eventAction:"Repeat clicked",eventLabel:b.name})},e.reorder=function(){var b,c=e.orderDetails.order;if(c.type||(c.type="delivery"),!e.processing){e.processing=!0;var d=c.name;e.orderIsFavorited&&(d+="-"+e.orderName),f.dataLayer.push({event:"OrderAction",eventCategory:"Order Details",eventAction:"Re-order clicked",eventLabel:d}),b=a.search().laundry?"laundry":"default";var g=!0;r.reorder(c,b,g).then(function(b){a.path("/cities/"+b.url.geo_tag+"/categories/"+b.url.merchant_type+"/"+b.url.short_tag)}).finally(function(){e.processing=!1})}},e.getPercentageFromSubtotal=function(a){return angular.isDefined(e.orderDetails)?Math.round(100*a/e.orderDetails.order.subtotal):void 0},e.formatPromoLabel=function(a){var b;return b=a.percent_off?p("number")(a.percent_off,0)+"%":"$"+p("number")(a.dollars_off,0),"Promotion ("+b+" off)"},e.flattenItemOption=function(a){for(var b=[a],c=0,d=[],e=function(a){b.push(a)};b.length;){var f=b.pop();f.options=f.options||[],f.options.forEach(e),f.options&&d.unshift(f.options.length>0?{name:f.name}:{value:f.name}),c++}return d},e.isDeliveryFeeFree=function(a){return"delivery fee"===a.name.toLowerCase()&&0===a.amount?!0:!1},e.buildItems=function(a){angular.forEach(a,function(a){a.optionList=e.flattenItemOption(a),a.optionList.reverse(),a.optionList.splice(0,1)})},e.is_laundry=!1,angular.isDefined(a.search().laundry)&&(e.is_laundry=!0),i.getRecentOrder(e.orderId,e.is_laundry).then(function(b){if(e.orderDetails={},e.orderDetails.order=b,e.orderDetails.order.deliveryAddress={},e.orderDetails.itemCount=b.cart.length,e.orderToRate=b,e.favoritingIsEnabled=e.orderDetails.order.favorite?!0:!1,n.currentGroup(a.search().laundry?"l":"f"),o.getMerchantInfo(b.merchant_id).then(function(a){e.merchant=a.merchant
}),"pickup"!==e.orderDetails.order.type&&(e.is_laundry||k.get().then(function(a){var b=0;for(b=0;b<a.locations.length;b++)if(a.locations[b].location_id===e.orderDetails.order.location_id){e.orderDetails.order.delivery_address=a.locations[b];break}})),e.buildItems(e.orderDetails.order.cart),b.favorite===!0&&(e.orderIsFavorited=!0,e.orderName=b.favorite_name),e.orderDetails.orderTime=Date.create(b.order_date).format("{MM}/{dd}/{yy} at {h}:{mm}{tt}"),e.orderDetails.scheduledTimeString=b.order_date===b.delivery_date?"ASAP":Date.create(b.delivery_date).format("{MM}/{dd}/{yy} at {h}:{mm}{tt}"),b.cancelled===!0)e.orderDetails.orderStatus="Order has been cancelled",e.messageType="red";else if(e.is_laundry){e.orderDetails.orderStatus="Order "+b.status;var c=["submitted","accepted","in progress","complete","en route for delivery","en route for pickup","dummy"];e.messageType=-1!==c.indexOf(b.status.toLowerCase())?"green":"red"}f.dataLayer.push({event:"OrderAction",eventCategory:"Order Details",eventAction:"View order",eventLabel:e.orderDetails.order.name})})}]),angular.module("dcomApp").controller("OrderHistoryCtrl",["$rootScope","$scope","$location","$window","OrderAPI","Group",function(a,b,c,d,e,f){function g(a){var b="account/orders/"+a.order_id;a.is_laundry_order&&c.search({laundry:"true"}),c.path(b)}function h(){e.getRecentOrders(i).then(function(a){b.orderHistory=a},function(){b.orderHistory={},b.orderHistory.orders=[]})}var i=50;b.iconMap={R:"food",C:"food",W:"alcohol",I:"groceries",LA:"laundry"},a.page={bodyClasses:"page-order-history",title:"Order history "},a.header={backAction:function(){d.history.back()}},b.goToDetails=g,b.getOrderGroup=function(a){if(a.vertical){var b=f.getFromVertical(a.vertical.name);if(null!==b)return b[0].key}return"f"},h()}]),angular.module("dcomApp").controller("OrderFavoritesCtrl",["$rootScope","$scope","$location","$window","OrderAPI","Group",function(a,b,c,d,e,f){function g(a){"account/orders/"+a.order_id;a.is_laundry_order&&c.search({laundry:"true"})}function h(){e.getFavoriteOrders(i).then(function(a){b.orderFavorites=a},function(){b.orderFavorites={},b.orderFavorites.orders=[]})}var i=50;b.iconMap={R:"food",C:"food",W:"alcohol",I:"groceries",LA:"laundry"},a.page={bodyClasses:"page-order-history",title:"Order history "},a.header={backAction:function(){d.history.back()}},b.goToDetails=g,b.getOrderGroup=function(a){if(a.vertical){var b=f.getFromVertical(a.vertical.name);if(null!==b)return b[0].key}return"f"},h()}]),angular.module("dcomApp").controller("OrderReviewCtrl",["$scope","$window","$location","$timeout","OrderAPI","UserMessages",function(a,b,c,d,e,f){function g(b){a.status.view=b}function h(){g(q)}function i(b){a.review.rating=b,a.status.canSubmit=!0}function j(){a.review.rating>0&&(a.status.canSubmit=!0)}function k(){a.$emit("reviewAction")}function l(a){return Date.create(a).format("{M}/{dd}/{yy}")}function m(){var e=null===a.review.content?"Rate Merchant":"Review Merchant";b.dataLayer.push({event:"OrderAction",eventCategory:"Ratings and Reviews",eventAction:e,eventLabel:a.review.merchant+" - "+c.absUrl(),eventValue:a.review.rating}),k(),g(r),a.review.timestamp=l(new Date),d(function(){g(s)},2e3)}function n(){var b=null;if(angular.isDefined(a.orderToRate)&&a.status.canSubmit&&!a.status.processing)return a.status.processing=!0,b=a.orderToRate.order_id,e.rateOrder(b,angular.extend(a.review,{isLaundry:a.orderToRate.is_laundry_order})).then(m,function(a){f.printError(a)}).finally(function(){a.status.processing=!1})}function o(b){if(angular.isDefined(b)){if(null===b.feedback)return void g(p);a.review={merchant:b.name,rating:b.feedback.overall_rating,content:b.feedback.review,timestamp:l(b.feedback.time_updated)},g(s)}}b.dataLayer=b.dataLayer||[];var p="new",q="edit",r="thankyou",s="reviewed";a.review={merchant:null,rating:null,content:null,timestamp:null},a.status={view:null,processing:!1,canSubmit:!1},o(a.orderToRate),a.$watch("orderToRate",o),a.editReview=h,a.setRating=i,a.submitRating=n,a.contentChanged=j}]),angular.module("dcomApp").controller("PasswordResetCtrl",["User","UserAPI","$location","$rootScope","$scope","$window","UserMessages","ModalPages","$timeout",function(a,b,c,d,e){e.reset={},e.submitPasswordReset=function(){if(!e.resetProcessing){if(e.messages=[],e.resetProcessing=!0,"undefined"==typeof e.reset.pword)return e.messages.push({user_msg:"Your password must be at least 5 characters."}),void(e.resetProcessing=!1);if(e.reset.pword!==e.reset.retype)return e.messages.push({user_msg:"Your passwords do not match."}),void(e.resetProcessing=!1);var a=c.search().key?c.search().key:!1,d=e.reset.pword;a&&b.setNewPassword(a,d).then(function(){e.resetProcessing=!1,e.passwordReset=!0},function(a){e.resetProcessing=!1,e.reset={messages:a}})}},e.goToLogin=function(){c.path("account/login")},e.messages=[],e.resetProcessing=!1}]),angular.module("dcomApp").controller("PrivacyCtrl",["$rootScope","$scope","$window",function(a,b,c){a.page={bodyClasses:"page-privacy",title:"Privacy policy for delivery.com",description:"delivery.com privacy policy"},a.header={backAction:function(){c.history.back()}}}]),angular.module("dcomApp").controller("ProfileCtrl",["$location","$rootScope","$scope","$window","$timeout","UserAPI","User","UserMessages",function(a,b,c,d,e,f,g,h){function i(){c.isValid=!0,c.errorMsg={}}function j(a){return i(),a.firstName.length<1&&(c.errorMsg.firstName=!0,c.requiredError=!0),a.lastName.length<1&&(c.errorMsg.lastName=!0,c.requiredError=!0),a.email.length<1&&(c.errorMsg.email=!0,c.requiredError=!0),a.newPassword!==a.confirmPassword&&(c.errorMsg.confirmPassword=!0,c.errorMsg.newPassword=!0,c.passwordError=!0),!Object.keys(c.errorMsg).length}function k(){f.getUserInfo().then(function(a){i(),c.profile={firstName:a.user.first_name,lastName:a.user.last_name,email:a.user.email,confirmPassword:"",newPassword:""}})}b.page={title:"My Account",bodyClasses:"page-my-account"},b.header={backAction:function(){d.history.back()}},c.status={processing:!1,success:!1},c.profile={},c.updateProfile=function(){c.status.processing||c.status.success||(c.isValid=j(c.profile),c.isValid&&(c.status.processing=!0,f.updateProfile(c.profile).then(function(){c.status.success=!0,e(function(){c.status.success=!1},2e3)},function(a){h.printError(a)}).finally(function(){c.status.processing=!1})))},k()}]),angular.module("dcomApp").controller("RegisterCtrl",["User","$location","$rootScope","$scope","$window","UserMessages","ModalPages","$modalStack","TafAPI","Cookies","NewUserPromo","numberFilter",function(a,b,c,d,e,f,g,h,i,j,k,l){e.dataLayer=e.dataLayer||[];var m=b.search().next||b.path();d.closeModal=function(){d.$dismiss("close")},d.submitRegistration=function(){d.registrationProcessing||(d.registrationProcessing=!0,a.createUser(d.register.firstName,d.register.lastName,d.register.email,d.register.password,d.signup.rememberMe).then(function(){e.dataLayer.push({event:"UserAction",eventCategory:"User",eventAction:"Sign up",eventLabel:m}),b.search().next&&b.url(b.search().next),h.dismissAll()},function(a){d.messages=a}).finally(function(){d.registrationProcessing=!1}))},d.goToLogin=function(){g.openPage("login")};var n=function(){var a=j.getCookie("tafshareid");angular.isDefined(a)&&i.getBounty(a).then(function(a){angular.isDefined(a.referrer_info)?(d.shared.firstName=a.referrer_info.first_name,d.shared.bountyType=a.bounty.referrer_reward_type,"C"===d.shared.bountyType?d.shared.bountyAmount="$"+l(a.bounty.referrer_reward_amount,0):"P"===d.shared.bountyType&&(d.shared.bountyAmount=a.bounty.referrer_reward_amount+" Delivery Points"),d.referredMessage=!0):d.referredMessage=!1})};d.signup={rememberMe:!0},d.messages=[],d.register={},d.registrationProcessing=!1,d.shared={},d.referredMessage=n(),window.newUserDiscountReward&&!j.getCookie("new_user_deal")&&(d.shared.reward=window.newUserDiscountReward,j.setCookie("new_user_deal","yes",{expires:365}),delete window.newUserDiscountReward),d.nextPageExists=b.search().next,a.getUserAuthToken()&&(a.updateUserInfo(),angular.isDefined(h.getTop())&&h.dismissAll()),e.dataLayer.push({event:"UserAction",eventCategory:"User",eventAction:"Sign up initiated",eventLabel:m}),d.$on("$destroy",function(){j.getCookie("deal_code")&&j.deleteCookie("deal_code")})}]);var dcom=dcom||{};angular.module("dcomApp").controller("ItemSearch",["$scope","$routeParams","$timeout","MerchantAPI","ItemSearchKeyword",function(a,b,c,d,e){function f(b,c,d){b.children=b.children||[];var e=d.warnings||dcom.menuUtils.itemWarnings(b.id,a.warnings);return"undefined"!=typeof e&&""!==e&&(b.warnings=e),"undefined"==typeof b.schedule&&"undefined"!=typeof d.schedule&&(b.schedule=d.schedule),b.type===c&&m.unshift(b),b.children.length&&angular.forEach(b.children,function(a){f(a,c,b)}),m}function g(a,b,c){function d(a){return a[b[h]].toLowerCase().indexOf(c)>-1}function e(a){return-1===g.indexOf(a.name)}var f=[],g=[];c=c.toLowerCase();for(var h=0;h<b.length;h++){var i,j;i=a.filter(d),j=i.filter(e);for(var k=0;k<j.length;k++)g.push(j[k].name);f=f.concat(j)}return f}function h(a){return a.toLowerCase().replace(/^[a-zA-Z0-9]+\.\s/,"")}function i(a,b){if(!a||0!==a.length){var c=a.filter(function(a){return b.indexOf(h(a.name))>-1||b.indexOf(a.name)>-1}),d=e.getMatchedItems();return c.sort(function(a,b){var c=h(b.name),e=h(a.name);return d[c].score-d[e].score})}l=!0}function j(b,d){return d=d||{},"undefined"==typeof b||b.length<3?void(a.search.results=[]):(a.search.processing=!0,k.search&&c.cancel(k.search),k.search=c(function(){if(d.fromResults){var c=e.getMatchedItemNames();a.search.results=i(a.search.data,c)}else a.search.results=g(a.search.data,["name","description"],b)},10),k.spinner&&c.cancel(k.spinner),void(k.spinner=c(function(){a.search.processing=!1},800)))}var k={search:null,spinner:null},l=!1;a.search={data:[],results:[],query:null,processing:!1};var m=[],n=e.menuSearchKeyword();n.length>0&&e.getMatchedItemNames().length>0&&(a.search.query=n,j(n,{fromResults:!0})),a.$watch("menu",function(b){if(b=b||[],a.search.data=f({children:b},"item",{}),l){var c=e.getMatchedItemNames();a.search.results=i(a.search.data,c),l=!1}}),this.searchItem=j,a.$on("$destroy",function(){e.menuSearchKeyword(""),e.setMatchedItems({})})}]),angular.module("dcomApp").controller("SeoCitySearchCtrl",["$controller","$location","$route","$rootScope","$scope","$timeout","$window","$modal","MerchantSearch","$routeParams","SearchAPI","SearchLocation","Group","Cookies","ScheduleProvider","headerImages","ScrollHandler","SEOUrlBuilder",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r){function s(a){if("undefined"==typeof a)return"";for(var b="",c=a.split("-"),d=0;d<c.length;d++)""!==b&&(b+=" "),b+=c[d].charAt(0).toUpperCase()+c[d].slice(1);return b}function t(a){return a.toLowerCase().replace(/[\-\s]/g,"")}function u(){return null!==F?!0:!1}function v(){return null!==E?!0:!1}function w(){return angular.isDefined(j.cuisine)}function x(){var a=["food","alcohol","groceries","laundry"];return angular.isDefined(j.group)&&a.indexOf(j.group)>=0}function y(){return angular.isDefined(j.neighborhood)}function z(){return angular.isDefined(j.zipcode)}function A(a,b){angular.forEach(a.merchants,function(a){"undefined"!=typeof a.ordering.minimum&&null!==a.ordering.minimum&&a.ordering.minimum.constructor===Array&&(a.ordering.minimum=a.ordering.minimum[1])});var c=a.cuisines;a.cuisines=[];for(var d=0;d<c.length;d++)c[d].name&&a.cuisines.push({url:c[d].cuisine_url,name:c[d].name,count:c[d].merchant_count});var f=[];angular.forEach(a.zip_codes,function(a,b){f.push({zip_code:b,merchant_count:a,name:b})}),a.zip_codes=f,""!==b.neighborhood.text&&angular.forEach(a.neighborhoods,function(a){a.neighborhood_url===b.neighborhood.text&&(b.neighborhood.text=a.name)}),b.city.path="/cities/"+j.city,b.city.text=a.info.city;var g;u()?(b.category.path="/"+e.urlSafeCategoryName(F),b.category.text=F,m.currentGroup()&&(g=m.getGroupFromAnyKey(m.currentGroup(),"key")||m.getGroupFromAnyKey(m.currentGroup(),"name"))):v()?(b.category.path="/"+e.urlSafeCategoryName(E),b.category.text=E,m.currentGroup()&&(g=m.getGroupFromAnyKey(m.currentGroup(),"key")||m.getGroupFromAnyKey(m.currentGroup(),"name"))):w()&&(b.item.path="/"+j.cuisine,b.item.text=j.cuisine,g=m.getGroupFromAnyKey("food","name")),x()&&(g=m.getGroupFromAnyKey(j.group,"name")),g&&(b.group.path="/"+g.name.toLowerCase(),b.group.text=g.name),y()?(b.neighborhood.path="/neighborhoods/"+j.neighborhood,b.neighborhood.text=j.neighborhood):z()&&(b.zip.path="/zipcodes/"+j.zipcode,b.zip.text=j.zipcode)}function B(){e.searchFilterProcessing=!1,N={city_url:j.city},N.sort_by_rating="desc",e.currentPage=angular.isDefined(b.search().page)?parseInt(b.search().page,10):1,N.from_limit=(e.currentPage-1)*e.pageSize,N.to_limit=N.from_limit+e.pageSize-1,N.reset_cache=1,!j.group||F||E||(N.group=j.group),j.cuisine&&(N.group="food"),e.city_url="/cities/"+j.city,y()?(N.neighborhood_url=j.neighborhood,e.neighb_or_zip_url="/neighborhoods/"+j.neighborhood):z()&&(N.zipcode=j.zipcode,e.neighb_or_zip_url="/zipcodes/"+j.zipcode),u()?N.merchant_type_url=F.replace(/\s+/g,"-").toLowerCase():v()&&(N.category=E,"l"===m.currentGroup()&&(N.category=N.category.replace("&","and"))),e.vertical_url="/categories/"+j.group,w()?(N.cuisine_url=j.cuisine,e.SEO.cuisineSelected=!0,e.SEO.cuisineName=j.cuisine.substring(0,1).toUpperCase()+j.cuisine.substring(1),e.vertical_url="/categories/"+j.group+"/"+j.cuisine):x()&&(N.group=j.group,e.SEO.verticalName=j.group,e.vertical_url="/categories/"+j.group.toLowerCase()),j.category&&(e.vertical_url="/categories/"+e.urlSafeCategoryName(j.category));var a=o.set("search");a.setOrderTime("ASAP"),a.setOrderType("delivery")}function C(a){var b={backgroundImage:""};return b.backgroundImage='url("'+a+'")',b}function D(a,c){c=c||{},e.processing=!0,i.searchBySeoTag(a).then(function(f){if(e.filterText="",e.SEO.location=j.zipcode?j.zipcode:s(f.info.neighborhood||f.info.city),a.city_url&&(j.city=a.city_url),E)j.group=a.category;else if(F)j.group=a.merchant_type_url;else if("undefined"==typeof j.group)if(a.group)j.group=a.group;else{var h=m.currentGroup();h&&(j.group=m.getGroupFromAnyKey(h,"key").name)}if(a.cuisine_url&&(j.cuisine=a.cuisine_url),a.neighborhood_url&&(j.neighborhood=a.neighborhood_url),a.zipcode&&(j.zipcode=a.zipcode),A(f,O),c.preserveResults)e.SearchResultsHelper.appendSearchResults(f),e.loadingMoreResults=!1;else{if(e.SearchResultsHelper.currentPageResults=[],c.filterText)e.filterText=a.search,e.filterTextError=!1,e.SearchResultsHelper.processFilterSearch(f);else if(c.modalFilters)e.filterTextError=!1,e.SearchResultsHelper.processFilterSearch(f,m.getGroupFromAnyKey(a.group,"name"));else{e.headerImages=f.images;var i=p.selectImageHeaderSize(e.headerImages,g.innerWidth);e.cityHeader=C(i),e.$broadcast("updateBreadCrumbs",O),e.groups=[],e.SearchResultsHelper.processSearchResults(f)}f.info&&f.info.meta_title&&d.page&&(d.page.title=f.info.meta_title),f.info&&f.info.meta_description&&d.page&&(d.page.description=f.info.meta_description),e.data=f,e.total_results=f.total_count,f.zip_codes&&(e.zip_codes=f.zip_codes),e.SearchResultsHelper.filters=[];var k;c.modalFilters?k=m.getGroupFromAnyKey(a.group,"name"):(k=m.getGroupFromUrl(),null===k&&null!==m.currentGroup()&&(k=m.getGroupFromAnyKey(m.currentGroup(),"key"))),e.justFood=!1,e.SearchResultsHelper.filters.push("groups"),j.cuisine&&(e.justFood=!0),"f"===k.key&&e.SearchResultsHelper.filters.push("cuisines"),e.SearchResultsHelper.filters.push("categories","neighborhoods","zips"),u(),g.prerenderReady=!0,c.filterText?e.SearchResultsHelper.updatePage(1):angular.isDefined(e.SearchResultsHelper.updatePage)&&e.SearchResultsHelper.updatePage(e.currentPage)}e.processing=!1,c.cb&&c.cb(e.data),c.updatePage&&(e.currentPage+=1,b.search("page",e.currentPage).replace()),e.loadingSearchResults=!1,e.searchFilterProcessing=!1,e.loadingMoreResults=!1,e.initial_load=!0},function(){b.search({}),b.path("/404")})}window.bLazy=null,e.isPrerender=!1,-1!==navigator.userAgent.search("prerender")&&(e.isPrerender=!0);var E=null,F=null,G=!0;if(e.firstRun=!0,e.buildUrl=function(a){!a.group&&j.group&&(a.group=j.group),!a.city&&j.city&&(a.city=N.city_url),"undefined"==typeof a.neighborhood&&j.neighborhood&&(a.neighborhood=j.neighborhood),"undefined"==typeof a.zipcode&&j.zipcode&&(a.zipcode=j.zipcode),"undefined"==typeof a.cuisine&&j.cuisine&&(a.cuisine=j.cuisine);var c=r.buildUrl(a);return c===b.path()&&("cuisine"===a.type?a.cuisine=null:"neighborhood"===a.type?a.neighborhood=null:"zipcode"===a.type?a.zipcode=null:"category"===a.type&&(a.group=m.getGroupFromAnyKey(a.default_group,"key").name),c=r.buildUrl(a)),c},e.getMatchingCategory=function(a){if("Caterer"===a)return"Catering";for(var b=m.getGroupFromAnyKey(m.currentGroup(),"key"),c=s(a.replace(" Store","").replace(" Shop","")),d=0;d<b.categories.length;d++)if(b.categories[d].toLowerCase()===c.toLowerCase())return b.categories[d]},g.prerenderReady=!1,x()||w())j.group||(j.group="food"),m.currentGroup(j.group);else{var H=m.getSearchEnabled(),I=s(j.group).toLowerCase();"wash and fold"===I&&(I="wash & fold");for(var J=0;J<H.length;J++){for(var K=H[J],L=0;L<K.categories.length;L++)if(I===s(K.categories[L]).toLowerCase()){m.currentGroup(K.key),E=s(K.categories[L]),j.category=E;break}if(E)break;for(var M=0;M<K.verticals.length;M++)if(I===s(K.verticals[M]).toLowerCase()){m.currentGroup(K.key),F=s(K.verticals[M]),j.category=F;break}if(F)break}}e.SearchResultsHelper=a("MerchantSearchResultsHelperCtrl",{$scope:e}),d.page={bodyClasses:"page-merchants seo-page",title:"Merchants who deliver to "+e.address+" | delivery.com"},d.page.canonicalUrl=r.getCanonical(),d.header.backAction=function(){g.history.back()},e.getSearchPlaceholder=function(){return"Street Address, City, State"},e.SearchResultsHelper.initializeSearchVariables(),e.city_url="",e.cuisine_url="",e.neighb_or_zip_url="",e.aboveSearchText="Enter your address to get started",e.SEO={};var N,O={group:{path:"",text:""},city:{path:"",text:""},item:{path:"",text:""},category:{path:"",text:""},neighborhood:{path:"",text:""},zip:{path:"",text:""}};e.pageSize=50,e.loadingMoreResults=!0,e.showPopularCuisines=!0,e.showPopularNeighborhoods=!0,e.showPopularZipcodes=!0,e.initial_load=!1,e.loadNextPage=function(a){if(a&&a.preventDefault(),!e.areMoreResults())return!1;e.loadingMoreResults=!0;var b=e.currentPage+1;N.from_limit=(parseInt(b,10)-1)*e.pageSize,N.to_limit=N.from_limit+e.pageSize-1,D(N,{preserveResults:!0,updatePage:!0})},e.loadingSearchResults=!1,e.sortResults=function(){e.currentPage=1,b.search("page",e.currentPage).replace(),N.from_limit=(e.currentPage-1)*e.pageSize,N.to_limit=N.from_limit+e.pageSize-1,e.loadingSearchResults=!0,e.SearchResultsHelper.currentPageResults=[],"name"===e.SEO.activeSort.key?(N.sort_alphabetically="asc",delete N.sort_by_rating,delete N.sort_by_min_delivery):"rating"===e.SEO.activeSort.key?(N.sort_by_rating="desc",delete N.sort_alphabetically,delete N.sort_by_min_delivery):"minimumOrder"===e.SEO.activeSort.key&&(N.sort_by_min_delivery="asc",delete N.sort_alphabetically,delete N.sort_by_rating),D(N,{filterText:!0})},e.urlSafeCategoryName=function(a){return a.replace(/\s/g,"-").toLowerCase()},B(),e.viewButtonText=function(a,b){return b?"Order ahead":"r"===a.toLowerCase()?"View Menu":"View Store"};var P={cuisine:{scopeKey:"showPopularCuisines",helperKey:"showPopularCuisines",popularSelector:".popular-cuisines-wrapper",allSelector:"#all-cuisine-filters"},neighborhood:{key:"showPopularNeighborhoods",helperKey:"showAllNeighborhoods",popularSelector:".popular-neighborhoods-wrapper",allSelector:"#all-neighborhood-filters"},zipcode:{key:"showPopularZipcodes",helperKey:"showAllZips",popularSelector:".popular-zips-wrapper",allSelector:"#all-zip-filters"}};e.seoIsActive=function(a,b){var c=j[a];return E&&"group"===a?c=E:F&&"group"===a&&(c=F),c&&t(c)===t(b.name)?(e.firstRun&&P[a]&&(e.SearchResultsHelper[P[a].helperKey]=!1,e[P[a].scopeKey]=!1,document.querySelector(P[a].popularSelector).style.display="none",document.querySelector(P[a].allSelector).style.display="block"),!0):void 0},e.seoSearchFilterChanged=function(a){e.searchFilterProcessing=!0,N.search=a,D(N,{filterText:!0})},D(N),e.SearchResultsHelper.addSearchWatchers(),e.openSortSelect=function(){var a=!1,b=document.getElementById("sortby-combo");if(document.createEvent){var c=document.createEvent("MouseEvents");c.initMouseEvent("mousedown",!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,null),a=b.dispatchEvent(c)}else b.fireEvent&&(a=b.fireEvent("onmousedown"))},e.innerCuisineClick=function(a){a.stopPropagation()},e.showFiltersMobile=function(){h.open({templateUrl:"views/modals/merchantSEOFilters.html",windowClass:"item-option-modal seo",resolve:{SearchResultsHelper:function(){return e.SearchResultsHelper},results:function(){return e.data},crumbs:function(){return O}},controller:["$scope","$location","Group","SearchResultsHelper","results","crumbs",function(a,b,c,d,e,f){function g(a,b){if(f[a]&&b.length>0)for(var c=0;c<b.length;c++)if(f[a].text.toLowerCase()===b[c].name.toLowerCase())return b[c];return b[0]}function h(a,b){if(N[a]&&b.length>0)for(var c=0;c<b.length;c++)if(N[a].toLowerCase()===b[c].name.toLowerCase())return b[c];return b[0]}function i(b){var d=[{name:"Food",merchant_count:0},{name:"Groceries",merchant_count:0},{name:"Alcohol",merchant_count:0},{name:"Laundry",merchant_count:0}],e=["cuisines","categories","neighborhoods","zip_codes"];if(G||b){for(var f=0;f<e.length;f++){a.results.groups||(a.results.groups=d),a.results[e[f]]||(a.results[e[f]]=[]);var i="zip_codes"===e[f]?"zipcodes":e[f];a.results[e[f]].unshift({name:"All "+i,show_all:!0})}G=!1}l?(a.selected.group=g("group",a.results.groups),a.selected.category=g("category",a.results.categories),a.selected.neighborhood=g("neighborhood",a.results.neighborhoods),a.selected.zipcode=g("zip",a.results.zip_codes),"f"===c.currentGroup()&&(a.selected.cuisine=g("item",a.results.cuisines))):(a.selected.group=h("group",a.results.groups),a.selected.category=h("category",a.results.categories),a.selected.neighborhood=h("neighborhood_url",a.results.neighborhoods),a.selected.zipcode=h("zipcode",a.results.zip_codes),"f"===c.currentGroup()&&(a.selected.cuisine=h("cuisine_url",a.results.cuisines))),a.cacheGroup=a.selected.group,a.cacheCuisine=a.selected.cuisine,a.cacheCategory=a.selected.category,a.cacheNeighborhood=a.selected.neighborhood,a.cacheZipcode=a.selected.zipcode}function j(a){for(var b=document.querySelectorAll(".seo-modal-filters"),c=0;c<b.length;c++)angular.element(b[c]).attr("disabled",a);var d=document.querySelector(".filter-done-button");angular.element(d).attr("disabled",a)}function k(){j(!0),N.group||N.category||(N.group="Food"),a.processing=!0,l=!1,D(N,{modalFilters:!0,cb:function(b){a.results=b,i(!0),a.processing=!1,j(!1)}})}a.city=f.city.text,a.SearchResultsHelper=d,a.results=e,a.selected={};var l=!0;i(),a.updateGroup=function(a){N.cuisine_url=void 0,N.category=void 0;var b=c.getGroupFromAnyKey(a.name,"name");N.group=b.name,k()},a.updateCuisine=function(a){N.category=void 0,N.cuisine_url=a.show_all?"":a.name.toLowerCase(),N.group="Food",k()},a.updateNeighborhood=function(a){N.zipcode=void 0,N.neighborhood_url=a.show_all?"":a.name.toLowerCase(),k()},a.updateCategory=function(a){N.cuisine_url=void 0,N.category=a.show_all?"":a.name.toLowerCase(),k()},a.updateZipcode=function(a){N.neighborhood_url=void 0,N.zipcode=a.show_all?"":a.name.toLowerCase(),k()},a.submitModalFilters=function(){if(a.cacheGroup.name===a.selected.group.name&&a.cacheCategory.name===a.selected.category.name&&a.cacheNeighborhood.name===a.selected.neighborhood.name&&a.cacheZipcode.name===a.selected.zipcode.name&&a.cacheCuisine&&a.cacheCuisine.name===a.selected.cuisine.name){var d="";f.city.path&&(d+=f.city.path),d+=c.getGroupFromAnyKey(a.selected.group.name,"name").SEOUrl,"Food"!==a.selected.group.name||a.selected.cuisine.show_all||(d+="/"+a.selected.cuisine.name.toLowerCase()),a.selected.category.show_all||(d=f.city.path+"/categories/"+a.selected.category.name.toLowerCase()),a.selected.neighborhood.show_all?a.selected.zipcode.show_all||(d+="/zipcodes/"+a.selected.zipcode.name.toLowerCase()):d+="/neighborhoods/"+a.selected.neighborhood.name.toLowerCase(),b.url(d+"?page=1")}a.$dismiss("close")}}]})},e.areMoreResults=function(){return e.initial_load?e.results_merchants_length===e.pageSize:void 0},e.getLoadMoreBtnText=function(){var a,b="Load more ";return a=j.group?j.group:"food","food"===a?b+="restaurants":"alcohol"===a?b+="alcohol stores":"groceries"===a?b+="groceries stores":"laundry"===a&&(b+="cleaners"),b},e.getFormattedGroupName=function(){var a=m.getGroupFromUrl(),b={Restaurant:"Restaurants",Catering:"Caterers",Caterer:"Caterers","Wine and Liquor":"Wine and Liquor Stores","Wine and Liquor Store":"Wine and Liquor Stores",Beer:"Beer Stores",Tobacco:"Tobacco Shops","Tobacco Shop":"Tobacco Shops",Grocery:"Grocery Stores","Grocery Store":"Grocery Stores","Butcher Shop":"Butcher Shops","Wash & fold":"Wash & Fold Providers","Dry cleaning":"Dry Cleaners",Tailoring:"Tailors",Cleaner:"Cleaners",Pets:"Pet Stores"};return null===a&&null!==m.currentGroup()&&(a=m.getGroupFromAnyKey(m.currentGroup(),"key")),E?b[E]:F?b[F]:a.SEOname},d.$on("loadMoreResultsInsideViewport",function(){f(function(){(!e.loadingMoreResults||e.initial_load)&&q.getPosition()>70&&e.loadNextPage()})}),e.$watch(function(){return g.innerWidth},function(){var a=p.selectImageHeaderSize(e.headerImages,g.innerWidth);e.cityHeader=C(a)})}]),angular.module("dcomApp").controller("SeoTagListCtrl",["$location","$rootScope","$scope","$timeout","$window","MerchantSearch","$routeParams","SearchAPI","SearchLocation",function(a,b,c,d,e,f,g,h,i){b.header={backAction:function(){e.history.back()}},c.currentUrl=a.path().split("/"),c.topCities=[{slug:"nyc",city_name:"New York, NY"},{slug:"sf",city_name:"San Francisco, CA"},{slug:"la",city_name:"Los Angeles"},{slug:"boston",city_name:"Boston, MA"},{slug:"dc",city_name:"Washington, DC"}],c.vertical="",c.currentTag="",c.url="",c.loadVerticals=f.isVertical(c.currentUrl[1]);var j=i.get();"undefined"!=typeof j.query&&"undefined"!=typeof b.search&&(b.search.query=j.query,c.address=b.search.query);var k,l={};if("cities"===c.currentUrl[1])if(g.cuisine){var m=f.isVertical(g.cuisine);m!==!1?(c.currentTag=g.cuisine,l.merchant_type=m,k="vertical"):(c.currentTag=g.cuisine,l.cuisine_url=g.cuisine.replace("-cuisine",""),k="cuisine")}else k="cities",c.headerText="";else"cuisines"===c.currentUrl[1]?k="cuisines":c.loadVerticals!==!1&&(k="vertical",c.currentTag=c.loadVerticals,l.merchant_type=c.loadVerticals);h.searchByTags(k,l).then(function(b){c.results=b,c.results.cities&&0===c.results.cities.length&&a.path("/404")},function(){a.path("/404")})}]),angular.module("dcomApp").controller("SeoTagListCitiesCtrl",["$rootScope","$controller","$routeParams","$scope","SearchAPI","$window","$location","Group","headerImages","SEOUrlBuilder",function(a,b,c,d,e,f,g,h,i,j){function k(a){var b=a.replace(/-/g," ");return b.charAt(0).toUpperCase()+b.slice(1)}function l(a){var b={backgroundImage:""};return b.backgroundImage='url("'+a+'")',b}function m(b){var c,d={};a.matchMedia.small?c=6:a.matchMedia.smallPortrait?c=4:a.matchMedia.smallPortrait||(c=2);for(var e=Math.floor(b.length/c),f=b.length%c,g=[],h=0;c>h;h++)g.push(f>0?e+1:e),f--;for(var i=0;i<g.length;i++)d[i]=b.splice(0,g[i]);return d}function n(a){var b=[];if(a.length>=v){for(var c=0;c<a.length;c++)if(-1!==w.indexOf(a[c].city))for(var e=0;e<d.results.popular_cities.length;e++)d.results.popular_cities[e].name===a[c].city&&(d.results.popular_cities[e].merchant_count=a[c].merchant_count,b.push(d.results.popular_cities[e]),e=d.results.popular_cities.length);if(b.length>=v)for(var f=0;f<b.length;f++)for(var g=0;g<a.length;g++)a[g].city===b[f].name&&(a.splice(g,1),g=a.length);if(b.sort(function(a,b){return parseInt(b.merchant_count,10)-parseInt(a.merchant_count,10)}),b.length>=v)return b}}function o(a){for(var b=a.length;b--;)-1!==w.indexOf(a[b].city)&&a.splice(b,1);return a}if(d.SEOHelper=b("SEOHelperCtrl",{$scope:d}),"/cities"!==g.path()&&!c.group){var p=g.path().split("/");c.group=p[1];var q=h.getGroupFromAnyKey(p[1],"name");angular.isDefined(q)&&null!==q&&angular.isDefined(q.key)&&h.currentGroup(q.key)}a.page={bodyClasses:"page-seotags seo-page",title:"Cities With delivery.com | Order Food, Liquor, Laundry & More Online"},a.header.backAction=function(){f.history.back()},d.getSearchPlaceholder=function(){return"Street Address, City, State"};var r="",s={},t="",u="/",v=3,w=["Chicago, IL","Los Angeles, CA","New York, NY","Philadelphia, PA","San Francisco, CA","Washington, DC"];d.getUrl=function(a){var b=u+a+t;"f"!==x.key&&(b+=x.SEOUrl),"/cities"===g.path()&&(b=b+"/categories/"+x.name.toLowerCase());var c=j.getShortUrl(b);return c?c:b},d.topHeaderMessage="Search for Local Delivery and Takeout";var x=h.getGroupFromUrl();x||(x=h.getGroupFromAnyKey(c.group,"name")),d.group_name=x.name,null!==x&&"f"!==x.key?(d.topHeaderMessage=x.SEOHeaderTitle,d.text_title=x.SEOTextTitle,d.text_description=x.SEOTextDescription):c.cuisine&&(d.topHeaderMessage=k(c.cuisine)+" for Delivery and Takeout"),d.getHeaderClasss=function(){return c.group?"group-bg-"+x.key:"default-bg-cities"};var y={desktopMedium:{width:"380",height:"200"},desktopSmall:{width:"300",height:"200"},tablet:{width:"364",height:"200"},mobile:{width:"748",height:"200"}};d.chooseCityImage=function(b){function c(a,b){return b.width===y[a].width&&b.height===y[a].height}for(var d=0;d<b.length;d++)if(a.matchMedia.medium){if(c("desktopMedium",b[d]))return b[d].path}else if(a.matchMedia.small){if(c("desktopSmall",b[d]))return b[d].path}else if(a.matchMedia.smallPortrait){if(c("tablet",b[d]))return b[d].path}else if(!a.matchMedia.smallPortrait&&c("mobile",b[d]))return b[d].path},c.vertical?(d.title="All cities",r="group",s={group:c.group},t="/categories/"+c.group):c.cuisine?(d.cuisineSpecific=!0,d.showTopCities=!0,d.imagesTitle="Popular Cities",d.listTitle="All Cities",r="cuisine",s={cuisine_url:c.cuisine},u="/cities/",t="/categories/food/"+c.cuisine):(d.showTopCities=!0,d.imagesTitle="Popular Cities",d.listTitle="All Cities",r="cities",u="/cities/",c.group?(s={group:c.group},d.verticalPage=!0):s={group:"food"}),d.aboveSearchText="Enter your address to get started",e.searchByTags(r,s).then(function(b){if(d.results=b,d.results.cities&&d.results.cities.sort(function(a,b){if(a.city&&b.city){if(a.city.toLowerCase()<b.city.toLowerCase())return-1;if(b.city.toLowerCase()<a.city.toLowerCase())return 1}return 0}),d.cuisineSpecific){d.headerImages=b.info.cuisine_images;var e=i.selectImageHeaderSize(d.headerImages,f.innerWidth);d.cuisineHeader=l(e),d.results.info.description=b.info.des}d.topCities=d.cuisineSpecific||d.verticalPage?n(b.cities):b.popular_cities;var h={group:{path:"",text:""},city:{path:"",text:""},item:{path:"",text:""},category:{path:"",text:""},neighborhood:{path:"",text:""},zip:{path:"",text:""}};return"f"===x.key?angular.isDefined(b.info)&&(d.text_title=b.info.title,d.text_description=b.info.description,c.cuisine?(h.group.path="food",h.group.text="Food",h.item.path="/"+c.cuisine,h.item.text=k(c.cuisine)):(h.group.path="cities",h.group.text="Cities")):(h.group.path=x.name.toLowerCase(),h.group.text=x.name),d.$broadcast("updateBreadCrumbs",h),d.$watch(function(){return a.matchMedia},function(){if(angular.isDefined(b.cities)){var a=o(b.cities.slice(0));d.citiesColumns=m(a)}},!0),d.cuisineSpecific&&d.$watch(function(){return f.innerWidth},function(){var a=i.selectImageHeaderSize(d.headerImages,f.innerWidth);d.cuisineHeader=l(a)}),d.results.cities&&0===d.results.cities.length?void g.path("/404"):(d.results.info&&d.results.info.title&&(d.title=d.results.info.title),d.results.info&&d.results.info.meta_title&&a.page&&(a.page.title=d.results.info.meta_title),void(d.results.info&&d.results.info.meta_description&&a.page&&(a.page.description=d.results.info.meta_description)))},function(){g.path("/404")})}]),angular.module("dcomApp").controller("SeoTagListCuisinesCtrl",["$rootScope","$controller","$routeParams","$scope","SearchAPI","$window","$location","Group",function(a,b,c,d,e,f,g,h){function i(b){var c,d={};
a.matchMedia.small?c=6:a.matchMedia.smallPortrait?c=4:a.matchMedia.smallPortrait||(c=2);for(var e=Math.floor(b.length/c),f=b.length%c,g=[],h=0;c>h;h++)g.push(f>0?e+1:e),f--;for(var i=0;i<g.length;i++)d[i]=b.splice(0,g[i]);return d}function j(a){for(var b=a.length;b--;)-1!==n.indexOf(a[b].name)&&a.splice(b,1);return a}d.SEOHelper=b("SEOHelperCtrl",{$scope:d}),a.page={bodyClasses:"page-seotags seo-page",title:"Pizza, Chinese Food, Sushi & More | Cuisines On delivery.com"},a.header.backAction=function(){f.history.back()},d.getSearchPlaceholder=function(){return"Street Address, City, State"};var k="",l={},m="/",n=["Pizza","Chinese","Mexican","Sushi","Fast Food","Thai"];d.title="",d.getUrl=function(a){return m+a};var o={desktopMedium:{width:"380",height:"200"},desktopSmall:{width:"300",height:"200"},tablet:{width:"364",height:"200"},mobile:{width:"748",height:"200"}};h.currentGroup("f"),d.chooseCuisineImage=function(b){function c(a,b){return b.width===o[a].width&&b.height===o[a].height}for(var d=0;d<b.length;d++)if(a.matchMedia.medium){if(c("desktopMedium",b[d]))return b[d].path}else if(a.matchMedia.small){if(c("desktopSmall",b[d]))return b[d].path}else if(a.matchMedia.smallPortrait){if(c("tablet",b[d]))return b[d].path}else if(!a.matchMedia.smallPortrait&&c("mobile",b[d]))return b[d].path},c.neighborhood?(k="city",l={city_url:c.city,neighborhood_url:c.neighborhood},m="/cities/"+c.city+"/neighborhoods/"+c.neighborhood+"/cuisines/"):c.city?(k="city",l={city_url:c.city},m="/cities/"+c.city+"/cuisines/"):(d.showPopularCuisines=!0,d.imagesTitle="Popular Cuisines",d.listTitle="All Cuisines",k="cuisines",m="/food/"),d.aboveSearchText="Enter your address to get started",e.searchByTags(k,l).then(function(b){if(d.results=b,d.$watch(function(){return a.matchMedia},function(){if(angular.isDefined(b.cuisines)){var a=j(b.cuisines.slice(0));d.cuisineColumns=i(a)}},!0),d.results.cuisines&&0===d.results.cuisines.length)return void g.path("/404");if(d.results.info&&d.results.info.meta_title&&a.page&&(a.page.title=d.results.info.meta_title),d.results.info&&d.results.info.meta_description&&a.page&&(a.page.description=d.results.info.meta_description),"city"===k){var c=b.info.neighborhood||b.info.city;d.title="All cuisines served in "+c}var e={group:{path:"food",text:"Food"},city:{path:"",text:""},item:{path:"",text:""},category:{path:"",text:""},neighborhood:{path:"",text:""},zip:{path:"",text:""}};d.$broadcast("updateBreadCrumbs",e)},function(){g.path("/404")})}]),angular.module("dcomApp").controller("SeoTagListNeighborhoodsCtrl",["$rootScope","$controller","$routeParams","$scope","SearchAPI","$window","$location",function(a,b,c,d,e,f,g){a.page={bodyClasses:"page-seotags",title:"Neighborhoods With delivery.com | Order Food, Liquor, Laundry & More Online"},a.header.backAction=function(){f.history.back()},d.city=c.city,e.searchByTags("city",{city_url:c.city}).then(function(b){return d.results=b,d.results.neighborhoods&&0===d.results.neighborhoods.length?void g.path("/404"):(d.location=b.info.city,void(d.results.info&&d.results.info.title&&(a.page.title=d.results.info.title)))},function(){g.path("/404")})}]),angular.module("dcomApp").controller("ShareCtrl",["$location","$scope","$routeParams","Cookies",function(a,b,c,d){b.sharer=c.id?c.id:!1,b.sharer===!1&&(b.sharer=a.search().code?a.search().code:!1,a.search({})),b.sharer&&(a.search({sharer:b.sharer}),d.setCookie("tafshareid",b.sharer)),a.path("/account/register")}]),angular.module("dcomApp").controller("TermsCtrl",["$rootScope","$scope","$window",function(a,b,c){a.page={bodyClasses:"page-terms",title:"Terms and conditions for delivery.com",description:"delivery.com site Terms and Conditions."},a.header={backAction:function(){c.history.back()}}}]),angular.module("dcomApp").controller("AwardsTermsCtrl",["$rootScope","$scope","$window",function(a,b,c){a.page={bodyClasses:"page-award-terms",title:"Terms and conditions for delivery.com awards",description:"delivery.com site Terms and Conditions for awards and delivery points."},a.header={backAction:function(){c.history.back()}}}]),angular.module("dcomApp").controller("PromoTermsCtrl",["$rootScope","$scope","$window","DateService",function(a,b,c,d){a.page={bodyClasses:"page-promo-terms",title:"Terms and conditions for delivery.com instant game promotion",description:"delivery.com site Terms and Conditions for instant game promotion."},a.header={backAction:function(){c.history.back()}};var e=d.formatCurrentDay(!0);b.formattedDate=e[0]+" "+e[1]+", "+e[2]}]),angular.module("dcomApp").controller("TipCtrl",["$scope","$rootScope","MerchantAPI","CartProvider","CheckoutProvider",function(a,b,c,d,e){function f(){if(angular.isDefined(l)){if("pickup"===l.getOrderType())return a.tip="0.00",a.tipCash=!1,void m.setTip(a.tip,a.tipCash);var b=m.getCheckoutInfo();if(angular.isDefined(b.tip)&&null!==b.tip&&0!==b.tip)a.tip=b.tip.toString(),a.tipCash=b.tipCash;else{var c=15*l.getInfo().subtotal/100;1>c?(a.tip="1.00",a.tipCash=!1):(a.tip=c.toFixed(2),a.tipCash=!1),m.setTip(a.tip,a.tipCash)}}}function g(b,c){var d=l.getInfo().subtotal*(b/100);a.tip=d.toFixed(2).toString(),a.activeTab=b,a.tipCash=!!c,m.setTip(a.tip,c)}function h(){a.tip=i(a.tip),m.setTip(a.tip,a.tipCash)}function i(b){if(""===b)b="0.00";else{var c=parseFloat(a.tip).toFixed(2),d=angular.isDefined(l.getInfo().subtotal)?l.getInfo().subtotal.toFixed(2):null;b=c>a.cartInfo.subtotal?d:c}return b}function j(){a.tipPercent=m.getCheckoutInfo().tipPercent,a.activeTab=parseInt(a.tipPercent)}function k(){c.getMerchantId().then(function(a){l=d.get(a),m=e.get(a),f()})}var l,m;a.setTipPercent=g,a.formatCurrentTip=h,k(),a.$watch("tipCash",function(a){b.$broadcast("tipCash",a)}),a.$watch("tip",function(b,c){"undefined"!=typeof b&&(a.tip=""!==b&&(!b.match("^[0-9]+[.]*[0-9]*$")||b.match("^[0-9]+[.]+[0-9]+$")&&b.split(".")[1].length>2)?c:b.toString(),m.setTip(i(a.tip),a.tipCash))}),a.$on("cartChange",function(){"undefined"!=typeof l&&(f(),j())}),a.$on("CheckoutChange",function(){j()})}]),angular.module("dcomApp").controller("PromoSignUpCtrl",["$rootScope","$scope","UserMessages","UserAPI","Cookies","MarketingAPI","$location","UserAuthToken",function(a,b,c,d,e,f,g,h){function i(){return f.getDealsAndUhau().then(function(a){var c;b.methods=[""],b.dealsData=a,b.methods=b.dealsData.uhau,c={name:"Add a new method",dealId:"create_new",uhau_id:"none"},b.methods.push(c),b.promoOptions=b.dealsData.deals},function(a){c.printAPIMessage(a).finally(function(){g.path("/")})})}function j(){b.registrationProcessing=!0;var a=Math.random().toString(36).slice(-8),e={first_name:b.register.firstName,last_name:b.register.lastName,email:b.register.email,password:a,uhauid:b.method.uhau_id};d.createUser(e).then(function(){var a={title:"Welcome",message:"Congratulations, you successfully signed up for delivery.com!"};c.printMessage(a)},function(a){c.printAPIMessage(a)}).finally(function(){k(),b.registrationProcessing=!1})}function k(){b.signup_form.$setPristine(),b.register.firstName="",b.register.lastName="",b.register.email="",document.signup_form.firstname.value="",document.signup_form.lastname.value="",document.signup_form.email.value="",document.signup_form.newMethodName.value="",b.dealId="",b.method=b.methodAdded}return a.page={bodyClasses:"page-promoSignUp",title:"Sign up for delivery.com"},b.processRegistration=function(){if(!b.registrationProcessing){if(b.signup_form.$invalid)return void(b.showValidationMessages=!0);void 0===b.register.newMethodName&&(b.register.newMethodName=""),""===b.register.newMethodName.trim()||void 0===b.register.newDeal||"create_new"!==b.method.dealId?(b.idDeal=b.method.dealId,b.methodAdded=b.method,j()):"create_new"===b.method.dealId&&(b.name=b.register.newMethodName,b.idDeal=b.register.newDeal.deal_id,f.postNewUhau(b.name,b.idDeal).then(function(){i().then(function(){angular.forEach(b.methods,function(a){a.name===b.name&&(b.method=a,b.methodAdded=a)}),j()})},function(a){c.printAPIMessage(a).then(function(){b.register.newMethodName=""})}))}},h.isSet()?void i():void g.path("/")}]),angular.module("dcomApp").constant("DeliveryPointsHeaderImages",[{width:1024,height:160,url:"images/static/delivery-points/header-1024x160.jpg"},{width:1920,height:300,url:"images/static/delivery-points/header-1920x300.jpg"},{width:1080,height:480,url:"images/static/delivery-points/header-1080x480.jpg"},{width:320,height:160,url:"images/static/delivery-points/header-320x160.jpg"},{width:1536,height:320,url:"images/static/delivery-points/header-1536x320.jpg"},{width:640,height:320,url:"images/static/delivery-points/header-640x320.jpg"},{width:1920,height:160,url:"images/static/delivery-points/header-1920x160.jpg"},{width:768,height:160,url:"images/static/delivery-points/header-768x160.jpg"}]).controller("DeliveryPointsCtrl",["$rootScope","$scope","$window","DeliveryPoints","User","$location","$routeParams","LocationAPI","$modal","$q","prizes","RedeemPointModalService","DeliveryPointsHeaderImages",function(a,b,c,d,e,f,g,h,i,j,k,l,m){a.page={bodyClasses:"page-points",title:"delivery.com Points Program | Earn Rewards",description:"You earn points with every order on delivery.com that you can redeem for amazing rewards like credits, charitable donations and more!"};var n=f.path().toString();a.header=-1===n.search("confirmation")?{backAction:function(){c.history.back()}}:{},e.getUserAuthToken()&&e.updateUserInfo(),b.headerImages=m,b.results={},b.delivery_dollars=[],b.rewards=[],b.itemLoaded=!1,b.charity_prizes=k.prizes.charity_prizes,b.buckets=k.prizes.buckets,b.chooseItem=function(b){return e.getUserAuthToken()?b.points_needed>a.userData.delivery_points?!1:void(d.isDeliveryDollars(b)?l.open("credit",b):l.open("reward",b)):(f.path("/account/login"),f.search({next:"/delivery-points"}),!1)},b.chooseCharity=function(a){return e.getUserAuthToken()?void l.open("charity",a):(f.path("/account/login"),f.search({next:"/delivery-points"}),!1)},b.isDonation=function(){return angular.isDefined(b.selectedPrize)?d.isDonation(b.selectedPrize):!1},b.isDeliveryDollars=function(){return angular.isDefined(b.selectedPrize)?d.isDeliveryDollars(b.selectedPrize):!1},b.isItem=function(){return angular.isDefined(b.selectedPrize)?d.isItem(b.selectedPrize):!1},b.$on("$destroy",function(){l.close()})}]).service("RedeemPointModalService",["ModalService",function(a){var b,c={},d={credit:"views/modals/itemRedemptionCredit.html",reward:"views/modals/itemRedemptionReward.html",charity:"views/modals/itemRedemptionCharity.html"};return c.open=function(e,f){c.close(),b=a.open({className:"medium redeem-points",templateUrl:d[e],controller:"RedeemPointModalController",data:{item:f},preCloseCallback:function(){b=null}})},c.close=function(){b&&b.close()},c}]).controller("RedeemPointModalController",["$scope","$rootScope","DeliveryPoints","$location","LocationAPI","$window","StorageService",function(a,b,c,d,e,f,g){a.itemLoaded=!1,a.selectedPrize=a.ngDialogData.item,angular.isDefined(a.selectedPrize.charity_id)?(a.prize_require_address=!0,a.prize_points_needed=0,a.selectedPrizeId=0):(a.prize_require_address=a.selectedPrize.require_address,a.prize_points_needed=a.selectedPrize.points_needed,a.selectedPrizeId=a.selectedPrize.prize_id),f.dataLayer.push({event:"UserAction",eventCategory:"Points Page",eventAction:"Purchase Initiated",eventLabel:a.selectedPrize.name+"-"+a.prize_points_needed,eventValue:a.prize_points_needed}),angular.isDefined(b.userData)&&(a.user_info={first_name:b.userData.first_name,last_name:b.userData.last_name,email:b.userData.email},a.user_fullname=a.user_info.first_name+" "+a.user_info.last_name,a.prize_require_address?e.get().then(function(b){b.locations.length>0&&(a.user_address=b.locations[b.locations.length-1],a.itemLoaded=!0)},function(b){a.results=b}):a.itemLoaded=!0),a.isDisabled=function(a){return a.points_needed>b.userData.delivery_points},a.isSelected=function(b){return b.prize_id===a.selectedPrizeId},a.selectOption=function(b){a.isDisabled(b)||(a.prize_points_needed=b.points_needed,a.selectedPrizeId=b.prize_id)},a.submit=function(){if(a.processing=!0,a.address_errors=!1,a.charity_errors=!1,0===a.selectedPrizeId)return a.processing=!1,void(a.charity_errors=[{code:"prize_id_not_selected",dev_msg:"Please select the amount of points you want to donate.",user_msg:"Please select the amount of points you want to donate."}]);var e={prize_id:a.selectedPrizeId};a.prize_require_address&&(e=angular.extend(e,{street:a.user_address.street,city:a.user_address.city,state:a.user_address.state,zip:a.user_address.zip_code,unit:a.user_address.unit_number})),c.redeemPrize(e).then(function(){a.processing=!1,a.closeThisDialog(),f.dataLayer.push({event:"UserAction",eventCategory:"Points Page",eventAction:"Purchase completed",eventLabel:a.selectedPrize.name+"-"+a.prize_points_needed,eventValue:b.userData.delivery_points-a.prize_points_needed}),g.session.set("DeliveryPoints","lastRedemption",e),d.path("/delivery-points/confirmation/"+a.selectedPrizeId)},function(b){a.address_errors=b,a.processing=!1})}}]),function(){function a(a,d){return d=parseInt(d,10),[].concat(a.prizes.gift_prizes.filter(b(d)),a.prizes.charity_prizes.filter(function(a){return a.option=a.prize_options.filter(b(d))[0],!!a.option}).map(c))[0]}function b(a){return function(b){return b.prize_id===a}}function c(a){return{charity_id:a.option.prize_id,description:a.description,image_name:a.image_name,name:a.name,points_needed:a.option.points_needed,prize_id:a.option.prize_id,require_address:a.option.require_address}}function d(a,b){b=b||{};for(var c in b)a=a.replace("{{ "+c+" }}",encodeURIComponent(b[c]));return a}angular.module("dcomApp").controller("DeliveryPointsConfirmationCtrl",["$rootScope","$scope","$window","DeliveryPoints","User","$location","$routeParams","LocationAPI","UserMessages","$modal","$q","prizes","DeliveryPointsHeaderImages","StorageService",function(b,c,e,f,g,h,i,j,k,l,m,n,o,p){function q(a){var b="I just turned my Delivery Points into cash donation to charity! Feels pretty good";return"City Harvest Donation"===a?b="I just donated Delivery Points to City Harvest to help feed the homeless":"Big Brothers Big Sisters of New York City"===a?b="I just donated Delivery Points to Big Brothers Big Sisters of New York City":"Boomer Esiason Foundation Donation"===a&&(b="I just donated Delivery Points to help fight cystic fibrosis with the Boomer Esiason Foundation"),b}function r(a){b.matchMedia.small?e.open(a,"","width=720, height=430"):e.open(a)}b.page={bodyClasses:"page-points",title:"delivery.com Points Program | Earn Rewards",description:"You earn points with every order on delivery.com that you can redeem for amazing rewards like credits, charitable donations and more!"},b.header={},c.DeliveryPoints=f,c.lastRedemption=p.session.get("DeliveryPoints","lastRedemption"),c.headerImages=o,g.getUserAuthToken()?(g.updateUserInfo(),c.selectedPrize=a(n,i.id),null===c.selectedPrize&&h.path("/delivery-points")):h.path("/delivery-points"),c.getThanksText=function(){return f.isDeliveryDollars(c.selectedPrize)||f.isItem(c.selectedPrize)?"Thanks for redeeming your points!":f.isDonation(c.selectedPrize)?"Thanks for your donation!":void 0},c.getBannerText=function(){return f.isDeliveryDollars(c.selectedPrize)||f.isItem(c.selectedPrize)?"The more you order, the more points you get":f.isDonation(c.selectedPrize)?"Keep racking up points for more rewards":void 0},c.share=function(a){var b,e="http://bit.ly/dcompoints",g={twitter:"http://twitter.com/share?text={{ text }}&url={{ url }}",facebook:"http://www.facebook.com/sharer/sharer.php?u={{ url }}"};f.isDonation(c.selectedPrize)?b=q(c.selectedPrize.name):f.isDeliveryDollars(c.selectedPrize)?b="I just scored a free "+f.getPrizeValue(c.selectedPrize)+" for ordering on delivery.com. Highly recommended":f.isItem(c.selectedPrize)&&(b="I just scored a free "+c.selectedPrize.name+" for ordering on delivery.com. Highly recommended"),r(d(g[a],{text:b,url:e}))}}])}(),angular.module("dcomApp").controller("SEOHelperCtrl",["$scope",function(){var a=this;a.capitalize=function(a){return"undefined"==typeof a?void 0:a[0].toUpperCase()+a.slice(1)}}]),angular.module("dcomApp").controller("TellaFriendCtrl",["$rootScope","$scope","User","$filter","$modal","$window","TafAPI","$location","$timeout",function(a,b,c,d,e,f,g,h){b.email_list=[],a.page={bodyClasses:"page-tell-a-friend",title:"Tell a Friend",description:"Tell your friends about Delivery.com, and earn delivery points, redeemable for cash and prizes"},a.header={backAction:function(){f.history.back()}},b.isAndroid=null!==navigator.userAgent.match(/Android/i)?!0:!1,b.share=function(c){var d,e,g=b.shareLink,i="%0D%0A";if("email"===c){g=encodeURIComponent(g);var j="Get "+b.bountyTextSharing+" at delivery.com";return d="Hey!"+i+i+"Use this link to order from delivery.com, and we’ll both get "+b.bountyTextSharing+" our next orders!"+i+i+g+i+i+"They’ve got all the best restaurants, wine and liquor shops, grocery stores, and even dry cleaners that deliver. So you should really check it out.*"+i+i+"*Full disclosure: I’ll get "+b.bountyTextSharing+" too, so please, thanks, and you’re welcome!",e="mailto:?subject="+j+"&body="+d,f.location.href=e,!1}if("twitter"===c)d="Check out @deliverydotcom & get "+b.bountyTextSharing+" when you order from local restaurants and stores",e="https://twitter.com/intent/tweet?url={{ url }}&text={{ text }}".replace("{{ text }}",f.escape(d)).replace("{{ url }}",encodeURIComponent(g));else if("facebook"===c)if(a.matchMedia.small)e="http://www.facebook.com/sharer/sharer.php?u="+encodeURIComponent(g);else{var k,l=h.host();k=-1!==l.search("-api.")?"761286000589329":-1!==l.search("staging.")?"1581127305440776":"893944157284040";var m="https://"+l+"/account/tell-a-friend/thanks";e="https://www.facebook.com/dialog/share?app_id="+k+"&display=popup&href="+encodeURIComponent(g)+"&redirect_uri="+encodeURIComponent(m)}a.matchMedia.small?f.open(e,"","width=720, height=430"):f.open(e,"_blank")},b.showEarnings=!1,b.$watch(function(){return a.userData},function(){a.userData&&(g.share().then(function(a){b.shareLink="https://"+h.host()+"/share?code="+a.share_info.share_code}),g.getBounty().then(function(a){b.bountyType=a.bounty.referrer_reward_type,b.bountyAmount=a.bounty.referrer_reward_amount,"C"===b.bountyType?(b.bountyText="$"+parseInt(b.bountyAmount,10),b.bountyTextSharing=b.bountyText+" off"):(b.bountyText=parseInt(b.bountyAmount,10)+" Delivery Points",b.bountyTextSharing=b.bountyText),g.getReport().then(function(a){a&&(b.user_invited=a.invited,b.user_joined=a.joined,b.total_credits=parseFloat("0.00"),b.total_points=parseInt(0,10),b.combination_obj=a.invited,"undefined"!=typeof a.joined&&a.joined.length>0&&(b.combination_obj=b.combination_obj.concat(a.joined)),"undefined"!=typeof a.purchased&&a.purchased.length>0&&(b.combination_obj=b.combination_obj.concat(a.purchased),a.purchased.forEach(function(a){null!==a.amount&&"C"===a.award_type&&(b.total_credits+=parseFloat(a.amount)),null!==a.amount&&"C"!==a.award_type&&(b.total_points+=parseInt(a.amount,10))})),"C"===b.bountyType?(b.total_earnings="$"+d("number")(b.total_credits,2),b.total_credits>0&&(b.showEarnings=!0)):(b.total_earnings=d("number")(b.total_points,0)+" Delivery Points",b.total_points>0&&(b.showEarnings=!0)))})}))})}]),angular.module("dcomApp").controller("TellaFriendThanksCtrl",["$rootScope","$scope","$window","$location","TafAPI",function(a,b,c,d,e){a.page={bodyClasses:"page-tell-a-friend",title:"Tell a Friend",description:"Tell your friends about Delivery.com, and earn delivery points, redeemable for cash and prizes"},a.hideNavigation=!0,b.closeTab=function(){c.close(),a.hideNavigation=!1,d.path("/")},b.$watch(function(){return a.userData},function(){a.userData&&e.getBounty().then(function(a){b.bountyType=a.bounty.referrer_reward_type,b.bountyAmount=a.bounty.referrer_reward_amount,b.bountyText="C"===b.bountyType?"$"+parseInt(b.bountyAmount,10):parseInt(b.bountyAmount,10)+" Delivery Points"})})}]),angular.module("dcomApp").controller("WildcardCtrl",["$controller","$location","$routeParams","$rootScope","$scope","Group","SEOUrlBuilder",function(a,b,c,d,e,f,g){function h(a){return-1!==g.getSupportedCategories().indexOf(a)?!0:!1}function i(a){return f.getGroupFromAnyKey(a,"name")}function j(a){return angular.isDefined(o[a.toLowerCase()])?(e.currentCity=o[a.toLowerCase()],!0):!1}function k(a){return angular.isDefined(p[a.toLowerCase()])?(e.currentCity=p[a.toLowerCase()],!0):!1}function l(a){return angular.isDefined(q[a.toLowerCase()])?(e.currentCuisine=q[a.toLowerCase()],!0):!1}function m(a){return i(a)?"group":j(a)?"city":k(a)?"neighborhood":h(a)?"category":l(a)?"cuisine":null}function n(b,d){"group"===b&&"city"===d?(c.group=c.first_keyword,c.city=e.currentCity,e.templatePath="views/seoTagListCities.html",e=a("SeoTagListCitiesCtrl",{$scope:e})):"group"===b&&"neighborhood"===d?(c.group=c.first_keyword,c.city=e.currentCity,c.neighborhood=c.second_keyword,e.templatePath="views/merchantsSEO.html",e=a("SeoCitySearchCtrl",{$scope:e})):"city"===b&&"group"===d?(c.group=c.second_keyword,c.city=e.currentCity,e.templatePath="views/merchantsSEO.html",e=a("SeoCitySearchCtrl",{$scope:e})):"city"===b&&"category"===d?(c.group=c.second_keyword,c.city=e.currentCity,e.templatePath="views/merchantsSEO.html",e=a("SeoCitySearchCtrl",{$scope:e})):"neighborhood"===b&&"group"===d?(c.group=c.second_keyword,c.city=e.currentCity,c.neighborhood=c.first_keyword,e.templatePath="views/merchantsSEO.html",e=a("SeoCitySearchCtrl",{$scope:e})):"neighborhood"===b&&"category"===d?(c.group=c.second_keyword,c.city=e.currentCity,c.neighborhood=c.first_keyword,e.templatePath="views/merchantsSEO.html",e=a("SeoCitySearchCtrl",{$scope:e})):"group"===b&&"city"===d?(c.group=c.first_keyword,c.city=c.second_keyword,e.templatePath="views/seoTagListCities.html",e=a("SeoTagListCitiesCtrl",{$scope:e})):"cuisine"===b&&"neighborhood"===d?(c.cuisine=c.first_keyword,e.currentCuisine&&(c.cuisine=e.currentCuisine),c.city=e.currentCity,c.neighborhood=c.second_keyword,e.templatePath="views/merchantsSEO.html",e=a("SeoCitySearchCtrl",{$scope:e})):"city"===b&&"cuisine"===d?(c.cuisine=c.second_keyword,e.currentCuisine&&(c.cuisine=e.currentCuisine),c.city=e.currentCity,e.templatePath="views/merchantsSEO.html",e=a("SeoCitySearchCtrl",{$scope:e})):"neighborhood"===b&&"cuisine"===d?(c.cuisine=c.second_keyword,e.currentCuisine&&(c.cuisine=e.currentCuisine),c.city=e.currentCity,c.neighborhood=c.first_keyword,e.templatePath="views/merchantsSEO.html",e=a("SeoCitySearchCtrl",{$scope:e})):"cuisine"===b&&"city"===d&&(c.cuisine=c.first_keyword,e.currentCuisine&&(c.cuisine=e.currentCuisine),c.city=e.currentCity,e.templatePath="views/merchantsSEO.html",e=a("SeoCitySearchCtrl",{$scope:e}))}var o=g.getSupportedCities(),p=g.getSupportedNeighborhoods(),q=g.getSupportedCuisines(),r=null,s=!1;if(c.city&&c.neighborhood&&c.cuisine)c.cuisine=c.cuisine.replace("-cuisine",""),r="/cities/"+c.city+"/categories/food/"+c.cuisine+"/neighborhoods/"+c.neighborhood,s=!0;else if(c.city&&c.neighborhood&&!c.cuisine)r="/cities/"+c.city+"/categories/food/neighborhoods/"+c.neighborhood,s=!0;else if(c.city&&c.cuisine&&!c.neighborhood)r="/cities/"+c.city+"/categories/food/"+c.cuisine,s=!0;else if(-1!==c.second_keyword.search("-cuisine")){var t=c.second_keyword.replace("-cuisine","");r="/cities/"+c.first_keyword+"/categories/food/"+t}else 3===b.path().split("/").length&&"cities"===c.first_keyword?(r="/cities/"+c.second_keyword+"/categories/food",s=!0):3===b.path().split("/").length&&"cuisines"===c.first_keyword&&(r="/food/"+c.second_keyword,s=!0);if(r){var u=g.getShortUrl(r);u?(s&&(d.tempCanonicalUrl=b.protocol()+"://"+b.host()+u),b.path(u)):(s&&(d.tempCanonicalUrl=b.protocol()+"://"+b.host()+r),b.path(r))}else{var v,w=m(c.first_keyword);c.second_keyword&&(v=m(c.second_keyword)),w&&v||(b.search({}),b.path("/404")),n(w,v)}}]),angular.module("dcomApp").controller("MaintenanceCtrl",["$rootScope","$scope","$location",function(a,b,c){function d(){return a.maintenanceMode?void(e.messages=angular.isDefined(a.maintenanceMessage)?a.maintenanceMessage:[{user_msg:"delivery.com is currently updating a few things under the hood and should be finished shortly."},{user_msg:"Please bear with us as we work to improve the experience!"}]):void c.path("/")}var e=this;return a.page={bodyClasses:"page-maintenance",title:"Be Right Back",description:"We're down for scheduled maintenance"},d(),e}]),angular.module("dcomApp").controller("MapCtrl",["$modal","$rootScope","DcomConfig","Device",function(a,b,c,d){var e=this;return e.showMap=function(){var c=e.merchant.location.street+","+e.merchant.location.city+","+e.merchant.location.state+" "+e.merchant.location.zip;b.matchMedia.small||d.isMobileApp()?a.open({templateUrl:"views/modals/googlemap.html",controller:["$scope","$rootScope","$sce",function(a,b,d){a.map_url="https://www.google.com/maps/embed/v1/place?key=AIzaSyBSd8GcVToDamHNviO0AgplqCWmIMmkHeM&q="+encodeURIComponent(c),a.trustSrc=function(a){return d.trustAsResourceUrl(a)},a.iframe_height=b.matchMedia.small?"550":"400"}]}):window.open("https://www.google.com/maps/place/"+encodeURIComponent(c))},e}]),angular.module("dcomApp").controller("MerchantAddressModalCtrl",["$routeParams","$scope","$rootScope","$window","MerchantAPI","SearchLocation","ScheduleProvider","UserMessages","merchantInfo","ambiguousAddresses",function(a,b,c,d,e,f,g,h,i,j){function k(a){p.contentTpl="views/modals/merchantOutOfRange.html",p.address=a,p.searchUrl="/search?address="+encodeURIComponent(a)+"&addressmodal=true"}function l(c){if(!c||""===c)return void(b.noAddressSubmit=!0);var d=angular.isDefined(i.id)?i.id:a.urlStub;e.getMerchantInfo(d,c).then(function(a){var c,d,e;a.message.length>0&&"loc_multiple_possible"===a.message[0].code?(p.addresses=a.addresses,p.contentTpl="views/modals/merchantAmbiguousAddress.html",n("Address Validation (AMBIGUOUS)")):(d=a.merchant.search_address,e=d.street+", "+d.zip_code,c={addressmodal:!0,query:e,latitude:d.latitude.toString(),longitude:d.longitude.toString(),street:d.street,city:d.city,state:d.state,zip:d.zip_code},angular.isDefined(d.laundry_location_id)?c.location_id=d.laundry_location_id:angular.isDefined(f.get().location_id)&&(c.location_id=f.get().location_id),f.set(c,365),a.merchant.deliverable===!0?(b.$close(c),n("Address Validation (SUCCESS)")):(k(e),n("Address Validation (FAILURE)")))},function(){p.contentTpl="views/modals/merchantAddressValidationError.html",n("Address Validation (FAILURE)")})}function m(){p.addressFieldShowing=!0}function n(a){d.dataLayer.push({event:"Address Set Popup",eventCategory:"No address set",eventAction:a,eventLabel:i.summary.url.complete})}function o(){p.merchantInfo=i?i:!1,p.addresses=j?j:!1,p.setAddress=l,p.showAddressField=m,p.addressFieldShowing=!1,p.addresses?p.contentTpl="views/modals/merchantAmbiguousAddress.html":f.get().query&&"undefined, undefined"!==f.get().query?k(f.get().query):p.contentTpl="views/modals/merchantNoAddress.html",b.processingDisabled=!1,b.pickupAvailable=!1,b.orderOptions=q.getOrderableTypes(p.merchantInfo),b.orderOptions.length>1&&!p.addresses&&(b.pickupAvailable=!0),n("Popup Displayed")}var p=this,q=g.set("menu");b.updateOrderTypeToPickup=function(){b.processing=!0,q.setOrderType("pickup",p.merchantInfo.id),c.$broadcast("cartChange",{change:"orderType"}),n("Popup Option Selected (Pickup)"),b.processing=!1,b.$close()},o()}]),angular.module("dcomApp").controller("InvalidCartItemsModalCtrl",["$scope","$window","CartProvider","orderSettings",function(a,b,c,d){function e(a,c,e){for(var f=[],g=0;g<c.length;g++)f.push(c[g].item_name);b.dataLayer.push({event:"OrderAction",eventCategory:"Merchant",eventAction:"Bag and item conflict",eventLabel:d.currentGroup+" - "+d.merchantInfo.summary.name+" : "+d.orderType+" : "+e.format(j.dateFormat+" "+j.timeFormat)+" : "+f.join(", "),eventValue:f.length})}function f(a){b.dataLayer.push({event:"OrderAction",eventCategory:"Merchant",eventAction:"Bag and item conflict resolved",eventLabel:a})}function g(){j.processing=!0;for(var a=[],b=0;b<j.itemInfo.length;b++)a.push(j.itemInfo[b].item_key);l.remove(a.join()).then(function(){j.processing=!1,l.reload().then(function(){j.closeModal("remove items"),d.saveSettings(!0)},function(){j.closeModal("remove items"),d.saveSettings(!0)})}),f("remove items")}function h(){i("choose new time"),f("choose new time")}function i(b){a.$close(b),angular.element(document.getElementById("content-overlay")).remove()}b.dataLayer=b.dataLayer||[];var j=this,k=Date.create(),l=(d.cart.message,c.get(d.merchantInfo.id));j.cart=d.cart,j.itemInfo=j.cart.message,j.orderType=d.orderType,j.orderTime=d.orderTime,j.merchantInfo=d.merchantInfo,j.dateFormat="{dow} {month} {ord}",j.timeFormat="{12hr}:{mm}{tt}",j.invalidTime=Date.create(j.orderTime),j.processing=!1,j.hideCancel=!1,j.displayTime="ASAP"===j.orderTime?"ASAP":j.invalidTime.format(j.timeFormat),j.displayDate=j.invalidTime.format(j.dateFormat)===k.format(j.dateFormat)||"ASAP"===d.orderTime?"Today":j.invalidTime.format(j.dateFormat),e(j.merchantInfo.id,j.itemInfo,j.invalidTime),j.removeItems=g,j.cancel=h,j.closeModal=i}]),angular.module("dcomApp").controller("MobileNavCtrl",["User","$rootScope","$scope","$timeout","HammerEvents","ModalPages",function(a,b,c,d,e,f){b.mainNavActive=!1,b.toggleMainNav=function(){c.closeOnClickOut(b.mainNavActive,b.toggleMainNav),b.mainNavActive=!b.mainNavActive},b.hideMainNav=function(){b.mainNavActive=!1},c.login=function(){b.toggleMainNav(),f.openPage("login")},c.signup=function(){b.toggleMainNav(),f.openPage("signup")},c.logout=function(){b.toggleMainNav(),a.logout()},c.applyOverlay=function(a){var b=angular.element('<div class="menu-overlay" id="menu-overlay"></div>'),c=document.getElementById("site-wrapper");document.body.insertBefore(b[0],c),e.onClick(b[0],a)};var g=function(a){a.target&&"menu-overlay"===a.target.className&&a.preventDefault()};c.closeOnClickOut=function(a,e){if(a){var f=document.getElementById("menu-overlay");f.parentNode.removeChild(f),b.page.bodyClasses=b.page.bodyClasses.replace(" mobile-nav-open",""),document.body.removeEventListener("touchstart",g)}else c.applyOverlay(e),b.page.bodyClasses+=" mobile-nav-open",document.body.addEventListener("touchstart",g);d(function(){c.$apply()},300)}}]),function(){angular.module("dcomApp.controller.repeatOrder",[]).controller("RepeatOrderController",["$rootScope","repeatOrders","LaundryRepeatOrderService","UserMessages","$location","$window",function(a,b,c,d,e,f){var g=this;return a.page={bodyClasses:"page-repeat-orders",title:"Repeat orders"},g.orders=b,g.edit=function(a){e.path("account/repeat-orders/edit/"+a.recurring_order_uid),f.dataLayer.push({event:"OrderAction",eventCategory:"Repeat",eventAction:"Repeat order edit",eventLabel:"Edit "+a.laundromat_name})},g.delete=function(a){d.askConfirmation({title:"Delete repeat order",message:"Are you sure you want to delete this repeat order?",ok:"Ok",cancel:"Cancel"}).then(function(){g.orders=g.orders.filter(function(a){return a.recurring_order_uid!==a.recurring_order_uid}),c.deleteOrder(a.recurring_order_uid).then(function(a){g.orders=a}),f.dataLayer.push({event:"OrderAction",eventCategory:"Repeat",eventAction:"Repeat order trash",eventLabel:"Trash "+a.laundromat_name})})},g.createNewRepeatOrder=function(){e.path("account/orders"),f.dataLayer.push({event:"OrderAction",eventCategory:"Repeat",eventAction:"Order history",eventLabel:"Go to order history"})},g}])}(),function(){function a(a,d,e,f){f=f||[],a[e]=f,b(a,e,f,d),f.length&&c(a,e)}function b(a,b,c,d){a[b+"Dates"]={},angular.forEach(c,function(c){var e=g(new Date(+c.timeStamp),d);a[b+"Dates"][e]=a[b+"Dates"][e]||[],a[b+"Dates"][e].push(c)})}function c(a,b){d(a,b),e(a,b)}function d(a,b){var c=a[b+"SelectedDate"];a[b+"Dates"][c]||(c=Object.keys(a[b+"Dates"])[0]),a[b+"SelectedDate"]=c}function e(a,b){var c=a[b+"SelectedDate"],d=a[b+"SelectedTime"],e=a[b+"Dates"][c]||[],g=e.filter(f(d)).concat(e);g.length>0&&(d=g[0].timeStamp),a[b+"SelectedTime"]=d}function f(a){var b=h(new Date(+(a||"")));return function(a){return h(new Date(+a.timeStamp))===b
}}function g(a,b){return b("date")(a,"EEE MMM d, yyyy")}function h(a){return a.toISOString().substr(11,8)}function i(a){return a.laundromat_id?{name:a.laundromat_name,minimum:a.minimum_order_amount,merchant_id:a.laundromat_id,phone:a.phone_number.pretty,frequency:a.frequency,type:a.type,instructions:a.instructions,location_id:a.location_id,delivery_address:a.default_address,pickup_time:a.time_window.next_pickup.timeStamp,delivery_time:a.time_window.next_delivery.timeStamp,tip:a.tip}:{name:a.name,minimum:a.minimum_order_amount,merchant_id:a.merchant_id,phone:a.delivery_address.phone,frequency:2,type:"Laundry",instructions:"",location_id:a.location_id,delivery_address:a.delivery_address.street+", "+a.delivery_address.city+", "+a.delivery_address.state+", "+a.delivery_address.zip_code,pickup_time:0,delivery_time:0,tip:4}}function j(a,b,c){a[b+"SelectedTime"]=a.order[b+"_time"],a[b+"SelectedDate"]=g(new Date(+a[b+"SelectedTime"]),c)}angular.module("dcomApp.controller.repeatOrderCreate",[]).controller("RepeatOrderCreateController",["$rootScope","order","LaundryRepeatOrderService","$location","$filter","$route","$window",function(b,d,e,f,h,k,l){var m=this;return b.page={bodyClasses:"page-create-repeat-order",title:(k.current.data.edit?"Update":"Create")+" a repeat order"},m.loading=!0,m.submitting=!1,m.order=i(d),m.edit=k.current.data.edit,m.tip=h("number")(m.order.tip,2),m.frequency=m.order.frequency,m.specialInstructions=m.order.instructions,m.type=m.order.type,m.types=[{id:"Dry Cleaning",label:"Dry Cleaning"},{id:"Laundry",label:"Laundry"},{id:"Both",label:"Both"}],m.updateType=function(){m.loading=!0,a(m,h,"pickup"),a(m,h,"delivery"),e.getPickupTimes(m.order.merchant_id,m.order.location_id,m.type).then(function(b){a(m,h,"pickup",b),m.updatePickupDate()})},m.updatePickupDate=function(){m.loading=!0,c(m,"pickup"),m.updatePickupTime()},m.updatePickupTime=function(){m.loading=!0,a(m,h,"delivery"),e.getDeliveryTimes(m.order.merchant_id,m.order.location_id,m.type,m.pickupSelectedTime).then(function(b){a(m,h,"delivery",b),m.loading=!1})},m.updateDeliveryDate=function(){c(m,"delivery")},m.isValidPickupDate=function(a){return!!m.pickupDates[g(a,h)]},m.isValidDeliveryDate=function(a){return!!m.deliveryDates[g(a,h)]},m.create=function(){m.loading=!0,m.submitting=!0,e.createOrder({type:m.type,laundromat_id:m.order.merchant_id,frequency:m.frequency,tip:m.tip,pickup_time:m.pickupSelectedTime,delivery_time:m.deliverySelectedTime,location_id:m.order.location_id,instructions:m.specialInstructions}).then(function(){f.path("account/repeat-orders")}).catch(function(){m.loading=!1,m.submitting=!1}),l.dataLayer.push({event:"OrderAction",eventCategory:"Repeat",eventAction:"Create clicked",eventLabel:m.order.name})},m.update=function(){m.loading=!0,m.submitting=!0,e.updateOrder(d.recurring_order_uid,{type:m.type,laundromat_id:m.order.merchant_id,frequency:m.frequency,tip:m.tip,pickup_time:m.pickupSelectedTime,delivery_time:m.deliverySelectedTime,location_id:m.order.location_id,instructions:m.specialInstructions}).then(function(){f.path("account/repeat-orders")}).catch(function(){m.loading=!1,m.submitting=!1}),l.dataLayer.push({event:"OrderAction",eventCategory:"Repeat",eventAction:"Update clicked",eventLabel:m.order.name})},j(m,"pickup",h),j(m,"delivery",h),m.updateType(),m}])}(),angular.module("dcomApp").directive("dcomMap",function(){return{template:'<div>	<a  ng-click="map.showMap()">		<img class="gmap" ng-src="https://maps.googleapis.com/maps/api/staticmap?zoom=13&size=300x150&maptype=roadmap&markers=color:red%7Clabel:%7C{{map.merchant.location.latitude}},{{map.merchant.location.longitude}}" />		<span class="expand-label">Expand map <i class="icon-map-marker"></i></span>	</a></div>',restrict:"E",scope:{merchant:"="},bindToController:!0,controller:"MapCtrl as map"}}),angular.module("dcomApp").directive("dcomAddressSearch",["$location","$rootScope","SearchLocation","Group","MerchantSearch","$window","LocationAPI","$timeout","Cookies","Device","ItemSearchKeyword",function(a,b,c,d,e,f,g,h,i,j,k){return f.dataLayer=f.dataLayer||[],{template:'<div class="address-search"><form ><div class="delivery-pickup" ng-if="pickupToggle===\'true\'"><span class="delivery-select" ng-class="{\'inactive\':pickupSelected}" ng-click="setPickupFromLabel(false)">Delivery</span><input id="{{checkboxId}}"  class="pickup-toggle pickup-toggle-round" type="checkbox" ng-click="togglePickup()" ><label id="label-{{checkboxId}}" for="{{checkboxId}}"></label><span class="pickup-select" ng-class="{\'inactive\':!pickupSelected}" ng-click="setPickupFromLabel(true)">Pickup</span></div><span class="laundry-toggle-message" ng-show="pickupToggle===\'false\' && showLaundryMessage===\'true\'">Schedule pickup and delivery</span><div class="dropdown-arrow-wrapper" ng-class="{\'no-toggle\':pickupToggle===\'false\'}"><span class="icon-down-arrow-thick dropdown-arrow" ng-if="!hasDropdown && savedAddresses.length>0" ng-click="showDropdownFromAltArrow()"></span></div><div dcom-location-based-search class="location-based-search-wrapper" ng-model="searchDirectiveModel" ng-class="{\'no-toggle\':pickupToggle===\'false\', \'left-toggle\':pickupToggle===\'true\'}"></div><div dcom-address-search-autocomplete ng-model="searchDirectiveModel" ng-class="{\'no-toggle\':pickupToggle===\'false\', \'dropdown-arrow-present\':!hasDropdown && savedAddresses.length>0}" ng-show="!hasDropdown" data-placeholder="{{placeholder}}" search-input-id="{{searchInputId}}" search-label="{{searchLabel}}" has-dropdown="hasDropdown" suppress-automatic-search="suppressAutomaticSearch" no-address-submit="noAddressSubmit" tab-index="{{::tabIndexAddressSearch}}"></div><div dcom-address-search-dropdown ng-class="{\'no-toggle\':pickupToggle===\'false\'}" has-dropdown="hasDropdown" ng-if="hasDropdown" addresses="savedAddresses" toggle="toggleAddressDropdown" no-address-submit="noAddressSubmit"></div><div ng-if="includeItemSearch && pickupToggle===\'true\'" dcom-item-search ng-model="searchDirectiveItem" class="main-item-search-container" current-group="{{currentGroup}}" tab-index="{{::tabIndexItemSearch}}"></div> <button type="submit" ng-click="searchSubmit($event)" class="address-search-submit button primary" tabindex="{{::tabIndexSearchButton}}">{{ctaText}}</button></form></div>',restrict:"A",scope:{ctaText:"@",placeholder:"@",searchInputId:"@",searchHandler:"=",searchLabel:"@",value:"@",searchDirectiveModel:"=ngModel",pickupToggle:"@",currentGroup:"@",isSticky:"@",checkboxId:"@",includeItemSearch:"@",noAddressSubmit:"=",suppressAutomaticSearch:"=",showLaundryMessage:"@",tabIndexAddressSearch:"@",tabIndexItemSearch:"@",tabIndexSearchButton:"@"},controller:["$scope","$element","$window",function(c,e,f){function g(a,b,c){for(var d=document.querySelectorAll(a),e=0;e<d.length;e++)d[e].property=c}function j(a){if(a>0&&"true"===c.pickupToggle){var b=document.getElementById(c.checkboxId),d="pickup"===i.getCookie("globalOrderType");h(function(){b?c.setPickup(d):j(a-1)},100)}}var l=this;f.dataLayer=f.dataLayer||[],c.windowDataLayer=f.dataLayer,c.geolocated=!1,c.geoAddressAdded=!1,c.hasDropdown=!1,c.toggleAddressDropdown=!1,c.savedAddresses=[],c.ctaText||(c.ctaText="Search"),c.checkboxId=c.checkboxId||"pickup-checkbox",c.$watch("savedAddresses",function(){c.hasDropdown=c.savedAddresses.length>0?!0:!1}),l.setGeolocated=function(a){c.geolocated=a,c.geolocated===!0&&c.hasDropdown===!0&&l.showDropdown(!1)},l.setAddress=function(a){angular.isDefined(a)&&(c.searchDirectiveModel=a,c.noAddressSubmit=!1)},l.setItemKeyword=function(a){angular.isDefined(a)&&(c.searchDirectiveItem=a)},l.showDropdown=function(a){c.hasDropdown=a,c.hasDropdown===!1&&h(function(){e[0].querySelector("#"+c.searchInputId).focus()})},c.showDropdownFromAltArrow=function(){c.geolocated&&!c.geoAddressAdded&&c.savedAddresses[0]!==c.searchDirectiveModel.toUpperCase()&&""!==c.searchDirectiveModel&&(c.savedAddresses.unshift(c.searchDirectiveModel.toUpperCase()),c.geoAddressAdded=!0),l.showDropdown(!0),c.toggleAddressDropdown=!0},l.shortenPlaceholderAddress=function(){c.savedPlaceholder=angular.copy(c.placeholder),c.savedFieldContent=angular.copy(c.searchDirectiveModel),c.hadDropdown=angular.copy(c.hasDropdown),c.searchDirectiveModel="",c.placeholder="Your Address",c.hasDropdown=!1},l.revertPlaceholderAddress=function(){c.placeholder=angular.copy(c.savedPlaceholder),c.geolocated||(c.searchDirectiveModel=angular.copy(c.savedFieldContent),c.hasDropdown=angular.copy(c.hadDropdown))},l.setTogglePreference=function(){if("true"===c.pickupToggle){var a=document.getElementById(c.checkboxId);if(a&&a.checked)return i.setCookie("globalOrderType","pickup",{expires:i.setExpInHours(1)}),"pickup";if(a&&!a.checked)return i.setCookie("globalOrderType","delivery",{expires:i.setExpInHours(1)}),"delivery"}return null},l.redirectToSearch=function(){if(!c.searchDirectiveModel||""===c.searchDirectiveModel)return void(c.noAddressSubmit=!0);var b=l.setTogglePreference();null!==b&&f.dataLayer.push({event:"OrderAction",eventCategory:"Homepage",eventAction:"Search "+b,eventLabel:d.getCurrentGroupPath()+":"+c.searchDirectiveModel}),a.path("/search");var e={},g=d.getCurrentGroupPath();""!==g&&(e[g]=!0),e.address=c.searchDirectiveModel,e.geolocation=c.geolocated.toString(),c.searchDirectiveItem&&c.searchDirectiveItem.length>0&&"l"!==d.currentGroup()&&(e.keyword=c.searchDirectiveItem,e.algo=k.getDefaultAlgo(),f.dataLayer.push({event:"OrderAction",eventCategory:"Homepage",eventAction:"Text Search",eventLabel:d.getCurrentGroupPath()+":"+c.searchDirectiveModel+":"+c.searchDirectiveItem})),a.search(e);var h=location.search.substring(1);h||(h="food"),Leanplum.track("Search Triggered","Homepage",{vertical:h,address:c.searchDirectiveModel,keyword:c.searchDirectiveItem})},l.searchSubmit=function(){"undefined"==typeof c.searchHandler?l.redirectToSearch():c.searchHandler(c.searchDirectiveModel)},c.searchSubmit=l.searchSubmit,c.setPickup=function(a){c.pickupSelected=a},c.setPickupFromLabel=function(a){c.setPickup(a),c.setSelectionClasses(),document.getElementById(c.checkboxId).checked=a},c.ensurePickupToggleSet=function(){var a=document.getElementById(c.checkboxId);a&&(a.checked=c.pickupSelected)},c.togglePickup=function(){c.pickupSelected=!c.pickupSelected},c.setSelectionClasses=function(){var a=c.pickupSelected;g(".pickup-select","className","pickup-select"),g(".delivery-select","className","delivery-select"),a?g(".delivery-select","className","delivery-select inactive"):a||g(".pickup-select","className","pickup-select inactive")},c.$watch("pickupSelected",function(a,c){a!==c&&b.$broadcast("OrderTypeUpdated",a)}),c.$on("OrderTypeUpdated",function(a,b){b!==c.pickupSelected&&c.setPickupFromLabel(b),c.ensurePickupToggleSet()}),c.$watch("pickupToggle",function(a){a&&j(10)})}],link:function(d){function e(){b.userData&&g.get("recent").then(function(b){var e,f,g=[],h=[],i=!1;if(b.locations.length>0){if(b.locations.length>0)for(f=0;f<b.locations.length;f++){var j=b.locations[f].street+", "+b.locations[f].zip_code;-1===g.indexOf(j)&&g.push(j)}if(c.isSet()){var k=c.get();if(k.zip_code=k.zip,k.address=k.street,k.address&&k.zip_code){for(f=0;f<g.length;f++)g[f]===k.address+", "+k.zip_code&&(i=!0);i?e=k.street+", "+k.zip_code:h.push(k.street+", "+k.zip_code)}}for(i&&h.push(e),f=0;f<g.length&&(-1===h.indexOf(g[f])&&h.push(g[f]),6!==h.length);f++);d.savedAddresses=h}d.windowDataLayer.push({event:"HomePageAction",eventCategory:"Saved Address",eventAction:"List Populated",eventLabel:a.path(),eventValue:d.savedAddresses.length})})}d.$on("authReturn",function(){e()}),d.$on("authSuccess",function(){e()}),e();var f="undefined"!=typeof a.search().androidVersion||"undefined"!=typeof a.search().iosVersion;f&&i.setCookie("geo_enabled","true",{expires:365});var h=i.getCookie("geo_enabled");j.isMobileApp()&&"undefined"==typeof h&&(b.page.bodyClasses+=" location-disabled")}}}]).directive("dcomAddressSearchDropdown",["$location","$rootScope","SearchLocation","Group","MerchantSearch","$window","LocationAPI","$timeout","HammerEvents",function(a,b,c,d,e,f,g,h,i){return f.dataLayer=f.dataLayer||[],{template:'<div id="dropdown-wrapper" ng-if="addresses.length > 0"><div ng-click="toggleDropdown()" id="dropdown-value"><span class="address-text">{{ currentAddress }}</span><span class="icon-down-arrow-thick"></span></div><div id="dropdown-options" ng-show="isVisible"><div ng-repeat="address in addresses track by $index" ng-click="addressClick(address)" class="address-item" ng-class="{\'selected\':address===currentAddress}"><span class="address-text">{{ address }}</span></div><div class="address-item new-address" ng-click="addressClick()">New address...</div></div></div></div>',restrict:"A",require:"^dcomAddressSearch",scope:{addresses:"=",hasDropdown:"=",noAddressSubmit:"=",toggledFromAltArrow:"=toggle",searchDirectiveModel:"=ngModel"},controller:["$scope","$element","$window",function(a,b,c){a.currentAddress=a.addresses[0],a.windowDataLayer=c.dataLayer,a.hasBeenToggled=!1}],link:function(a,b,c,e){a.isVisible=!1,a.$watch("addresses",function(a,b){e.setAddress(b[0])}),a.$watch("toggledFromAltArrow",function(b,c){c===!0&&a.toggleDropdown()}),a.addressClick=function(b){if(b)a.itemClickHandler(b);else{a.newAddressHandler();var c=document.getElementById("address-search");c&&c.focus()}},a.toggleDropdown=function(){a.hasBeenToggled||(a.hasBeenToggled=!0),a.closeOnClickOut(a.isVisible,a.toggleDropdown),a.isVisible=!a.isVisible,a.isVisible?a.windowDataLayer.push({event:"OrderAction",eventCategory:"Saved Address",eventAction:"Clicked",eventLabel:"Saved Address Dropdown Clicked"}):h(function(){a.$apply()})},a.applyOverlay=function(a){var b;b=angular.element('<div class="menu-overlay address-dropdown-overlay" id="menu-overlay"></div>');var c=document.getElementById("dropdown-wrapper"),d=document.getElementById("dropdown-options");c.insertBefore(b[0],d),i.onClick(b[0],a)},a.closeOnClickOut=function(b,c){if(b){var d=document.getElementById("menu-overlay");d.parentNode.removeChild(d)}else a.applyOverlay(c)},a.newAddressHandler=function(){a.toggleDropdown(),e.showDropdown(!1),e.setAddress(""),a.windowDataLayer.push({event:"OrderAction",eventCategory:"Saved Address",eventAction:"Selection",eventLabel:"New Address"})},a.itemClickHandler=function(b){"undefined"==typeof a.searchHandler?(f.dataLayer.push({event:"HomePageAction",eventCategory:"Homepage",eventAction:"Search",eventLabel:d.getCurrentGroupPath()+":"+b}),e.setAddress(b),a.currentAddress=b,a.toggleDropdown(),a.windowDataLayer.push({event:"OrderAction",eventCategory:"Saved Address",eventAction:"Selection",eventLabel:b})):a.searchHandler(b)}}}}]).directive("dcomLocationBasedSearch",["$location","$rootScope","SearchLocation","Group","MerchantSearch","$window","$modalStack","LocationAPI",function(a,b,c,d,e,f,g){return f.dataLayer=f.dataLayer||[],{template:'<div class="location-button-wrapper" ng-class="{\'has-message\':hasMessage}"><span ng-hide="currentlyLocating" ng-click="locate()" class="icon-location-arrow" ng-class="{\'geolocation-active\':currentlyLocating || successGeolocation}" ng-mouseover="arrowHover()" ng-mouseleave="arrowLeave()"></span><span ng-show="currentlyLocating" class="spinner"></span><span class="location-message" ng-class={\'currently-locating\':currentlyLocating} ng-if="hasMessage || currentlyLocating">{{userMessage}}</span></div>',restrict:"A",require:"^dcomAddressSearch",scope:{searchDirectiveModel:"=ngModel"},controller:["$scope","$element","$window","$http","$modal",function(a,c,d,e,f){a.windowDataLayer=d.dataLayer,a.currentlyLocating=!1,a.successGeolocation=!1,a.hasMessage=!1;var h={enableHighAccuracy:!0,timeout:5e3,maximumAge:0};a.locate=function(){a.currentlyLocating=!0;var b;navigator.geolocation?(a.successGeolocation?(a.userMessage="",a.hasMessage=!1):(a.userMessage="Press 'Allow' to continue",a.hasMessage=!0),navigator.geolocation.getCurrentPosition(function(c){a.successGeolocation=!0,b=a.getAddress(c.coords.latitude,c.coords.longitude)},a.handleGeolocationError,h)):a.handleGeolocationError("geolocation not supported")},a.getAddress=function(b,c){var d,f,g,h,i,j,k="https://maps.googleapis.com/maps/api/geocode/json?latlng=",l=b+","+c;e.get(k+l).success(function(b){d=b.results[0],angular.forEach(d.address_components,function(a){f=a.types[0],"street_number"===f?h=a.short_name:"route"===f?i=a.short_name:"postal_code"===f&&(j=a.short_name)}),g="undefined"!=typeof h&&"undefined"!=typeof i&&"undefined"!=typeof j?h+" "+i+", "+j:d.formatted_address,a.setAddress("Near "+g),a.trackGeolocationClick(g),a.currentlyLocating=!1,a.hasMessage=!1}).error(function(){a.handleGeolocationError()})},a.launchErrorModal=function(a){var b="undefined"!=typeof g.getTop();b||f.open({template:'<div class="geolocation-error-modal"><div class="modal-header"><button type="button" class="close" ng-click="$dismiss(\'close\')" aria-hidden="true">&times;</button></div><div class="modal-body">'+a+'</div><div class="modal-footer"><div><a ng-click="$dismiss(\'footer close\')" class="button primary">Ok</a></div></div></div>',windowClass:"geolocation-error-modal",size:"sm"})},a.trackGeolocationClick=function(a){var c;c=b.matchMedia.small?"desktop":b.matchMedia.smallPortrait?"tablet":"mobile",d.dataLayer.push({event:"HomePageAction",eventCategory:"Geolocation",eventAction:"Clicked",eventLabel:a+" - "+c})}}],link:function(a,b,c,d){a.setAddress=function(a){d.setAddress(a),d.setGeolocated(!0)},a.arrowHover=function(){!a.successGeolocation&&a.$root.matchMedia.small&&(a.userMessage="Use Current Location",a.hasMessage=!0)},a.arrowLeave=function(){a.currentlyLocating||(a.hasMessage=!1)},a.handleGeolocationError=function(b){var c={access_denied:"You have denied access to use your current location.",location_error:"We couldn't detect your location. Please enter your address manually.",not_supported:"Geolocation is not supported by this browser. Please enter your address manually."};b.code?1===b.code?(a.launchErrorModal(c.access_denied),a.trackGeolocationClick("Failed - User denied access")):(a.launchErrorModal(c.location_error),a.trackGeolocationClick("Failed - Timeout or satellite not available")):"geolocation not supported"===b?(a.launchErrorModal(c.not_supported),a.trackGeolocationClick("Failed - Geolocation not supported")):(a.launchErrorModal(c.location_error),a.trackGeolocationClick("Failed - Unsuccessful request for address after geolocation")),a.currentlyLocating=!1,a.hasMessage=!1},a.$watch("hasMessage",function(a,b){b!==a&&(a===!0?d.shortenPlaceholderAddress():a===!1&&d.revertPlaceholderAddress())})}}}]).directive("dcomAddressSearchAutocomplete",["$location","$rootScope","SearchLocation","Group","MerchantSearch","$window","LocationAPI",function(a,b,c,d,e,f){return f.dataLayer=f.dataLayer||[],b.search=c.isSet()?{query:c.get().query}:{query:""},{template:'<label for="{{searchInputId}}" ng-show="searchLabel" class="search-label">{{searchLabel}}</label><input ng-click="forceFocus($event)" ng-keydown="keyDown($event)" ng-class="{\'with-label\':searchLabel}" id="{{searchInputId}}" type="search" placeholder="{{placeholder}}" autocomplete="off" ng-model="searchDirectiveModel" ng-change="removeRequiredMessage()" tabindex="{{::tabIndex}}"><div class="address-required-message" ng-class="noAddressSubmit && !searchDirectiveModel.length ? \'active\' : \'\'"><span>Please enter your address</span></div>',restrict:"A",require:"^dcomAddressSearch",scope:{placeholder:"@",searchDirectiveModel:"=ngModel",searchInputId:"@",searchHandler:"=",searchLabel:"@",hasDropdown:"=",suppressAutomaticSearch:"=",value:"@",noAddressSubmit:"=",tabIndex:"@"},controller:["$scope","$element","$timeout",function(a,b,c){a.removeRequiredMessage=function(){a.noAddressSubmit&&a.searchDirectiveModel.length&&(a.noAddressSubmit=!1)},a.redirectToSearch=function(){a.removeAutocompleteList(),c(function(){a.search()},100)};var d={componentRestrictions:{country:"us"},types:["geocode"]};a.initializeGoogleMapsAutocomplete=function(){function e(){var b;b=new google.maps.places.Autocomplete(i,d),google.maps.event.addListener(b,"place_changed",function(){if(b){if(b.getPlace().address_components){var d=i.value;a.$apply(function(){a.searchDirectiveModel=d})}a.suppressAutomaticSearch?c(function(){a.removeAutocompleteList()},100):(a.redirectToSearch(),a.$apply())}})}var g,h=[],i=b[0].querySelector("input[type=search]")||b[0].querySelector("input[type=text]");"object"==typeof google&&"object"==typeof google.maps?e():angular.element(i).bind("focus",function(){"undefined"==typeof f.onGoogleMapsLoad&&(f.onGoogleMapsLoad=function(){var a;for(a=0;a<h.length;a++)h[a]()}),h.push(e),null===document.getElementById("google-maps-script")&&(g=document.createElement("script"),g.id="google-maps-script",g.type="text/javascript",g.src="https://maps.googleapis.com/maps/api/js?v=3.exp&sensor=false&libraries=places&callback=onGoogleMapsLoad",document.body.appendChild(g))})}}],link:function(a,b,c,d){function e(){var a=b[0].querySelector("input[type=search]")||b[0].querySelector("input[type=text]");angular.element(a).unbind("focus")}function f(a){for(var b=0;b<a.length;b++)if("none"!==a[b].style.display)return!0;return!1}a.$watch("hasDropdown",function(b,c){c!==b&&(b===!0?e():b===!1&&a.initializeGoogleMapsAutocomplete())}),a.search=function(){d.searchSubmit()},a.removeAutocompleteList=function(){var a,b,c=document.getElementsByClassName("pac-container");if(c.length)for(a=c.length-1;a>=0;a--)b=c[a],b.parentNode.removeChild(b)},a.keyDown=function(b){var c=document.getElementsByClassName("pac-container");return a.suppressAutomaticSearch?void(13===b.keyCode?(b.preventDefault(),c.length&&f(c)?a.removeAutocompleteList():a.redirectToSearch()):c.length||a.initializeGoogleMapsAutocomplete()):(13===b.keyCode||c.length||a.initializeGoogleMapsAutocomplete(),void(13===b.keyCode&&b.preventDefault()))},a.forceFocus=function(a){a.stopPropagation(),a.currentTarget.focus()},a.initializeGoogleMapsAutocomplete()}}}]).directive("dcomItemSearch",["$location","$rootScope","Group","$window","$timeout",function(a,b,c,d,e){return d.dataLayer=d.dataLayer||[],{template:'<input type="text" dcom-search-suggest="{{itemKeyword}}" data-in-focus="{{inFocus}}" data-current-group="{{currentGroup}}" ng-model="itemKeyword" ng-blur="focusOut()" ng-keyup="submitOnEnter($event)" class="main-item-search" placeholder="{{currentGroup === \'f\' ? \'Food or place (Optional)\' : \'Item or place (Optional)\'}}" tabindex="{{::tabIndex}}"><span class="icon-search"> </span>',restrict:"A",require:"^dcomAddressSearch",scope:{ngModel:"=",currentGroup:"@",tabIndex:"@"},controller:["$scope","$element","$window",function(a){a.inFocus=!0}],link:function(a,b,c,d){var f=function(){d.setItemKeyword(a.itemKeyword)};a.submitOnEnter=function(b){13===b.keyCode&&(b.preventDefault(),e(function(){d.redirectToSearch()})),a.inFocus=!0},a.focusOut=function(){e(function(){a.inFocus=!1},300)},a.$watch("itemKeyword",function(a,b){a!==b&&f(a)})}}}]),angular.module("dcomApp").directive("dcomBannerAds",["$rootScope","$location","$window",function(a,b,c){return{restrict:"A",template:'<div ng-if="bannerAds.length" class="tag">Sponsored</div><a href="{{merchant.summary.merchantUrl}}" ng-click="trackBannerClick(merchant)" class="banner-ad-container" ng-repeat="merchant in bannerAds"><div ng-if="merchant.ordering.highestDiscount" class="discount">{{merchant.ordering.highestDiscount}}% off</div><div ng-if="merchant.ordering.highestDiscount" class="discount-corner"></div><div class="banner-ad"><img ng-src="{{merchant.summary.banner_ad.url}}"></div><div class="merchant-info"><p class="merchant">{{merchant.summary.name}}</p><div class="order-now">Order now</div></div><p class="cuisines">{{merchant.summary.cuisines.join(\', \')}}</p></a>',scope:{merchantsWithBanners:"=",selectedSponsor:"="},controller:["$scope",function(d){function e(a){if(a.length>0){var b=[],c=[],e=[0,5,4,3,2,1];angular.forEach(a,function(a){for(var c=e[a.summary.banner_ad.priority],d=0;c>d;d++)b.push(a)});for(var f,g,h=!1,i=a.length<=2?a.length:2;!h;)g=Math.floor(Math.random()*b.length),f=b[g],-1===c.indexOf(f)&&(c.push(f),d.trackBannerShown(f)),c.length===i&&(h=!0);return c}return[]}function f(a){c.dataLayer.push({event:"bannerAdClicked",merchant_id:a.id,merchant_name:a.summary.url.short_tag})}function g(a){c.dataLayer.push({event:"bannerAdShown",merchant_id:a.id,merchant_name:a.summary.url.short_tag})}c.dataLayer=c.dataLayer||[],d.bannerAds=[],d.trackBannerClick=f,d.trackBannerShown=g,d.$watch(function(){return d.selectedSponsor},function(c,f){angular.isDefined(d.merchantsWithBanners)&&c!==f&&"/search"===b.path().substring(0,7)&&a.matchMedia.small&&(d.bannerAds=e(d.merchantsWithBanners))})}]}}]),angular.module("dcomApp").directive("dcomBlurOnSubmit",function(){return{restrict:"A",template:'<form ng-transclude ng-submit="closeKeyboard()"></form>',transclude:!0,link:function(a,b){a.closeKeyboard=function(){b[0].childNodes[0][0].blur()}}}}),angular.module("dcomApp").directive("dcomCardType",function(){return{restrict:"A",template:'<span class="dcom-card-type">	<span class="visa" ng-class="{\'card-inactive\':notActive(\'visa\')}"></span> 	<span class="mastercard" ng-class="{\'card-inactive\':notActive(\'mastercard\')}"></span> 	<span class="amex" ng-class="{\'card-inactive\':notActive(\'amex\')}"></span> 	<span class="discover" ng-class="{\'card-inactive\':notActive(\'discover\')}"></span> 	<span class="secure"></span></span>',scope:{dcomCardType:"@"},link:function(a,b,c){var d=function(a){var b=null,c={visa:/^4[0-9]/,mastercard:/^5[1-5]/,amex:/^3[47]/,discover:/^6(?:011|5[0-9]{2})/};return angular.forEach(c,function(c,d){a.match(c)&&(b=d)},this),b};a.notActive=function(b){return b!==a.highlightCard&&null!==a.highlightCard?!0:!1},c.$observe("dcomCardType",function(){a.highlightCard=d(a.dcomCardType)})}}}),angular.module("dcomApp").directive("dcomCartItems",["$compile","Cookies",function(){return{template:'<div ng-repeat="item in cartInfo.cart" class="cart-item"><span class="name" ng-bind-html="item.name"></span><span class="controls"><a ng-click="deleteItem(item)" class="delete"><span class="icon-trash">delete</span></a><a ng-click="edit(item)" class="edit"><span class="icon-pencil">edit</span></a></span></div>',restrict:"A",controller:["$modal","$scope","$routeParams","MerchantAPI","CartProvider",function(a,b,c,d,e){b.deleteItem=function(d){var f=b;a.open({templateUrl:"views/modals/deleteCartItemConfirm.html",controller:["$scope",function(a){var b=e.get(c.merchantId);a.deleteItem=function(){a.$dismiss(),b.remove(d.item_key).then(function(){var a=b.getInfo(),c=b.getItems();f.cartInfo.subtotal=a.subtotal,f.cartInfo.tax=a.tax,f.cartInfo.item_count=a.item_count,f.cartInfo.cart=c},function(){b.reload().then(function(a){f.cartInfo=a})})}}]})},b.edit=function(a){d.getItem(c.merchantId,a).then(function(c){function d(a,b){var c,e,f;if(a)for(c=0;c<a.length;c++)if(a[c].options)for(e=0;e<a[c].options.length;e++)f=a[c].options[e],b[f.id]=parseFloat(f.quantity),f.options&&f.options.length>0&&d(f.options,b)}function e(a,b){function c(a){var b,d,g,h;for(b=0;b<a.length;b++)for(g=a[b],d=0;d<g.children.length;d++)h=g.children[d],e[h.id]>0&&(1===parseFloat(g.min_selection)&&1===parseFloat(g.max_selection)?f.optionGroup[g.id]=h.id:(f.optionGroup[g.id]=f.optionGroup[g.id]||{},f.optionGroup[g.id][h.id]=h.max_qty?e[h.id]:!0)),h.children&&h.children.length>0&&c(h.children)}var e={},f={cartKey:a.item_key,optionGroup:{},itemQty:parseFloat(a.quantity),specialInstructions:a.instructions};return d(a.options,e),c(b.children),f}b.activeItemEdit=c.item[0],b.activeItemEdit.cartIndex=a.item_key,b.activeItemEditForm=e(a,c.item[0]),b.header.text="Edit "+a.name,b.header.backAction=function(){b.activeItemEdit=null,b.activeItemEditForm=null,b.header.text="Checkout",b.header.backAction=null}})}}]}}]),angular.module("dcomApp").directive("dcomOrderConf",["$modal","OrderAPI",function(){return{link:function(a){a.postOrderSteps=[{text:"The merchant confirms your order",iconClassName:"icon-order-confirmation"},{text:"The order is prepared for delivery pickup",iconClassName:"icon-burger-soda"},{text:"You sign for it and enjoy",iconClassName:"icon-delivery-guy"}],a.currItem=0,a.currentStep=a.postOrderSteps[a.currItem].text,a.currentIcon=a.postOrderSteps[a.currItem].iconClassName,a.nextSlide=function(){a.currItem<a.postOrderSteps.length-1&&a.currItem++,a.currentStep=a.postOrderSteps[a.currItem].text,a.currentIcon=a.postOrderSteps[a.currItem].iconClassName},a.prevSlide=function(){a.currItem>0&&a.currItem--,a.currentStep=a.postOrderSteps[a.currItem].text,a.currentIcon=a.postOrderSteps[a.currItem].iconClassName}}}}]),angular.module("dcomApp").directive("dcomRating",["Group",function(){return{restrict:"A",scope:{rating:"@",votes:"@"},link:function(a,b){var c=function(){if(a.rating){var c=a.rating,d=Math.floor(a.rating),e=2*(c-d),f=5-d-e;if(angular.isDefined(a.votes)&&0===a.votes)return;for(var g=0;d>g;g++)b.append(0===e?'<span class="icon-star"></span>':'<span class="icon-star half-offset"></span>');for(var h=0;e>h;h++)b.append('<span class="icon-half-star half-offset"></span><span class="icon-star grey"></span>');for(var i=0;f>i;i++)b.append('<span class="icon-star grey"></span>');angular.isDefined(a.votes)&&b.append('<span class="votes">('+a.votes+")</span>")}};a.$watch(function(){return a.rating},function(){c()})}}}]),angular.module("dcomApp").directive("dcomProcessing",function(){return{restrict:"A",template:'<span ng-transclude class="contents"></span><span class="spinner"></span>',transclude:!0,link:function(a,b,c){c.$observe("dcomProcessing",function(a){"true"===a?b.addClass("processing"):b.removeClass("processing")})}}}),angular.module("dcomApp").directive("dcomDishRecommendation",function(){return{restrict:"E",templateUrl:"views/partials/dishRecommendation.html",scope:{data:"=",recIndex:"="},controller:"DishRecommendationCtrl"}}),angular.module("dcomApp").directive("dcomFocusThis",["$timeout",function(a){return{restrict:"A",scope:{trigger:"@dcomFocusThis",focusOnToggle:"="},link:function(b,c){var d=c[0];b.$watch("trigger",function(b,c){a(function(){b!==c&&d.focus()})}),b.$watch("focusOnToggle",function(a,b){a!==b&&d.focus()})}}}]),angular.module("dcomApp").directive("dcomOrderTime",["$compile","$rootScope","$window","$q","$modal","Merchant","CartAPI","CartProvider","Cookies","MerchantSearch","SearchLocation","ScheduleProvider","Group",function(a,b,c,d,e,f,g,h,i,j,k,l,m){return{restrict:"A",template:'<div ng-if="cartLoaded" ng-hide="editOrderTime" ng-click="showOrderOptions()" class="current-order-time"><span class="time"><strong class="capitalize">{{selectedOrderType}}</strong> for <strong>{{selectedOrderDate}}</strong> at <strong>{{selectedOrderTime}}</strong> <span class="icon-pencil"></span></span></div><div class="order-time-menu" ng-show="editOrderTime"><select ng-change="toggleOrderType()" id="orderTypeMenu" data-ng-model="orderType" data-ng-options="option for option in ::orderOptions"></select><select id="orderDateMenu" ng-change="getAvailableTimes(orderDate)" data-ng-model="orderDate" data-ng-options="option.value as option.name for option in ::orderDateOptions"></select><select id="orderTimeMenu" data-ng-model="orderTime" id="dynamic_times" data-ng-options="option for option in ::orderTimeOptions"></select><a dcom-processing="{{processing}}" ng-class="{\'disabled\' : processingDisabled}" class="button primary" ng-click="updateOrderType()"><span class="cta">Update</span></a><span class="cancel" ng-click="toggleTimeDisplay(false)"></span></div>',scope:{orderType:"=ngModel",futureOrdersDisplay:"="},controller:["$scope","$routeParams",function(a,d){function e(b,c){a.orderableTimes=j.getOrderableTimes(a.merchantId),a.cartLoaded===!1?"undefined"!=typeof a.orderableTimes&&null!==a.orderableTimes&&(a.cartLoaded=!0,a.nextAvailable=a.orderableTimes[0],a.getDefaultType(),a.getAvailableDates(c)):b&&(a.selectedOrderType=j.getOrderType(a.merchantId),a.orderType=a.selectedOrderType)}function g(b,c,d){a.merchantInfo=b.merchant,a.merchantId=a.merchantInfo.id,a.cartLoaded=!1,a.lastValidTime=Date.create(j.getOrderTime(a.merchantId)),a.orderOptions=j.getOrderableTypes(a.merchantInfo),d?e(!0,!0):a.$on("cartChange",function(a,b){var c=angular.isDefined(b)&&"orderType"===b.change;
e(c)})}function h(b,c){var d=f.getFromCache();if(d){var e=d;g(e.merchant_data,b,c)}else a.$on("merchantInfoLoaded",function(a,d){g(d,b,c)})}c.dataLayer=c.dataLayer||[],a.windowDataLayer=c.dataLayer;var j=l.set(a.futureOrdersDisplay);a.merchantId=d.urlStub,!angular.isDefined(a.merchantId)&&angular.isDefined(d.merchantId)&&(a.merchantId=d.merchantId),a.orderOptions=[],a.orderDateOptions=[],a.orderTimeOptions=[],a.nextAvailable="",a.dateFormat="{Dow} {MM}/{dd}/{yyyy}",a.timeFormat="{12hr}:{mm}{tt}",a.processing=!1,a.asapAvailable=function(){var b=!0;return"menu"===a.futureOrdersDisplay&&("delivery"===a.orderType?b=null===a.merchantInfo.ordering.availability.next_delivery_time:"pickup"===a.orderType&&(b=null===a.merchantInfo.ordering.availability.next_pickup_time)),b},a.timeInSchedule=function(b){if("ASAP"!==b){for(var c=[],d=Date.create(b),e=d.format(a.dateFormat),f=d.format(a.timeFormat),g=0;g<a.orderableTimes.length;g++){var h=Date.create(a.orderableTimes[g]);h.format(a.dateFormat)===e&&c.push(h.format(a.timeFormat))}return-1!==c.indexOf(f)?!0:void 0}},a.currentOrderTime=function(){var b=!1,c=i.getCookie(a.merchantId+"_orderTime"),d=i.getCookie("globalOrderTime"),e=Date.create(c),f=Date.create(a.orderableTimes[0]);return d&&(a.asapAvailable()||a.timeInSchedule(d))?b=a.timeInSchedule(d)||"ASAP"===d?d:c&&!e.isBefore(f)?c:a.asapAvailable()?"ASAP":a.orderableTimes[0]:"menu"===a.futureOrdersDisplay?b=c&&e.isAfter(f)?c:a.asapAvailable()?"ASAP":a.orderableTimes[0]:"search"===a.futureOrdersDisplay&&(b="ASAP"),j.setOrderTime(b,a.merchantId),b},a.getDefaultType=function(){var b=a.orderOptions;"menu"===a.futureOrdersDisplay?a.merchantInfo.ordering.availability.delivery?a.defaultOption="delivery":a.merchantInfo.ordering.availability.pickup?a.defaultOption="pickup":-1!==b.indexOf("delivery")?a.defaultOption="delivery":-1!==b.indexOf("pickup")&&(a.defaultOption="pickup"):"search"===a.futureOrdersDisplay&&(a.defaultOption="delivery");var c="",d=i.getCookie("globalOrderType");d&&-1!==b.indexOf(d)?(j.setOrderType(d,a.merchantId),c=d):c=j.getOrderType(a.merchantId),"undefined"==typeof c?(j.setOrderType(a.defaultOption,a.merchantId),a.selectedOrderType=a.defaultOption):a.selectedOrderType=c,a.orderType=a.selectedOrderType},a.getAvailableDates=function(b){var c=[];a.orderDateOptions=[],a.orderTimeOptions=[];for(var d,e,f=0;f<a.orderableTimes.length;f++){var g=Date.create(a.orderableTimes[f]).format(a.dateFormat);d={name:g,value:g},e=a.datesAvailableVals(c),-1===e.indexOf(d.value)&&c.push(d)}var h=Date.create().format(a.dateFormat);if(a.asapAvailable()&&c[0].value!==h?(d={name:"Today",value:h},c.unshift(d)):c[0].value===h&&(c[0].name="Today"),a.orderDateOptions=c,"undefined"==typeof a.orderDate||b){var i=a.currentOrderTime();if(i){var j=Date.create(i).format(a.dateFormat),k=a.datesAvailableVals(a.orderDateOptions).indexOf(j);a.orderDate=-1!==k?a.orderDateOptions[k]:a.orderDateOptions[0],a.cartLoaded||"ASAP"===i&&(a.orderDate=a.orderDateOptions[0])}else i||(a.orderDate=a.orderDateOptions[0]);a.selectedOrderDate=a.orderDate.name,a.orderDate=a.orderDate.value}else-1===a.datesAvailableVals(a.orderDateOptions).indexOf(a.orderDate)&&(a.orderDate=a.orderDateOptions[0],a.orderDate=a.orderDate.value),a.selectedOrderDate=a.orderDate;a.selectedOrderDate===h&&(a.selectedOrderDate="Today"),a.getAvailableTimes(a.orderDate)},a.getAvailableTimes=function(b){var c=[],d=Date.create(b);"menu"===a.futureOrdersDisplay?d.is("today")&&a.asapAvailable()&&c.push("ASAP"):"search"===a.futureOrdersDisplay&&d.is("today")&&c.push("ASAP");for(var e=Date.create(),f=0;f<a.orderableTimes.length;f++){var g=Date.create(a.orderableTimes[f]);g.format(a.dateFormat)===b&&g.isAfter(e)&&c.push(g.format(a.timeFormat))}a.orderTimeOptions=c;var h=a.currentOrderTime(),i=Date.create(h).format(a.timeFormat);h?(a.orderTime=-1===a.orderTimeOptions.indexOf(i)?a.orderTimeOptions[0]:i,a.cartLoaded&&"search"!==a.futureOrdersDisplay||"ASAP"===h&&d.is("today")&&(a.orderTime="ASAP")):-1===a.orderTimeOptions.indexOf(a.orderTime)&&(a.orderTime=a.orderTimeOptions[0]),"undefined"==typeof h&&("ASAP"===a.orderTime?j.setOrderTime(a.orderTime,a.merchantId):j.setOrderTime(a.nextAvailable,a.merchantId)),a.selectedOrderTime=a.orderTime},a.datesAvailableVals=function(a){var b=a.map(function(a){return a.value});return b},"menu"===a.futureOrdersDisplay?(a.$watch(function(){return b.matchMedia.small},function(a,b){if(a===!1&&b===!0){var c=d.urlStub;!c&&angular.isDefined(d.merchantId)&&(c=d.merchantId),h(c,!0)}}),b.matchMedia.small||h(a.merchantId,!1)):"search"===a.futureOrdersDisplay&&(a.cartLoaded=!0,a.orderableTimes=j.getOrderableTimes(),a.nextAvailable=a.orderableTimes[0],a.orderOptions=j.getOrderableTypes(),a.getDefaultType(),a.getAvailableDates())}],link:function(a){function c(b){if(a.processing=!1,b.message.length>0){var c=h.get(a.merchantId);d.setOrderTime(a.lastValidTime,a.merchantId),e.open({templateUrl:"views/modals/itemsUnavailable.html",windowClass:"invalid-items-modal",resolve:{update_order_type:function(){return a.updateOrderType},merchant_id:function(){return a.merchantId},merchant_name:function(){return a.merchantInfo.summary.name},current_group:function(){return m.currentGroup()},order_type:function(){return a.orderType},item_info:function(){return b.message},reset_time:function(){return a.hideOrderOptions},toggle_display:function(){return a.toggleTimeDisplay},cart:function(){return c},data:function(){return b}},controller:["$scope","$window","update_order_type","merchant_id","merchant_name","current_group","order_type","item_info","reset_time","toggle_display","cart","data",function(a,b,c,e,f,g,h,i,j,k,m,n){function o(c,d,e){for(var i=[],j=0;j<d.length;j++)i.push(d[j].item_name);b.dataLayer.push({event:"OrderAction",eventCategory:"Merchant",eventAction:"Bag and item conflict",eventLabel:g+" - "+f+" : "+h+" : "+e.format(a.dateFormat+" "+a.timeFormat)+" : "+i.join(", "),eventValue:i.length})}function p(a){b.dataLayer.push({event:"OrderAction",eventCategory:"Merchant",eventAction:"Bag and item conflict resolved",eventLabel:a})}a.updateOrderType=c,a.merchantId=e,a.merchant_name=f,a.current_group=g,a.order_type=h,a.itemInfo=i,a.resetTime=j,a.toggleDisplay=k,a.dateFormat="{dow} {month} {ord}",a.timeFormat="{12hr}:{mm}{tt}",a.invalidTime=Date.create(n.order_time),b.dataLayer=b.dataLayer||[];var q=Date.create();a.displayDate=a.invalidTime.format(a.dateFormat)===q.format(a.dateFormat)?"Today":a.invalidTime.format(a.dateFormat),a.displayTime=n.asap===!0?"ASAP":a.invalidTime.format(a.timeFormat),o(a.merchantId,a.itemInfo,a.invalidTime),a.removeItems=function(){a.processing=!0;for(var b=[],c=0;c<i.length;c++)b.push(i[c].item_key);var e=l.set("search");e.setOrderTime(a.invalidTime),d.setOrderTime(a.invalidTime,a.merchantId).then(function(){m.remove(b.join()).then(function(){a.resetTime(),a.updateOrderType(),a.processing=!1,a.toggleDisplay(!1),a.closeModal()})}),p("remove items")},a.cancel=function(){a.closeModal(),a.resetTime(),a.toggleDisplay(!0),p("choose new time")},a.closeModal=function(){a.$dismiss(),angular.element(document.getElementById("content-overlay")).remove()},a.modalCtrl=a}]})}else{var f=Date.create(a.orderDate).format("{yyyy}-{MM}-{dd}"),g="";if("ASAP"===a.orderTime)g="ASAP";else{var i=Date.create(a.orderTime).format("{HH}:{mm}:{ss}");g=Date.create(f+"T"+i)}a.lastValidTime=g,angular.element(document.getElementById("content-overlay")).remove();var j=l.set("search");j.setOrderTime(g),a.selectedOrderType=a.orderType,a.getAvailableDates(),a.toggleTimeDisplay(!1)}}var d=l.set(a.futureOrdersDisplay);a.showOrderOptions=function(){-1===a.orderTimeOptions.indexOf(a.orderTime)&&(a.orderTime=a.orderTimeOptions[0]),a.toggleTimeDisplay(!0)},a.toggleTimeDisplay=function(b){a.editOrderTime=b;var c=document.getElementsByClassName("sub-navigation-wrapper")[0];b?angular.element(c).addClass("stretch"):angular.element(c).removeClass("stretch")},a.hideOrderOptions=function(){a.orderType=d.getOrderType(a.merchantId),a.getTime=d.getOrderTime(a.merchantId),"ASAP"===a.getTime?(a.orderDate=Date.create().format(a.dateFormat),a.orderTime="ASAP"):(a.orderDate=Date.create(a.getTime).format(a.dateFormat),a.orderTime=Date.create(a.getTime).format(a.timeFormat)),a.selectedOrderType=a.orderType,a.orderableTimes=d.getOrderableTimes(a.merchantId),a.getAvailableDates(a.orderableTimes)},a.toggleOrderType=function(){if("menu"===a.futureOrdersDisplay){for(var b=document.getElementsByClassName("order-time-menu")[0].getElementsByTagName("select"),c=0;c<b.length;c++)angular.element(b[c]).addClass("disable-field"),b[c].disabled=!0;a.processingDisabled=!0;var e=d.getOrderTime(a.merchantId)?d.getOrderTime(a.merchantId):a.nextAvailable;g.getCart({merchant:a.merchantId,orderType:a.orderType,orderTime:e}).then(function(c){a.orderableTimes=c.orderable_times,a.getAvailableDates();for(var d=0;d<b.length;d++)angular.element(b[d]).removeClass("disable-field"),b[d].disabled=!1;a.processingDisabled=!1})}},a.trackOrderType=function(b){var c="search"===b?"Search Results":"Merchant";a.windowDataLayer.push({event:"Change Order Type",eventCategory:c,eventAction:"Change type",eventLabel:a.orderType})},a.updateOrderType=function(){angular.element(document.getElementById("site-wrapper")).append('<div class="content-overlay" id="content-overlay"></div>'),a.processing=!0;var e=Date.create(a.orderDate).format("{yyyy}-{MM}-{dd}"),f="";if("ASAP"===a.orderTime)f="ASAP";else{var g=Date.create(a.orderTime).format("{HH}:{mm}:{ss}");f=Date.create(e+"T"+g)}if(d.setOrderType(a.orderType,a.merchantId),a.trackOrderType(a.futureOrdersDisplay),d.setOrderTime(f,a.merchantId).then(function(){"search"===a.futureOrdersDisplay&&(d.setOrderTime(f),d.setOrderType(a.orderType,a.merchantId),a.processing=!1,angular.element(document.getElementById("content-overlay")).remove(),b.$broadcast("resultsChange"),a.selectedOrderType=a.orderType,a.getAvailableDates())}),"menu"===a.futureOrdersDisplay)var i=a.$on("cartChange",function(){var b=h.get(a.merchantId);i(),i=null,b.reload().then(function(a){c(a)})})}}}}]),angular.module("dcomApp").directive("dcomGetDimensions",["$rootScope","$window","$timeout",function(a,b,c){return{restrict:"A",link:function(a,d,e){function f(a){a&&a({width:d[0].clientWidth,height:d[0].clientHeight})}function g(a){i||(i=!0,b.requestAnimationFrame(function(){f(a),i=!1}))}function h(c){function d(){g(c)}b.addEventListener("resize",d),a.$on("$destroy",function(){b.removeEventListener("resize",d)})}var i=!1,j=a[e.resize],k=a[e.dcomGetDimensions];j&&h(j),c(function(){f(k)})}}}]),angular.module("dcomApp").directive("dcomLaundryPriceCompare",function(){return{restrict:"E",templateUrl:"views/partials/laundryPriceCompareLarge.html",controller:"LaundryPriceCompareCtrl"}});var dcom=dcom||{};dcom.menuUtils={optionsQuantity:function(a){var b,c=0;if(a){if("object"!=typeof a)return 1;for(b in a)a[b]===!0?c++:parseFloat(a[b])&&(c+=parseFloat(a[b]))}return c},itemWarnings:function(a,b){var c,d;if(a&&b)for(c=0;c<b.length;c++)for(d=0;d<b[c].items.length;d++)if(b[c].items[d]===a)return b[c].type;return""}},angular.module("dcomApp").directive("dcomPopularItems",["$compile","$timeout","JqliteHelper","PopularItemsProvider",function(a,b,c){return{template:'<div id="popularItems" ng-show="hasPopularItems" data-item-warnings="{{getWarnings(menuSection.id, warnings)}}" class="menu-section" ng-init="getPopularItems()"><header ng-click="toggleContent($event)"><h3><span class="icon-star"></span>  Popular Items</h3></header><div class="menu-section-content"><div class="menu-section-content-inner-wrapper"><div ng-repeat="popularItem in popularItems" ng-class="{\'first\': $first, \'last\': $last}" ng-class-even="\'even\'" ng-class-odd="\'odd\'" class="type-{{popularItem.type}}"><div dcom-menu-item="popularItem"  ng-class="{\'unavailable\': notAvailable(popularItem)}" data-click-handler="itemClick(item)" data-item-warnings="{{getWarnings(item.id, warnings)}}" data-order-time="orderTime" data-schedule="schedule" class="menu-item-wrapper index-{{$index}}" ng-click="gaTrack(popularItem)"></div></div></div></div></div>',replace:!0,restrict:"E",scope:{menu:"=dcomMenu",popularItemsList:"=dcomPopularItemsList",itemClick:"=",orderTime:"=",schedule:"=",warnings:"="},controller:["$scope","MenuSchedules","DateService",function(a){a.getPopularItems=function(){b(function(){if(a.popularItems=a.popularItemsList.getItems(),a.popularItems.length>0){a.hasPopularItems=!0;for(var b=a.popularItems.length,c=0;b>c;c++){var d=a.popularItems[c];d.schedule||(d.schedule=d.parentMenuSection.schedule)}}else a.hasPopularItems=!1})},a.getCurrentOrderTime=makeGetCurrentOrderTime(a),a.toggleContent=function(a){var b=c.closest(a.target,function(a){return"header"===a.tagName.toLowerCase()}),d=c.closest(b,function(a){return-1!==a.className.indexOf("menu-section")});angular.element(d).hasClass("collapsed")?angular.element(d).removeClass("collapsed"):angular.element(d).addClass("collapsed")},a.gaTrack=function(a){a.fromPopularModule=1},a.notAvailable=function(b){if("undefined"==typeof b)return!1;var c,d,e,f,g=a.getCurrentOrderTime().getTime(),h=a.schedule;if(h&&b.schedule&&b.schedule.length>0){for(c=0;c<b.schedule.length;c++)for(e=b.schedule[c],d=0;d<h.length;d++)if(e===h[d].id)for(f=0;f<h[d].times.length;f++)if(g>=Date.create(h[d].times[f].from)&&g<Date.create(h[d].times[f].to))return!1;return!0}return!1},a.getWarnings=dcom.menuUtils.itemWarnings}],compile:function(b){var c,d=b.contents().remove();return function(b,e){c||(c=a(d)),c(b,function(a){e.append(a)})}}}}]),angular.module("dcomApp").directive("dcomMenuSection",["$compile","JqliteHelper",function(a,b){return{replace:!0,restrict:"A",scope:{menuSection:"=dcomMenuSection",itemClick:"=",searchFilter:"=",orderTime:"=",schedule:"=",warnings:"=",menuSectionIndex:"=",parentSection:"="},controller:["$scope","$rootScope","MenuSchedules","DateService",function(a,c,d,e){function f(a){for(var b,c="<table>",d=0;d<a.length;d++)b=d%2!==0?'<tr class="odd"><td class="day">':'<tr><td class="day">',b+=a[d].day+'</td><td class="hours">'+a[d].hours+"</td></tr>",c+=b;return c+="</table>"}a.getCurrentOrderTime=makeGetCurrentOrderTime(a),a.toggleContent=function(a){var c=b.closest(a.target,function(a){return"header"===a.tagName.toLowerCase()}),d=b.closest(c,function(a){return-1!==a.className.indexOf("menu-section")});angular.element(d).hasClass("collapsed")?angular.element(d).removeClass("collapsed"):angular.element(d).addClass("collapsed")},a.setParentMenuSection=function(b){void 0!==a.parentSection&&(b.parentMenuSection=a.parentSection)},a.notAvailable=function(b){if("undefined"==typeof b)return!1;var c,d,f,g,h,i,j=a.getCurrentOrderTime().getTime(),k=a.schedule;if(k&&b.schedule&&b.schedule.length>0){for(c=0;c<b.schedule.length;c++)for(f=b.schedule[c],d=0;d<k.length;d++)if(f===k[d].id)for(g=0;g<k[d].times.length;g++)if(h=e.getStandardizedDate(k[d].times[g].from).getTime(),i=e.getStandardizedDate(k[d].times[g].to).getTime(),j>=h&&i>j)return!1;return!0}return!1},a.tooltipEnabled=function(){return c.matchMedia.small?!0:!1},a.getNextAvailableCopy=function(b){if("undefined"!=typeof b.schedule){for(var c,f,g,h=d.sortedRelativeSchedule(b.schedule[0],a.schedule),i=d.formatMenuSchedule(h),j=a.getCurrentOrderTime().getTime(),k=0;k<h.length;k++)if(g=e.getStandardizedDate(h[k].from),c=g.getTime(),c>=j){f=k;break}if("undefined"!=typeof f)return"Next available time: "+i[f].day+" "+i[f].hours}return"Not Available"},a.getTooltipSchedule=function(b){var c=d.sortedRelativeSchedule(b.schedule[0],a.schedule),e=d.formatMenuSchedule(c),g=f(e);return g},a.getWarnings=dcom.menuUtils.itemWarnings}],link:function(b,c){var d='<div ng-style="{ \'z-index\' : 20-menuSectionIndex }" ng-class="{\'unavailable\': notAvailable(menuSection) || notAvailable(parentSection), \'collapsed\': notAvailable(menuSection)}" data-item-warnings="{{getWarnings(menuSection.id, warnings)}}" class="menu-section" ng-init="setParentMenuSection(menuSection)"><header ng-click="toggleContent($event)"><h3 ng-bind-html="::menuSection.name"></h3><div ng-if="menuSection.description" class="description">{{ ::menuSection.description }}</div><div ng-if="notAvailable(menuSection) && !notAvailable(parentSection)" class="next-availability"><span ng-switch="tooltipEnabled()"><span class="icon-clock" ng-switch-when="true" tooltip-html-unsafe="<h5>Available Hours:</h5>{{::getTooltipSchedule(menuSection)}}" tooltip-placement="bottom" data-container="body"></span><span class="icon-clock" ng-switch-default></span></span> {{getNextAvailableCopy(menuSection)}}</div></header><div class="menu-section-content"><div class="menu-section-content-inner-wrapper"><div ng-repeat="child in menuSection.children | filter:searchFilter" ng-class="{\'first\': $first, \'last\': $last}" ng-class-even="\'even\'" ng-class-odd="\'odd\'" class="type-{{ ::child.type}}"><div ng-switch="child.type"><div ng-switch-when="menu" dcom-menu-section="::child" menu-section-index="$index" data-parent-section="menuSection" data-order-time="orderTime" data-search-filter="searchFilter" data-schedule="schedule" data-item-click="itemClick" data-warnings="warnings"></div><div ng-switch-when="item" dcom-menu-item="::child" data-parent-section="::menuSection" data-order-time="orderTime" ng-class="{\'unavailable\': notAvailable(child)}" data-click-handler="itemClick(item)" data-item-warnings="{{getWarnings(item.id, warnings)}}" data-schedule="schedule" class="menu-item-wrapper index-{{::$index}}"></div></div></div></div></div></div>',e=angular.element(d);a(e)(b),c.append(e)}}}]),angular.module("dcomApp").directive("dcomMenuItem",["$filter","Cookies","JqliteHelper","$rootScope","HammerEvents","PopularItemsProvider","$timeout",function(a,b,c,d,e,f){return{template:'<div ng-switch="tooltipEnabled()"><div ng-click="menuItemClick()" ng-switch-when="true" tooltip-html-unsafe="{{::getTooltip(item)}}" tooltip-placement="bottom" ng-class="{\'has-description\':item.description || notAvailable(dcomMenuItem), \'unavailable\': notAvailable(dcomMenuItem) || notAvailable(parentSection)}" class="menu-item" ng-click="gaTrack(item)"><div ng-if="item.popular_flag === true" class="popularFlagWrapper" ng-init="appendToPopularItems(item)"><div class="popularFlag"></div><span class="icon-star"></span></div><div ng-bind-html="item.name | highlightText:highlightText" class="name"></div><div class="price">{{::(item.price | currency)}}<span ng-if="item.max_price > item.price">+</span></div><div ng-if="item.description" class="description" ng-bind-html="item.description | highlightText:highlightText"></div></div><div ng-click="menuItemClick()" ng-switch-default  ng-class="{\'has-description\':item.description || notAvailable(dcomMenuItem), \'unavailable\': notAvailable(dcomMenuItem) || notAvailable(parentSection)}" class="menu-item" ng-click="gaTrack(item)"><div ng-if="item.popular_flag === true" class="popularFlagWrapper" ng-init="appendToPopularItems(item)"><div class="popularFlag"></div><span class="icon-star"></span></div><div ng-bind-html="item.name | highlightText:highlightText" class="name"></div><div class="price">{{::(item.price | currency)}}<span ng-if="item.max_price > item.price">+</span></div><div ng-hide="item.popular_flag" ng-if="item.description" class="description" ng-bind-html="item.description| highlightText:highlightText"></div><div ng-show="item.popular_flag" ng-if="notAvailable(dcomMenuItem)" class="next-availability">{{getNextAvailableCopy(dcomMenuItem)}}</div></div></div>',restrict:"A",scope:{dcomMenuItem:"=",clickHandler:"&",schedule:"=",orderTime:"=",highlightText:"@",parentSection:"="},controller:["$scope","$modal","MenuSchedules","DateService",function(a,c,e,g){a.appendToPopularItems=function(b){a.popularItemsInterface=f.getCurrentInterface(),a.parentSection&&(b.parentMenuSection=a.parentSection.parentMenuSection?a.parentSection.parentMenuSection:a.parentSection),a.popularItemsInterface.appendItem(b)},a.gaTrack=function(a){a.fromPopularModule=0},a.tooltipEnabled=function(){return d.matchMedia.small?a.notAvailable(a.dcomMenuItem)||a.notAvailable(a.parentSection)?!1:!0:!1},a.getCurrentOrderTime=makeGetCurrentOrderTime(a),a.warningModal=function(a,d){function e(e,f){c.open({templateUrl:e,controller:["$scope",function(c){c.next=function(){c.$dismiss(),b.setCookie("warningShown_"+a,"true",{expires:365}),d()}}],windowClass:f})}var f="views/modals/",g="";b.getCookie("warningShown_"+a)?d():"alcohol"===a||"tobacco"===a?(g="alcohol-tobacco-warning",e(f+a+"Warning.html",g)):d()},a.notAvailable=function(b){if("undefined"==typeof b)return!1;var c,d,e,f,h,i,j=a.getCurrentOrderTime().getTime(),k=a.schedule;if(k&&b.schedule&&b.schedule.length>0){for(c=0;c<b.schedule.length;c++)for(e=b.schedule[c],d=0;d<k.length;d++)if(e===k[d].id)for(f=0;f<k[d].times.length;f++)if(h=g.getStandardizedDate(k[d].times[f].from).getTime(),i=g.getStandardizedDate(k[d].times[f].to).getTime(),j>=h&&i>j)return!1;return!0}return!1},a.getNextAvailableCopy=function(b){if("undefined"!=typeof b.schedule){for(var c,d,f,h=e.sortedRelativeSchedule(b.schedule[0],a.schedule),i=e.formatMenuSchedule(h),j=a.getCurrentOrderTime().getTime(),k=0;k<h.length;k++)if(f=g.getStandardizedDate(h[k].from),c=f.getTime(),c>=j){d=k;break}if("undefined"!=typeof d)return"Next available: "+i[d].day+" "+i[d].hours}return"Not Available"}}],link:function(a,b){a.getCurrentOrderTime();a.item=a.dcomMenuItem,a.getTooltip=function(a){return a.description?a.description.length<130?a.description:a.description.substring(0,127)+"...":""},a.menuItemClick=function(){var d=c.closest(b[0],function(a){return angular.element(a).hasClass("unavailable")}),e=a.notAvailable(a.item);if(!d){var f=c.closest(b[0],function(a){return a.hasAttribute&&a.hasAttribute("data-item-warnings")&&""!==a.getAttribute("data-item-warnings")});if(""!==b.attr("data-item-warnings")||f||"popularItem"===b.attr("dcom-menu-item"))if("popularItem"!==b.attr("dcom-menu-item")||a.item.warnings){var g;if(g="popularItem"===b.attr("dcom-menu-item")?a.item.warnings:b.attr("data-item-warnings"),!g){var h=c.closest(b[0],function(a){return a.hasAttribute&&a.hasAttribute("data-item-warnings")&&""!==a.getAttribute("data-item-warnings")});g=angular.element(h).attr("data-item-warnings")}a.warningModal(g,function(){a.clickHandler({item:a.item,unavailable:e})})}else a.clickHandler({item:a.item,unavailable:e});else a.clickHandler({item:a.item,unavailable:e})}}}}}]),angular.module("dcomApp").directive("dcomItemOptionDisplay",function(){return{template:'<header class="active-item-header" ng-class="{\'has-shadow\': optionContentScrolledDown}"><h3 ng-bind-html="::item.name" class="name"></h3><div ng-hide="hasPriceGroup()" class="price">{{::(item.price | currency)}}</div></header><div class="item-option-content"><div ng-show="item.description" ng-bind-html="::item.description" class="description"></div><div ng-show="hasChildrenNotImages(item.children)" class="item-options"><div ng-repeat="optionGroup in ::item.children | filter:notAnImage" dcom-option-group="::optionGroup"></div></div><div class="form-field special-instructions"><textarea ng-model="itemForm.specialInstructions" id="special-instr" placeholder="Special instructions (optional)"></textarea></div><div ng-show="footerNotes" class="form-field footer-notes">{{::footerNotes}}</div></div><div class="action fixed-cta" onselectstart="return false"><div ng-show="!showWeightEstimate(item) && item.increment" class="form-field item-quantity"><span dcom-spinner data-id="item-quantity" ng-model="itemForm.itemQty" data-disable="{{!smallPortrait}}" data-min="item.min_qty" data-max="item.max_qty" data-step="item.increment" class="qty-spinner"></span></div><div ng-show="showWeightEstimate(item)" class="form-field item-quantity"><div class="weight-dropdown"><select data-id="item-weight" ng-model="itemForm.itemQty" ng-options="option.value as option.name for option in ::weightOptions"  class="lb-select"></select><span class="icon-down-arrow-thick lb-arrow"></span></div></div><a ng-click="cartAction()" ng-class="{disabled: !cartIsValid}" dcom-processing="{{processing}}" tooltip="{{requiredTooltip()}}" tooltip-placement="top" class="button primary"><span class="cta">{{ smallPortrait ? actionText : actionTextMobile }}</span><span ng-if="item.label !== \'wnf\'" class="item-total"><span class="label">Item total</span><span class="amount">{{ (itemForm.total | currency) }}</span></span></a></div>',restrict:"A",scope:{item:"=dcomItemOptionDisplay",action:"=",actionText:"=",actionTextMobile:"=",processing:"=",itemFormInit:"="},controller:["$modal","$modalStack","$scope","$rootScope","$window","$routeParams","$timeout","Group","DcomConfig",function(a,b,c,d,e,f,g,h,i){function j(){var a=80+c.modalHeader.clientHeight;c.optionContent.style.height=c.modalContent.clientHeight-a+"px",c.optionContentScrollHeight=c.optionContent.scrollHeight}function k(){function a(){return e>=b?c.maxModalHeight>b?!1:!0:!1}var b=c.modalContent.clientHeight,d=window.innerHeight||document.documentElement.clientHeight||document.getElementsByTagName("body")[0].clientHeight,e=d-70;c.smallPortrait&&!a()?(c.modalContent.style.height=e+"px",c.modalContent.style.minHeight="400px",0===c.item.children.length&&(c.modalContent.style.minHeight="245px",c.isSimpleModal&&(c.modalContent.style.height="245px"))):c.smallPortrait||(c.modalContent.style.height="100%",c.modalContent.style.minHeight=""),j(),c.optionContentScrollHeight=c.optionContent.scrollHeight}function l(){function a(a){var b=navigator.userAgent.toLowerCase(),d=b.indexOf("android")>-1||"android"===i.platform,e=window.innerHeight||document.documentElement.clientHeight||document.getElementsByTagName("body")[0].clientHeight;c.modalBackdrop.classList.add("extend-backdrop"),a!==c.specialInstructions&&(c.modalContent.style.maxHeight=e+"px",j()),a===c.specialInstructions&&d&&g(function(){c.optionContent.scrollTop=c.optionContent.scrollHeight},600)}function b(){c.modalContent.style.maxHeight="",window.scrollTo(0,c.scrollWindowHeightonModalOpen),g(function(){k()},300),c.optionContent.focus()}angular.element(c.optionContent).bind("scroll",function(){c.optionContentScrollTop=c.optionContent.scrollTop,c.$digest()}),angular.forEach([c.optionContent,c.modalContent,c.modalBody],function(a){var b=angular.element(a);b.bind("touchmove touchstart",function(a){a.stopPropagation()}),a!==c.optionContent?b.bind("touchmove",function(a){a.preventDefault()}):c.isSimpleModal&&b.bind("touchmove",function(a){a.preventDefault()})}),angular.element(c.optionContent).bind("click",function(){c.optionContent.scrollHeight>c.optionContentScrollHeight&&(c.modalContent.style.height="100%",c.optionContent.style.height="100%",c.modalContent.clientHeight>c.maxModalHeight&&(c.maxModalHeight=c.modalContent.clientHeight,k()))}),angular.forEach([c.lbSelect,c.specialInstructions],function(c){var d=angular.element(c);d.bind("touchmove touchstart",function(a){a.stopPropagation()}),d.bind("focus",function(){a(this)}),d.bind("blur",function(){b()})})}e.dataLayer=e.dataLayer||[],c.smallPortrait=d.matchMedia.smallPortrait,g(function(){var a=navigator.userAgent.toLowerCase(),b=a.indexOf("android")>-1||"android"===i.platform;c.modalContent=document.getElementsByClassName("modal-content")[0],c.modalBody=document.getElementsByClassName("modal-body")[0],c.modalBackdrop=document.getElementsByClassName("modal-backdrop")[0],c.optionContent=document.getElementsByClassName("item-option-content")[0],c.modalHeader=document.getElementsByClassName("active-item-header")[0],c.lbSelect=document.getElementsByClassName("lb-select")[0],c.specialInstructions=document.getElementById("special-instr"),d.matchMedia.smallPortrait&&(c.maxModalHeight=c.modalContent.clientHeight,0===c.item.children.length?(c.modalContent.style.minHeight="245px",0===c.item.description.length&&(c.isSimpleModal=!0,c.maxModalHeight=245,c.modalContent.style.height="245px")):c.modalContent.style.minHeight="400px"),b||(c.lbSelect.style.padding="5px"),c.scrollWindowHeightonModalOpen=window.scrollY||document.documentElement.scrollTop,c.optionContentScrollTop=c.optionContent.scrollTop,k(),c.optionContentScrollHeight=c.optionContent.scrollHeight,l()}),c.$watch("optionContentScrollTop",function(a){0===a?c.optionContentScrolledDown=!1:a>0&&(c.optionContentScrolledDown=!0)}),e.onresize=function(){"undefined"!=typeof b.getTop()&&(c.smallPortrait=d.matchMedia.smallPortrait,k(),c.$digest())};var m,n=h.currentGroup();g(function(){m=c.item.popular_flag===!0?c.item.fromPopularModule===!0?"View Popular Item - Popular Menu":"View Popular Item":"View Item",e.dataLayer.push({event:"OrderAction",eventCategory:"Merchant",eventAction:m,eventLabel:n+"-"+c.item.id+":"+c.item.name,ecommerce:{click:{actionField:{list:n+" Menu Display"},products:[{name:c.item.name,id:c.item.id,price:c.item.price}]}}}),Leanplum.track("Item clicked","Merchant Page",{vertical:n})});var o=100,p=5,q=25;c.weightOptions=[{value:1,name:"1 lb"}];for(var r=p;o>=r;r+=p)c.weightOptions.push({value:r,name:r+" lbs"});c.hasChildrenNotImages=function(a){var b;if(a)for(b=0;b<a.length;b++)if(c.notAnImage(a[b]))return!0;return!1},c.showWeightEstimate=function(a){return"l"===n&&a.label?"wnf"===a.label.toLowerCase():!1},c.notAnImage=function(a){return"image"!==a.type},c.hasPriceGroup=function(){var a,b;if(c.item&&c.item.children)for(b=c.item.children,a=0;a<b.length;a++)if("price group"===b[a].type)return!0;return!1},c.cartAction=function(){if(c.cartIsValid&&!c.processingAddToCart){var a,b,d,f=c.itemForm.optionGroup,g={};c.processing=!0;for(a in f)if("object"!=typeof f[a])g[f[a]]=1;else{b=f[a];for(d in b)b[d]===!0?g[d]=1:b[d]!==!1&&0!==b[d]&&(g[d]=b[d])}var h={id:c.item.id,quantity:c.itemForm.itemQty,name:c.item.name,price:c.item.price,instructions:c.itemForm.specialInstructions,options:g};c.action(h),e.dataLayer.push({event:"OrderAction",eventCategory:"Merchant",eventAction:"Add To Bag",eventLabel:n+"-"+c.item.id+":"+c.item.name,ecommerce:{add:{products:[{name:c.item.name,id:c.item.id,price:c.item.price,quantity:c.itemForm.itemQty,variant:JSON.stringify(g)}]}}}),Leanplum.track("Item added to cart","Merchant Page",{vertical:n})}},c.cartIsValid=!1,c.requiredTooltip=function(){return d.matchMedia.small?c.cartIsValid?"":"Your cart is missing required items":""},c.$watch("item",function(a,b,d){a&&("undefined"!=typeof a.cartIndex&&c.itemFormInit&&a.cartIndex===c.itemFormInit.cartKey?c.itemForm=c.itemFormInit:(c.itemForm={optionGroup:{},specialInstructions:""},a&&a.min_qty&&(c.itemForm.itemQty=parseFloat(a.min_qty),a.label&&"wnf"===a.label.toLowerCase()&&(c.itemForm.itemQty=q))),d.optionPrices={},c.processingAddToCart=!1,function(){function a(b,c){var e;for(e=0;e<b.length;e++)"option"===b[e].type&&(d.optionPrices[b[e].id]={},d.optionPrices[b[e].id].price=null===b[e].price?0:parseFloat(b[e].price),d.optionPrices[b[e].id].selDep=c),b[e].children.length>0&&("option group"===b[e].type&&b[e].sel_dep?a(b[e].children,!0):a(b[e].children,!1))}a(c.item.children)}())}),c.$watch("itemForm",function(a,b,c){function d(){var a,b,d=c.itemForm.optionGroup,e=0;for(b in d)if("object"!=typeof d[b])e+=c.optionPrices[d[b]].price*c.itemForm.itemQty;else for(a in d[b])e+=d[b][a]===!0?c.optionPrices[a].price*c.itemForm.itemQty:c.optionPrices[a].selDep?c.optionPrices[a].price*d[b][a]:c.optionPrices[a].price*d[b][a]*c.itemForm.itemQty;return e}function e(){var a,b;if(!c.item)return!1;for(b=function(a){var d,e,f,g,h,i,j,k,l=dcom.menuUtils.optionsQuantity(c.itemForm.optionGroup[a.id]);if(a.sel_dep?(g=a.min_selection*c.itemForm.itemQty,h=a.max_selection*c.itemForm.itemQty):(g=a.min_selection,h=a.max_selection),!(l>=g&&h>=l))return!1;for(f=a.children,d=0;d<f.length;d++){if(f[d].max_qty&&(a.sel_dep?(i=f[d].min_qty*c.itemForm.itemQty,j=f[d].max_qty*c.itemForm.itemQty):(i=f[d].min_qty,j=f[d].max_qty),k=c.itemForm.optionGroup[a.id][f[d].id],i>k||k>j))return!1;if(c.itemForm.optionGroup[a.id]&&(c.itemForm.optionGroup[a.id]===f[d].id||c.itemForm.optionGroup[a.id][f[d].id]===!0||c.itemForm.optionGroup[a.id][f[d].id]>0)&&f[d].children.length>0)for(e=0;e<f[d].children.length;e++)if(!b(f[d].children[e]))return!1
}return!0},a=0;a<c.item.children.length;a++)if(("option group"===c.item.children[a].type||"price group"===c.item.children[a].type)&&!b(c.item.children[a]))return!1;return!0}c.item&&("wnf"!==c.item.label&&(c.itemForm.total=c.hasPriceGroup()?d():parseFloat(c.item.price)*c.itemForm.itemQty+d()),c.cartIsValid=e())},!0)}],link:function(){}}}),angular.module("dcomApp").directive("dcomOptionGroup",["$compile","JqliteHelper",function(a,b){return{template:'<div id="option-group-{{optionGroup.id}}" class="option-group"><header class="option-group-header"  ng-class="{\'required\': required}"><h3 ng-bind-html="optionGroup.name" ng-class="{\'required\': required}"></h3><div class="instructions"></div><div ng-bind-html="optionGroup.description" class="description" ng-class="{\'has-description\': optionGroup.description!==\'\' && optionGroup.description!==\' \'}"></div></header><div ng-show="optionGroup.children" class="options"><div ng-repeat="option in optionGroup.children" dcom-option="option"></div></div></div>',restrict:"A",replace:!0,controller:["$modal","$scope",function(a,c){this.optionGroupId=c.optionGroup.id,this.getOptionType=function(){return 1===c.optionGroup.adjustedMinSelection&&1===c.optionGroup.adjustedMaxSelection?"single":"multi"},this.getOptionById=function(a){if("object"==typeof c.optionGroup)for(var b=0;b<c.optionGroup.children.length;b++)if(c.optionGroup.children[b].id===a)return c.optionGroup.children[b];return null},c.optionGroup.adjustedMinSelection=c.optionGroup.min_selection,c.optionGroup.adjustedMaxSelection=c.optionGroup.max_selection,c.getOptionById=this.getOptionById,c.optionGroup.sel_dep&&c.$watch("itemForm.itemQty",function(d,e,f){var g,h;f.optionGroup.adjustedMinSelection=f.optionGroup.min_selection*f.itemForm.itemQty,f.optionGroup.adjustedMaxSelection=f.optionGroup.max_selection*f.itemForm.itemQty,g=c.itemForm.optionGroup[c.optionGroup.id],h=dcom.menuUtils.optionsQuantity(g),h>f.optionGroup.adjustedMaxSelection&&(f.itemForm.itemQty=e,window.scrollTo(0,b.getOffsetTop("option-group-"+f.optionGroup.id)),a.open({templateUrl:"views/modals/itemQtyOptionMax.html",resolve:{max:function(){return f.optionGroup.adjustedMaxSelection},optionQuantity:function(){return h},optionName:function(){return f.optionGroup.name}},controller:["$scope","max","optionQuantity","optionName",function(a,b,c,d){a.max=b,a.optionQuantity=c,a.optionName=d}]}))}),"multi"===this.getOptionType()&&(c.itemForm.optionGroup[c.optionGroup.id]=c.itemForm.optionGroup[c.optionGroup.id]||{},c.$watch("itemForm.optionGroup[optionGroup.id]",function(b,c,d){var e=dcom.menuUtils.optionsQuantity(b);e>d.optionGroup.adjustedMaxSelection&&(d.itemForm.optionGroup[d.optionGroup.id]=c,a.open({templateUrl:"views/modals/overMaxOptions.html",resolve:{max:function(){return d.optionGroup.adjustedMaxSelection},optionQuantity:function(){return e}},controller:["$scope","max","optionQuantity",function(a,b,c){a.max=b,a.optionQuantity=c}]}))},!0))}],link:function(b,c){var d,e="";1===b.optionGroup.adjustedMinSelection&&1===b.optionGroup.adjustedMaxSelection?(e='<span class="required">(Required - Choose 1)</span>',b.required=!0):0===b.optionGroup.adjustedMinSelection?(e=1===b.optionGroup.children.length?"(Optional)":b.optionGroup.adjustedMaxSelection===b.optionGroup.children.length?"(Optional - Choose as many as you want)":"(Optional - Choose up to {{::optionGroup.adjustedMaxSelection}})",b.required=!1):b.optionGroup.adjustedMinSelection===b.optionGroup.adjustedMaxSelection?(e='<span class="required">(Required - Choose {{::optionGroup.adjustedMinSelection}})</span>',b.required=!0):(e='<span class="required">(Required - Choose from {{::optionGroup.adjustedMinSelection}} to {{::optionGroup.adjustedMaxSelection}})</span>',b.required=!0),(d=a("<span>"+e+"</span>"))(b,function(a){for(var b=c[0].querySelectorAll(".instructions"),d=0;d<b.length;d++)angular.element(b[d]).append(a)})}}}]),angular.module("dcomApp").directive("dcomOption",["$compile",function(a){function b(a,b){var c="";return c="single"===a?'<div ng-class="{\'active\': itemForm.optionGroup[optionGroup.id] && itemForm.optionGroup[optionGroup.id] == option.id, \'inactive\': itemForm.optionGroup[optionGroup.id] && itemForm.optionGroup[optionGroup.id] != option.id}" id="option-{{option.id}}" class="option radio"><label><input type="radio" name="{{optionGroup.id}}" ng-model="itemForm.optionGroup[optionGroup.id]" value="{{option.id}}" /> <span ng-bind-html="option.name" class="name"></span> <span ng-show="option.price > 0" class="price">{{option.price | currency}}</span><div ng-show="option.description" ng-bind-html="option.description" class="description"></div></label></div>':b.max_qty?'<div id="option-{{option.id}}" class="option quantity"><label><span dcom-spinner ng-model="itemForm.optionGroup[optionGroup.id][option.id]" data-min="option.adjustedMinQty" data-max="option.adjustedMaxQty" data-step="option.increment" class="option-quantity" /> <span ng-bind-html="option.name" class="name"></span> <span ng-show="option.price > 0" class="price">{{option.price | currency}}</span><div ng-show="option.description" ng-bind-html="option.description" class="description"></div></label></div>':'<div ng-class="{\'active\': itemForm.optionGroup[optionGroup.id][option.id]}" id="option-{{option.id}}" class="option checkbox"><label><input type="checkbox" ng-model="itemForm.optionGroup[optionGroup.id][option.id]" /> <span ng-bind-html="option.name" class="name"></span> <span ng-show="option.price > 0" class="price">{{option.price | currency}}</span><div ng-show="option.description" ng-bind-html="option.description" class="description"></div></label></div>'}return{restrict:"A",require:"^dcomOptionGroup",link:function(c,d,e,f){d.contents().remove();var g,h=f.getOptionType();c.option.adjustedMinQty=c.option.min_qty,c.option.adjustedMaxQty=c.option.max_qty,c.optionGroupId=f.optionGroupId,g=a(b(h,c.option)),g(c,function(a){d.append(a)}),c.optionGroup.sel_dep&&c.$watch("itemForm.itemQty",function(a,b,c){c.option.adjustedMinQty=c.option.min_qty*c.itemForm.itemQty,c.option.adjustedMaxQty=c.option.max_qty*c.itemForm.itemQty}),"single"===f.getOptionType()?c.$watch("itemForm.optionGroup[optionGroup.id]",function(b,c,e){var f,g,h,i,j='<div ng-repeat="optionGroup in optionChildren" dcom-option-group="optionGroup"></div>',k=e.getOptionById(b),l=e.getOptionById(c);if(k&&k.children.length>0&&k.id===e.option.id&&(f=e.$new(),g=a(j),f.optionChildren=k.children,g(f,function(a){d.children().eq(0).append(a)})),l&&l.children.length>0&&l.id===e.option.id&&c!==b)for(h=0;h<l.children.length;h++)i=l.children[h].id,angular.element(document.getElementById("option-group-"+i)).remove(),delete e.itemForm.optionGroup[i]}):"multi"===f.getOptionType()&&c.$watch("itemForm.optionGroup[optionGroup.id][option.id]",function(b,c,e){var f,g,h,i,j='<div ng-repeat="optionGroup in optionChildren" dcom-option-group="optionGroup"></div>',k=e.option;if(b&&k.children.length>0&&(g=e.$new(),h=a(j),g.optionChildren=k.children,h(g,function(a){d.children().eq(0).append(a)})),b===!1&&k.children.length>0&&c!==b)for(i=0;i<k.children.length;i++)f=k.children[i].id,angular.element(document.getElementById("option-group-"+f)).remove(),delete e.itemForm.optionGroup[e.optionGroup.id][f]})}}}]),angular.module("dcomApp").directive("dcomSpinner",function(){return{restrict:"A",template:'<a ng-click="stepDown()" class="spinner-control step-down">&ndash;</a> <span class="spinner-input-wrapper"><input ng-class="{\'qty-not-zero\':spinnerModel>0}" ng-model="spinnerModel" id="{{id}}" type="number" min="{{min}}" step="{{step}}" /></span> <a ng-click="stepUp()" class="spinner-control step-up">+</a>',scope:{spinnerModel:"=ngModel",id:"@",min:"=",max:"=",step:"=",disable:"@"},link:function(a,b){var c=b.find("input");a.spinnerModel=a.spinnerModel||parseFloat(a.min),"true"===a.disable&&c.attr("readonly","true"),a.stepDown=function(){var b,c=parseFloat(a.step)||1;a.spinnerModel&&(b=a.spinnerModel-c,(!a.min||b>=a.min)&&(a.spinnerModel=b))},a.stepUp=function(){var b,c=parseFloat(a.step)||1;a.spinnerModel=a.spinnerModel||parseFloat(a.min)||0,b=a.spinnerModel+c,(!a.max||b<=a.max)&&(a.spinnerModel=b)},c.bind("blur",function(){var b=parseFloat(a.step)||1;a.spinnerModel<a.min?a.$apply(function(){a.spinnerModel=parseFloat(a.min)}):a.spinnerModel>a.max?a.$apply(function(){a.spinnerModel=parseFloat(a.max)}):100*a.spinnerModel%(100*b)!==0?a.$apply(function(){a.spinnerModel=a.spinnerModel-a.spinnerModel%b}):(null===a.spinnerModel||"undefined"==typeof a.spinnerModel)&&a.$apply(function(){a.spinnerModel=parseFloat(a.min)})})}}}),angular.module("dcomApp").directive("googleStructuredData",function(){return{restrict:"E",scope:{schemaType:"@",merchantInfo:"="},template:'<div ng-bind-html="merchantStructuredData"></div>',controller:["$scope","$sce",function(a,b){function c(){var b=a.merchantInfo.ordering.minimum.delivery.lowest;return null!==b?b:0}function d(){return a.merchantInfo.summary.num_ratings?'"@type": "AggregateRating","ratingValue": "'+a.merchantInfo.summary.star_ratings+'","reviewCount": "'+a.merchantInfo.summary.num_ratings+'"':""}function e(){var b='"http://purl.org/goodrelations/v1#DeliveryModeOwnFleet"',c='"http://purl.org/goodrelations/v1#DeliveryModePickUp"',d=a.merchantInfo.ordering.availability,e=[];return"http://schema.org/DryCleaningOrLaundry"===a.schemaType?b:(d.delivery&&e.push(b),d.pickup&&e.push(c),e.join(","))}a.getGoogleStructuredData=function(){return'<script type="application/ld+json">{"@context":"http://schema.org","@type":"'+a.schemaType+'","@id":"'+a.merchantInfo.summary.url.complete+'","name":"'+a.merchantInfo.summary.name+'","address":{"@type":"PostalAddress","streetAddress":"'+a.merchantInfo.location.street+'","addressLocality":"'+a.merchantInfo.location.city+'","addressRegion":"'+a.merchantInfo.location.state+'","postalCode":"'+a.merchantInfo.location.zip+'","addressCountry":"US"},"geo":{"@type":"GeoCoordinates","latitude":"'+a.merchantInfo.location.latitude+'","longitude":"'+a.merchantInfo.location.longitude+'"},"telephone":"'+a.merchantInfo.summary.phone+'","aggregateRating": {'+d()+'},"potentialAction":{"@type":"OrderAction","target":["'+a.merchantInfo.summary.url.complete+'"],"deliveryMethod":['+e()+'],"priceSpecification":{"@type":"DeliveryChargeSpecification","appliesToDeliveryMethod":"http://purl.org/goodrelations/v1#DeliveryModeOwnFleet","priceCurrency":"USD","price":'+a.merchantInfo.ordering.fees.delivery_charge+',"eligibleTransactionVolume":{"@type":"PriceSpecification","priceCurrency":"USD","price":'+c()+"}}}}</script>"},a.$watch("merchantInfo",function(){angular.isDefined(a.merchantInfo)&&(a.merchantStructuredData=b.trustAsHtml(a.getGoogleStructuredData()))})}]}}),angular.module("dcomApp").directive("ngClick",["$timeout","$location","$window",function(a,b,c){return{restrict:"A",priority:1,link:function(d,e,f){if("ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch){var g=function(){if(f.href||f.ngHref)return f.href||f.ngHref;if(e.find("a").length>0){var a=e.find("a").eq(0);if(a.attr("href")||a.attr("ngHref"))return a.attr("href")||a.attr("ngHref")}},h=g(),i=new RegExp("https{0,1}://");h&&e.bind("click",function(){a(function(){i.test(h)?c.location.href=h:b.url(h)},20)})}}}}]),angular.module("dcomApp").directive("dcomNotices",function(){var a={notice:"icon-bell",alert:"icon-warning"};return{restrict:"A",scope:{notices:"=dcomNotices",hideHeader:"="},templateUrl:"views/partials/notices.html",link:function(b){function c(c){c=c||[],b.messages=c.map(function(b){return{text:b.text,icon:a[b.type]}})}b.$watchCollection("notices",c)}}}),angular.module("dcomApp").directive("olarkWrapper",["$rootScope",function(){return{restrict:"E",template:'<div id="olark_wrapper"></div><noscript><a href="https://www.olark.com/site/4271-233-10-2612/contact" title="Contact us" target="_blank">Questions? Feedback?</a> powered by <a href="http://www.olark.com?welcome" title="Olark live chat software">Olark live chat software</a></noscript>',link:function(){function a(){window.olark||function(a){var b=window,c=document,d="https:"==b.location.protocol?"https:":"http:",e=a.name,f="load",g=function(){function h(){i.P(f),b[e](f)}b[e]=function(){(i.s=i.s||[]).push(arguments)};for(var i=b[e]._={},j=a.methods.length;j--;)!function(a){b[e][a]=function(){b[e]("call",a,arguments)}}(a.methods[j]);i.l=a.loader,i.i=g,i.p={0:+new Date},i.P=function(a){i.p[a]=new Date-i.p[0]},b.addEventListener?b.addEventListener(f,h,!1):b.attachEvent("on"+f,h);var k=function(){function b(a){return a="head",["<",a,"></",a,"><",f,' onload="var d=',q,";d.getElementsByTagName('head')[0].",j,"(d.",l,"('script')).",m,"='",d,"//",i.l,"'",'"',"></",f,">"].join("")}var f="body",g=c[f];if(!g)return setTimeout(k,100);i.P(1);var h,j="appendChild",l="createElement",m="src",n=c[l]("div"),o=n[j](c[l](e)),p=c[l]("iframe"),q="document",r="domain";n.style.display="none",g.insertBefore(n,g.firstChild).id=e,p.frameBorder="0",p.id=e+"-loader",/MSIE[ ]+6/.test(navigator.userAgent)&&(p.src="javascript:false"),p.allowTransparency="true",o[j](p);try{p.contentWindow[q].open()}catch(s){a[r]=c[r],h="javascript:var d="+q+".open();d.domain='"+c.domain+"';",p[m]=h+"void(0);"}try{var t=p.contentWindow[q];t.write(b()),t.close()}catch(u){p[m]=h+'d.write("'+b().replace(/"/g,String.fromCharCode(92)+'"')+'");d.close();'}i.P(2)};k()};g()}({loader:"static.olark.com/jsclient/loader0.js",name:"olark",methods:["configure","extend","declare","identify"]}),olark.identify("4271-233-10-2612"),olark("api.box.hide")}a()}}}]),angular.module("dcomApp").directive("orderDetails",["$window","$modal","OrderAPI",function(a,b,c){return{controller:["$scope",function(b){a.dataLayer=a.dataLayer||[],b.windowDataLayer=a.dataLayer}],link:function(a){a.removeOrderMsg="",a.processingFavoriting=!1,a.favoritingIsEnabled=!1,a.orderName="","undefined"!=typeof a.order&&(a.orderIsFavorited=a.order.favorite),a.toggleFavoriting=function(b){var c=document.getElementById(b);a.favoritingIsEnabled===!1?(angular.element(c).addClass("show"),c.querySelector("input").focus(),a.windowDataLayer.push({event:"OrderAction",eventCategory:"Order Details",eventAction:"Favorite opened",eventLabel:b})):(a.orderIsFavorited=!1,angular.element(c).removeClass("show")),a.favoritingIsEnabled=!a.favoritingIsEnabled},a.favoriteOrder=function(d){return a.processingFavoriting=!0,""===a.orderName||0===a.orderName.length?(b.open({templateUrl:"views/modals/favoriteOrderValidation.html",controller:["$scope",function(){}]}),a.processingFavoriting=!1,!1):void c.setFavorite(d,a.orderName).then(function(){a.orderIsFavorited=!0,a.processingFavoriting=!1,a.windowDataLayer.push({event:"OrderAction",eventCategory:"Order Details",eventAction:"Favorite added",eventLabel:d+" - "+a.orderName})})},a.unFavoriteOrder=function(d){b.open({templateUrl:"views/modals/removeFromOrderFavorites.html",controller:["$scope",function(b){a.removeOrderMsg=document.getElementById("fav-order-name-"+d).value,b.remove=function(){b.$dismiss(),c.unsetFavorite(d).then(function(){a.windowDataLayer.push({event:"OrderAction",eventCategory:"Order Details",eventAction:"Favorite removed",eventLabel:d+" - "+a.orderName}),a.processingFavoriting=!1,a.orderIsFavorited=!1,a.orderName="",angular.element(document.getElementById(d)).removeClass("show")})}}]})}}}}]),angular.module("dcomApp").directive("dcomRateOrder",["OrderAPI",function(a){return{restrict:"EA",scope:{order:"="},template:'<span class="rating-container" ng-class="{\'open\' : status.open}"><span class="target"><button ng-click="setRating(review)" dcom-processing="{{status.transactionInProgress}}" class="button primary">Add</button></span><span class="label" ng-click="maximize()"><span class="rating" dcom-order-rating rating="review.rating" editable="true"> </span></span></span>',link:function(b){function c(a){return a.rating>0}function d(){b.status.open=!0}function e(){b.status.open=!1}function f(d){c(d)&&(b.status.transactionInProgress=!0,a.rateOrder(h,d).then(e).finally(function(){b.status.transactionInProgress=!1}))}function g(a){var c=a.feedback||{rating:0,review:""};b.review={content:c.review,rating:c.overall_rating}}var h=b.order.order_id;b.status={open:!1,transactionInProgress:!1},g(b.order),b.maximize=d,b.setRating=f}}}]),angular.module("dcomApp").directive("dcomOrderRating",function(){return{restrict:"A",scope:{rating:"=",maxRating:"@",editable:"@",onChange:"&"},template:'<div><span class="stars-container"><span ng-repeat="r in totalStars track by $index" class="icon-star" ng-class="{\'active\' : rating>$index, \'set\' : rating>$index}" ng-mouseenter="highlight($index+1)" ng-mouseleave="restoreState()" ng-click="setRating($index+1)"></span></span><span class="label">{{ratingLabels[rating]}}</span></div>',controller:["$scope",function(a){function b(){a.rating=a.rating}function c(b){a.rating=b}function d(b){a.rating=b,a.onChange({rating:b})}function e(){a.totalStars=new Array(parseInt(a.maxRating||5)),a.rating=a.rating||0,"true"===a.editable&&(a.highlight=c,a.setRating=d),b()}a.ratingLabels=["Rate it!","Eek, this was bad","I’ve had better","It was OK","I like it!","Wow, this was amazing!"],e(),a.restoreState=b,a.$watch("rating",function(b){a.rating=b||0})}]}}),angular.module("dcomApp").directive("dcomScrollto",["Animation","HammerEvents","JqliteHelper",function(a,b,c){return{link:function(d,e,f){b.onClick(e[0],function(){d.$apply(function(){var b=f.dcomScrollto.replace("#",""),d=document.getElementById(b);if(d){var e={offsetTop:20,duration:500,easing:"easeInQuad"},g=c.getOffsetTop(b)-e.offsetTop;0>g&&(g=0),a.animateScrollto(document.body,g,500)}})})}}}]),angular.module("dcomApp").directive("stopPropagation",["$timeout",function(a){return{restrict:"A",link:function(b,c){function d(b){if(a.cancel(e),f&&(b.stopPropagation(),"touchend"===b.type)){var d=document.createEvent("MouseEvents");d.initMouseEvent("mousedown",!0,!0,window),c[0].dispatchEvent(d)}f=!1,e=a(function(){f=!0},400)}var e,f=!0;c.bind("touchstart touchend click",d),b.$on("$destroy",function(){c.unbind("touchstart touchend click",d)})}}}]),angular.module("dcomApp").directive("dcomPhoneFormat",function(){return{terminal:!0,restrict:"A",require:"ngModel",scope:{phoneNumber:"=ngModel"},controller:["$scope","$filter",function(a,b){a.$watch(function(){return a.phoneNumber},function(){a.phoneNumber=b("phone")(a.phoneNumber)})}]}}),angular.module("dcomApp").directive("editAddress",["$modal","$route","LocationAPI",function(){return{restrict:"EA",link:function(a){a.openEditForm=!1,a.addingAddress=!1,a.toggleForm=function(b){a.openEditForm=!a.openEditForm,a.$parent.addingAddress=!1,a.addingAddress=a.$parent.addingAddress,a.openEditForm===!0?a.$parent.setAddress(b):a.$parent.address={},a.$parent.errorMsg={street:!1,city:!1,unit:!1,zip_code:!1,phone:!1}},a.$watch("$parent.addingAddress",function(b){a.addingAddress=b}),a.cancel=function(){a.openEditForm=!1,a.addingAddress=!1,a.$parent.currId=0}}}}]),angular.module("dcomApp").directive("dcomAndroidBanner",["Cookies","DcomConfig","JqliteHelper","Device",function(a,b,c,d){return{restrict:"E",template:'<div ng-if="isVisible()" ng-include="\'views/partials/androidBanner.html\'"></div>',link:function(b){function e(){angular.element(document.getElementById("androidBanner")).addClass("hidden")}function f(a,b){angular.element(a).css("-webkit-transform","scale("+b+")").css("-msie-transform","scale("+b+")").css("-moz-transform","scale("+b+")").css("width",document.documentElement.clientWidth/b)}b.visible=!1,b.isVisible=function(){return b.visible},b.close=function(){e(),a.setCookie("sb-closed","true",{expires:b.options.daysHidden})},b.install=function(){e(),a.setCookie("sb-installed","true",{expires:b.options.daysReminder})};for(var g,h=document.getElementsByTagName("link"),i=0;i<h.length;i++)"apple-touch-icon-precomposed"===h[i].getAttribute("rel")&&"60x60"===h[i].getAttribute("sizes")&&(g=h[i].getAttribute("href"));b.options={title:"Delivery.com",author:"Download the app.",appStoreLanguage:"us",inStore:"FREE - In Google Play",icon:g,button:"View",link:"https://play.google.com/store/apps/details?id=com.deliverycom",daysHidden:15,daysReminder:30};var j=a.getCookie("sb-closed"),k=a.getCookie("sb-installed"),l=null!==navigator.userAgent.match(/Android/i)?!0:!1,m=d.isMobileApp();if(l&&!j&&!k&&!m){var n=document.documentElement.clientWidth/window.screen.width;if(n>1){var o=document.getElementById("androidBanner"),p=document.getElementById("sb-container");angular.element(o).css("top",parseFloat(c.getStyle(o,"top"))*n).css("height",parseFloat(c.getStyle(o,"height"))*n).addClass("hidden"),f(o,n),f(p,n)}b.visible=!0}}}}]),angular.module("dcomApp").directive("dcomViewportSpy",["$rootScope","$window","ScrollHandler","JqliteHelper",function(a,b,c,d){return{restrict:"AE",scope:{dcomViewportSpy:"=",reverse:"="},link:function(e,f,g){function h(){e.scrollPosition<0&&(e.scrollPosition=0),angular.isDefined(e.reverse)&&e.scrollPosition>0?(e.scrollPosition+=e.windowSize,e.scrollPosition>e.bottomElementPosition&&e.visible?(e.visible=!1,a.$broadcast(e.elementId+"InsideViewport")):e.scrollPosition<e.bottomElementPosition&&!e.visible&&(e.visible=!0,a.$broadcast(e.elementId+"OutsideViewport"))):e.scrollPosition>e.bottomElementPosition&&e.visible?(e.visible=!1,a.$broadcast(e.elementId+"OutsideViewport")):e.scrollPosition<e.bottomElementPosition&&!e.visible&&(e.visible=!0,a.$broadcast(e.elementId+"InsideViewport"))}c.updatePosition(),e.scrollPosition=c.getPosition(),e.windowSize=Math.min(document.documentElement.clientHeight,document.body.scrollHeight,document.documentElement.scrollHeight,document.body.offsetHeight,document.documentElement.offsetHeight),e.visible=!0,e.elementId=g.dcomViewportSpy,e.bottomElementPosition=d.getOffsetTop(f.attr("id"))+f[0].clientHeight,e.$watch(function(){var a=d.getOffsetTop(f.attr("id"))+f[0].clientHeight;a>=0&&(e.bottomElementPosition=a),e.windowSize=Math.min(document.documentElement.clientHeight,document.body.scrollHeight,document.documentElement.scrollHeight,document.body.offsetHeight,document.documentElement.offsetHeight)}),b.addEventListener("scroll",function(){b.requestAnimationFrame(function(){e.scrollPosition=c.getPosition(),h()})}),h()}}}]),angular.module("dcomApp").directive("dcomSearchSuggest",["$window","$compile","Group",function(a,b,c){return{restrict:"AE",scope:{itemSearch:"@dcomSearchSuggest",inFocus:"@",currentGroup:"@",itemKeyword:"=ngModel"},controller:["$scope",function(b){function d(a){if(""===a)return[];for(var c,d=["Afghan","American","Argentinian","Asian","Cafe","Caribbean","Chinese","Cuban","Deli","Dessert","Diner","Fast Food","French","Fusion","Glatt Kosher","Greek","Halal","Hawaiian","Healthy","Indian","Irish","Italian","Japanese","Korean","Kosher","Latin","Mediterranean","Mexican","Middle Eastern","Nepalese","Organic","OU Kosher","Russian","Seafood","Soul Food","South American","Spanish","Tex-Mex","Thai","Turkish","Vegan","Vegetarian","Vietnamese"],f=["Cheesesteak","BBQ","Breakfast","Frozen Yogurt","Can Soda","Soda","Canned Soda","Snapple","French Fries","Pad Thai","Iced Coffee","Mozzarella Sticks","Miso Soup","Caesar Salad","Cheese Pizza","Coffee","Edamame","Chicken Fingers","Bottled Water","Cheeseburger","Spicy Tuna Roll","California Roll","Buffalo Wings","Omelette","Pasta","Sandwich","Chicken Tikka Masala","Salad","Create Your Own Salad","Sushi","Tapas","Bottled Soda","Salmon Avocado Roll","Onion Rings","Greek Salad","Shrimp Tempura Roll","Thai Iced Tea","Naan","2 Liter Soda","Fountain Soda","House Salad","Sweet Potato Fries","Grilled Cheese Sandwich","Turkey Burger","Milk Shake","Bagel","Margherita Pizza","Seaweed Salad","Philadelphia Roll","Gatorade","Fresh Squeezed Orange Juice","Iced Tea","Chicken Noodle Soup","Garlic Bread","Cheese Fries","Garlic Naan","Guacamole","Gyoza","Fried Calamari","Garden Salad","Bagel with Cream Cheese","Eel Avocado Roll","Two Eggs Any Style","Fried Rice","Avocado Roll","Vitamin Water","Tiramisu","Hot Coffee","Spicy Salmon Roll","Salmon Roll","Baked Ziti","Falafel","White Rice","Can of Soda","Tuna Avocado Roll","Chicken Parmigiana","Avocado Salad","Muffin","Chicken Roll","Poland Spring Water","Shumai","Penne Alla Vodka","Orange Juice","Salmon","Milkshake","Cheese Burger","Fresh Fruit Salad","Three Roll Combo","Philly Cheesesteak","Cappuccino","Two Egg Sandwich","Side of Bacon","Tuna Roll","French Toast","Fries","Hamburger","Cobb Salad","Hummus","Cannoli","Ice Cream","Chicken Parmigiana Hero","Waffle Fries","Lentil Soup","Pineapple Fried Rice","Pepperoni Pizza","Cheesesteak Sandwich","Baklava","Wonton Soup","Nachos","Bacon Cheeseburger","Chicken Soup","Quesadilla","Grilled Chicken Sandwich","Green Salad","Grilled Chicken Burrito","Shawarma","Beef Burger","Pad Thai Lunch Special","Garlic Knots","Lo Mein","Poland Spring Bottled Water","Veggie Burger","Drunk Man Noodle","Juice","Green Curry","Rice Pudding","Large Cheese Pizza","Spring Water","Hot Chocolate","Carrot Cake","Matzoh Ball Soup","Mango Lassi","Fresh Orange Juice","Bagel with Butter","Brown Rice","Yellowtail Scallion Roll","Egg Roll","Pancakes","Western Omelette","Sweet Potato Roll","Chicken Wings","Egg Sandwich","Cheese Quesadilla","Soft Drink","Cole Slaw","Tropicana Juice","Kani Salad","Vegetable Samosa","French Onion Soup","Chicken Tenders","Slice of Cheese Pizza","Chips","Brownie","Diet Coke","Spicy Roll","Cheese Calzone","Red Curry","Cheese Pizza Slice","General Tso's Chicken","Samosa","Margarita Pizza","Chicken Quesadilla","Boylan's Soda","Chicken Kebob","Penne Vodka","Peanut Avocado Roll","Barest Burger","Chicken Caesar Wrap","Classic Burger","Fresh Cut French Fries","Gyro","Massaman Curry","Meat Combo","Regular Cheese Pizza Slice","Beef Patty","Boneless Wings","Mashed Potatoes","Tossed Salad","Curly Fries","Side of French Fries","Fruit Salad","Tater Tots","Grilled Chicken Salad","Tuna","Cheese Omelette","Coke","Chocolate Milk","Lemonade","Jalapeno Poppers","Croissant","Eggs Benedict","Buffalo Chicken Wrap","Cookie","Salmon a la Carte","Chocolate Mousse Cake","Tuna Salad Sandwich","Chocolate Chip Cookie","Potato Salad","Side Order of Hummus","Jasmine Rice","Fresh Lemonade","Tom Yum Soup","Two Eggs Sandwich","Chicken Salad Sandwich","Rainbow Roll","Bacon Cheese Burger","Sweet Potato Tempura Roll","Spicy Scallop Roll","Cucumber Roll","Chicken Teriyaki Entree","Chopped Salad","The Original Pizza","Chicken Parmigiana Entree","House Blend Coffee","Meatball Parmigiana Hero","Burrito","Cheeseburger Deluxe","Spring Roll","Cheesecake","Grilled American Cheese Sandwich","Calzone","Cheese Steak Sandwich","Wings","Spicy Mayo","Pepperoni Roll","Bagel Smash with One Egg","Edamame Appetizer","Spider Roll","Spinach Pie","Panang Curry","Apple Juice","Thai Ice Tea","Thai Fried Rice","Falafel Sandwich","20oz Bottle Soda","Chili Cheese Fries","Home Fries","Fried Egg Sandwich","Chicken Nuggets","Buffalo Chicken Sandwich","Chocolate Cake","Sticky Rice","Egg Salad Sandwich","Medium Original with Toppings","Large Pizza Pie","Challah French Toast","Plain Naan","Three Rolls Combo","Bagel with Plain Cream Cheese","Create Your Own Pasta","Thai Iced Coffee","Mochi Ice Cream","Taco Salad","Alaska Roll","Herbal Tea","Dragon Roll","Pad Thai Lunch","Shrimp Shumai","Lasagna","Homemade Lemonade","Drunken Noodle","Plain Cheese Pizza","Yellowtail Jalapeno Roll","Iced Cappuccino","Stewart's Soda","Fountain Beverage","Spicy Yellowtail Roll","Side of Guacamole","Chicken Vindaloo","Scallion Pancake","Pita Bread","Pad Thai Noodle","Create Your Own Omelette","Carnitas Taco","Guacamole and Chips","Chicken Satay","Disco Fries","Shrimp Avocado Roll","Milk","Hot Oatmeal","Cajun Fries","Yellowtail","Water","Lucky Fries","Sesame Chicken","Shake","Grilled Chicken Caesar Salad","Breakfast Burrito","Bacon","Curry Puff","Buffalo Chicken Pizza","Cheese Pizza Pie","Garlic Bread with Cheese","Danish","Crispy Basil Spring Rolls","Our Famous Wings","Margherita Classica","Latte","Boston Roll","Regular Cheese Pie","Buffalo Chicken Wings","Bagel with Flavored Cream Cheese","Pork Gyoza","Smoothie","Pad Thai Noodles","Regular Pizza Pie","Tea","Chocolate Chip Pancakes","Macaroni Salad","Side Order of Falafel","Lucky's Beef Burger","Grilled Chicken Quesadilla","Lamb Gyro","Chicken Caesar Salad","Small Original with Toppings","Taco","Tom Kha Soup","Classic Caesar Salad","Bruschetta","Lucky's Shake","Saag Paneer","Apple Pie","Side Order of Bacon","Jarritos","Eel Cucumber Roll","Chicken Tikka","Pad See Ew","Apple Turnover","Fountain Drink","Spicy Crunch Roll","Corn on the Cob","Cheese Burger Deluxe","Pulled Pork Sandwich","Plain Bagel","Baked Potato","San Pellegrino","Chicken Rice Bowl","Blue 9 Burger","Homemade Iced Tea","Chicken Fried Rice","Flavored Coffee","Pasta with Meatballs","Spinach Salad","Chicken Biryani","Cheese Spuds","Chicken Tikka Masala Special","Side of Sausage","Spicy Crunchy Roll","Black Noodle","Freshly Squeezed Orange Juice","Chicken Teriyaki","Belgian Waffle","Margherita Classica Pizza","Boylan Soda","Flan","Arugula Salad","Hot and Sour Soup","Cranberry Juice","Egg Drop Soup","Chicken Marsala","Fettuccine Alfredo","Soup of the Day","Chicken with Broccoli","White Pizza","Grilled Steak Burrito","Hot Tea","Chicken Parmigiana Sandwich","Pasta with Meat Sauce","Crinkle Fries","Spicy Crunchy Tuna Roll","Rice","Chips and Salsa","Sour Cream","Bennett's Chopped Salad","Green Curry Entree","Side of White Rice","Scallion Pancakes","Banana","Roast Beef Sandwich","Philly Cheese Steak Sandwich","Sicilian Pizza Slice","Hash Brown","Minestrone Soup","Tropicana Orange Juice","Raita","French Fried Potatoes","Salmon Skin Roll","Regular Cheese Slice","Gyro Sandwich","Chicken Gyro","Fried Mozzarella Sticks","Bottle Soda","Cheese Cake","Medium Side by Side with Toppings","Side Order of French Fries","Pad Thai Noodle Entree","Antipasto Salad","Espresso","Philly Cheese Steak","Tandoori Chicken","Smart Water","Gyro Platter","Peanut Sauce","Regular Pizza","Steamed Broccoli","Any 3 Rolls Lunch Special","Red Bull","Half Chicken","Hot Dog","Steak Fries","Jumbo Cookie","Sushi Deluxe","Burger Club Classic with Cheese","Side of Spicy Mayo","Curry Puffs","Chicken Curry","Chorizo Taco","Hawaiian Pizza","Eggplant Parmigiana","Red Velvet Cake","Buttermilk Pancakes","Mama's Gyro","Grilled Chicken Caesar Wrap","Alaskan Roll","Crunchy Spicy Tuna Roll","Two Eggs","Green Papaya Salad","Chicken Sandwich","Tuna Melt Sandwich","Avocado Cucumber Roll","Crispy Spring Rolls","Grape Leaves","Three Roll Lunch Special","Eel","BLT Sandwich","Tuna A La Carte","Sauteed Broccoli","Chocolate Mousse","Chicken Francese","Fish Taco","Side Salad","Cafe Latte","Chocolate Croissant","Summer Rolls","Carne Asada Burrito","Rigatoni Bolognese","Maduros","Chicken Burrito","French Fries with Cheese","Grandma Pizza","Pizza Slice","Massaman Curry Entree","Chicken Cutlet Sandwich","Turkey Club Sandwich","Tempura Ice Cream","Tzatziki","Calabrese Pizza","Basil Fried Rice","Hard Shell Taco","Price Fixe","Small Pizza Pie","Spring Rolls","Nan","Sauteed Spinach","Veggie Combo","Sicilian Pizza","Two Eggs with Bacon","Fried Banana","Rice and Beans","Bagel with Scallion Cream Cheese","Split Pea Soup","Roti","Potato Skins","McChicken Sandwich","DuMont Burger","Burger","Queso Loco","Regular Cheese Pizza","Iced Latte","Sicilian Slice","Mixed Green Salad","California Burger","Vegetable Gyoza","Soda Can","Big Mac Value Meal","Regular Pizza Slice","Our Famous Waffle Fries","Fiji Water","Caprese Salad","American Coffee","The Classic Burger","Traditional Pizza Pie","Arizona","Chicken Cutlet Parmigiana","Empanadas","White Tuna","Two Eggs"," Any Style","California Omelette","Nachos Grande","Side of Home Fries","Side of Turkey Bacon","Small Cheese Pizza","Papaya Salad","Tuna Melt","Classic Egg Sandwich","Homemade Tiramisu","Lamb Vindaloo","Chicken Tempura Roll","Create Your Own Sandwich","Cheese Pie","Eggplant Parmigiana Hero","One Egg Sandwich","Macaroni and Cheese","Bison Burger","Spicy Basil Fried Rice","Quesadillas","Create Your Own Burger","Siamese Fried Rice","Soppressata Piccante Pizza","Chicken Parmigiana Dinner","Buffalo Chicken Salad","Grapefruit Juice","Salmon Roe","Penne a la Vodka","Side of Meatballs","Grilled Chicken Platter","Iced Flavored Coffee","Stromboli","Lassi","Queso Chicken Burrito","Yasai Gyoza","Chana Masala","Vegetable Dumplings","Malai Kofta","Crispy Calamari","Red Curry Entree","Gyoza Appetizer","Sausage Roll","Chicken Souvlaki","Chef Salad","Kale Salad","Two Roll Lunch Special","Empanada","Cuban Sandwich","Fresh Summer Rolls","Side of Dry Topping","Mint Lemonade","Donut","Pico de Gallo","Soft Drinks","Lucky Onion Rings","Vegetable Spring Roll","Crab Rangoon","Dynamite Roll","Large Cheese Pizza Pie","Paratha","Carnitas Burrito","Seasoned Fries","Zucchini Sticks","Burrito Grande","Rock Shrimp Tempura","Garlic Nan","Lemongrass Tom Yum","Sushi Deluxe Entree","Coleslaw","Spicy Crunchy Salmon Roll","Buffalo Style Mini Bites","Stuffed Shells","Crispy Chicken Sandwich","Original Hummus","Tri Roll Combo Lunch Special","Pineapple Juice","Godzilla Roll","Create Your Own Pizza","Chicken Souvlaki Platter","Oatmeal","Chocolate Pudding","Bottled Spring Water","Spicy California Roll","Age Tofu","Spicy Tuna","Lucky's Famous Cheddar Burger","Chicken Salad","Sandwich","Fresh Fruit Cup","Chicken Korma","Chef's Salad","Slice of Sicilian Pizza","Cheeseburger Sandwich","Vegetable Spring Rolls","Salmon Cucumber Roll","Pastrami Sandwich","Spinach Roll","Snapple Iced Tea","Yellowtail A La Carte","California Wrap","Pasta with Vodka Sauce","Medium Cheese Pizza","Funghi Misti Pizza","Round Pie","Side of Sour Cream","Poori","Lucky's Smokin' Fries","Guaco Loco","Goat Cheese Salad","Pizza Burger","Fettuccini Alfredo","Huevos Rancheros","Greek Omelette","Cheese Ravioli","Stuffed Crab Ragoon","Pad See Euw","Chicken","Spaghetti with Meatballs","Bare Shake","Grilled Chicken Wrap","Chicken Parmigiana Sub","Pizza Pie","Side of Rice","Two Liter Soda","Chipotle Cheesesteak","Fried Ravioli","Dinner Bento Box","Sante Fe Chicken Rice Bowl","Grilled Chicken","Meatball Hero","Tostones","Fried Chicken Wings","Reuben Sandwich","Grilled Cheese","Jumbo Muffin","Ginger Ale","Tandoori Roti","Double Cheeseburger Sandwich","Chicken Cutlet Hero","Cucumber Salad","Big Mac Sandwich","Seltzer Water","Cookies","Plain Croissant","Side of Chips","Fried Ice Cream","Mediterranean Salad","Chicken Rice Soup","Al Pastor Taco","Caprese","Bubble Tea","Chocolate Layer Cake","Bacon Burger","Grilled Chicken Breast Sandwich","Rocky Balboa Wrap","Chicken Cutlet Parmigiana Hero","Pollo Taco","Elote","Philly Cheese Steak Hero","Garlic Bread with Mozzarella Cheese","Spicy Girl Roll","Chicken Tikka Masala Entree","Panang Curry Entree","Pad Thai Spring Roll","Arroz con Pollo","Cheese Slice","Regular Slice","Large Pizza","Volcano Roll","Dumplings","Lucky Hot Dog","Chicken Cheesesteak Sandwich","Chicken Cheesesteak","Original Pinkberry","Tuna Salad","Vegetable Soup","Naked Juice","English Muffin","Pad Kee Mao","California Hummus","Bacon Omelette","Cheese Danish","1 Liter Soda","Lombardi Pizza","Chicken Parmesan","Salmon Roe A La Carte","Spinach Pizza","Meatball Parmigiana Sandwich","Palak Paneer","Honest Tea","Sprite","Steamed Vegetables","3 Rolls Lunch Special","Matzo Ball Soup","The Pita Grilled Salad","Green Curry Fried Rice","Shrimp","Manhattan Roll","Turkey Sandwich","Grilled Steak Quesadilla","Homemade Muffin","Side of Brown Rice","Bacon"," Egg and Cheese Sandwich","Buffalo Chicken Tenders","Plain Cream Cheese","Any Three Rolls","Chicken Kebab Platter","Lamb Gyro Platter","Sparkling water","Falafel Pita","Large Cheese Pie","Whole Chicken","Bacon","The California Burger","Lucky Sweet Potato Fries","Katz's Pastrami Hot Sandwich","Create Your Own Smoothie","Pescado Taco","Canned Sodas","Spicy Tuna Avocado Roll","Roasted Garlic Naan","Buffalo Chicken Major Munch","Any 3 Rolls","Pollo Asado Taco","Harumaki","Drunken Noodles","Plain Fries","Meat Lasagna","Large Original with Toppings","Vegetable Tempura","Pot Sticker","Two Eggs Any Style with Meat","Build Your Own Mac","Snapple Ice Tea","Regular Coffee","Chicken Parmigiana Panini","Shrimp Fried Rice","Caesar Salad with Grilled Chicken","Lucky's Famous Chicken Sandwich","Toasted Jumbo Bagel","Shrimp Tempura","Grilled Salmon","Tacos","Mango Juice","Shumai Appetizer","Sake","Clear Soup","Horchata","Cafe au Lait","Rock Shrimp","Western Burger","White Star Cheese Burger","House Green Salad","Tres Leches","Pollo Asado Burrito","Baked Lasagna","Medium Korean Fried Chicken","Belgian Waffles","Sausage","Chicken Fingers Appetizer","Enchiladas Suizas","Onion Kulcha","Aloo Paratha","Small Korean Fried Chicken","General Tso's Chicken House Specialty","Green Curry Lunch Special","Smoked Turkey Sandwich","Mango Chutney","Falafel Platter","Tortilla Soup","Cheese Naan","Beef Pattie","Corn Bread","Samosas","6 O'Clock Train Spicy Fried Rice","Toasted Bagel with Cream Cheese","Greek Fries","Turkey Chili","Curry","Buttered Bagel","Pasta Bolognese","Pound Cake","Triple Thick Shake","Eggplant Rollatini","Mozzarella Sticks Appetizer","Mac and Cheese","Thai Salad","Vegetable Fried Rice","Grilled Chicken Breast","Beef Negimaki","Lucky Burger","Vegetable Roll","Oreo Mousse Cake","Small Side by Side with Toppings","Toasted Jumbo Bagel with Cream Cheese","Santa Fe Chicken Rice Bowl","Chicken Wrap","Pad Se Ew","I Did It My Way Omelet","Chili","Western Omelet","Babaganoush","Plain Spuds","Salmon Teriyaki Entree","Crunchy Spicy Salmon Roll","Crispy Duck Salad","Vegetable Biryani","Stuffed Grape Leaves","Santa Fe Wrap","Lamb Biryani","New York Cheeseburger","Gulab Jamun","Can Sodas","Egg Cream","Plain Cheese Pizza Pie","Super Nachos","Side Order of Baba Ganouj","Pad See Ew Noodle Entree","Chicken Taco","Tuna Cucumber Roll","Mama's Platter","Spaghetti Carbonara","Enchiladas","Chicken Parmesan Hero","Penne Ala Vodka","Classic Cheese Burger","Tomato Soup","Sushi Rice","Baked Apple Pie","Seasoned Curly Fries","Corned Beef Hash","Texas Burger","Mexican Burger","Calamari Fritti","Chicken Samosa","2 Eggs Sandwich","Chocolate Shake","Strawberry Cheesecake","Onions Rings","Tikka Masala","Fresh Cut Fries","Chicken Shawarma Sandwich","Chicken Gyro Platter","Grilled Chicken Panini","Homemade Dumplings","Regular Fries","Beet Salad","Hot Pastrami Sandwich","Thai Ice Coffee","American Cheeseburger","Hot Sweet Basil","Vegetarian Burrito","Cheese Omelet","Homemade Pita Chips","Spicy Crunch Tuna Roll","BBQ Burger","Pizza Margherita","General Tso's Chicken Lunch Special","Original Wings","Meatballs","Hot Fudge Sundae","Kale Caesar Salad","Side of Turkey Sausage","Chicken Saag","Sashimi Deluxe","Mulligatawny Soup","Egg","Grandma Slice","Mexican Soda","French Onion Soup Au Gratin","Crazy Tuna Roll","Fried Zucchini","Tikka Masala Curry","Freshly Baked Muffin","Vodka Pie","Anna Rose's Meatballs","Soda Pop","Steak Burrito","4 Cheese Major Munch","Original Burger","Giant Cookie","Feta Cheese Dip","Pink Lemonade","Sausage Pizza","Side Jasmine Rice","Beef with Broccoli","Spanakopita","Monzese Pizza","Yogurt Muffin","Chimichanga","Chicken Shish Kebab","Fish Tacos","Bacon Cheese Burger Deluxe","2 Eggs on a Bagel","Chicken Fajita Wrap","Butter Chicken","Snapple Lemon Iced Tea","Bistec Asado Taco","Lobster Roll","Build Your Own Burger","Make Your Own Salad","Side Order of Sausage","Pasta with Marinara Sauce","Two Eggs with One Breakfast Meat and Cheese Sandwich","Two Eggs any Style with Bacon","Hazelnut Coffee","Eggplant Parmigiana Entree","Custom Chopped Salad","Carne Asada Taco","Fresh Brewed Coffee","Side Spicy Mayo","Spaghetti and Meatballs","Chicken Cutlet Parmigiana Sandwich","Chirashi","Bagel with Vegetable Cream Cheese","Yogurt Parfait","Lumberjack","Bacon","Sweet and Sour Chicken","Two Eggs on a Roll","Chow Fun","Side by Side Pinkberry","Lemon Meringue Pie","Jarritos Mexican Soda","House Coffee","Pizza","Veal Parmigiana","Chicken Vegetable Soup","Spice Crispy Calamari","Plain Omelette","Maki Combo Entree","Side of Onion Rings","Vanilla Shake","Steak Quesadilla","Broccoli Rabe","Three Tacos","4 Cheese Nosh","Side of Sweet Potato Fries","Flautas","One Topping Slice","American Cheese Omelette","Mixed Greens Salad","Shoestring French Fries","Salmon Burger","Chorizo Burrito","Italian Fries","Sea Urchin","Quinoa Salad","Bacon Cheddar Burger","Clucker Spuds","Ice Cream Sundae","Buffalo Chicken Nosh","Chocolate Chunk Cookie","Fresh Cut Idaho Fries","American Fries","Philly Cheesesteak Sandwich","Bacon","Coconut Rice","Tuna Fish Salad Sandwich","Emerald Vegetable Dumplings","Chocolate Brownie","Coconut Galanga Tom Kha","Artichoke Pizza","Pickles","Mozzarella Stix","Medium Chocolate Hazelnut with Toppings","Oreo Cookie Shake","Homemade Ice Tea","Lucky Cheese Fries","Bacon"," Lettuce and Tomato Sandwich","Meat Samosa","Two Eggs on a Bagel","BK Seoul Bao Bun","Hand Cut French Fries","Pad Thai Entree","Beef Negimaki Appetizer","Queso Steak Burrito","Slice of Cake","Two Cheeseburger Value Meal","Steak Sandwich","San Pellegrino Water","Kimchi","Bistec Taco","Any 2 Rolls Lunch Special","Ice Coffee","Chicken Hibachi Dinner","Chicken Breast","Edamame Hot Appetizer","Any Three Rolls Lunch Special","Pad Thai Noodle Lunch Special","Chicken Shawarma","Lamb Korma","Chicken Francese Entree","Small Cheese Pizza Pie","Sashimi Appetizer","Two Rolls Lunch Special","Falafel Wrap","Boylan's Bottled Soda","Tiger Roll","Eel A La Carte","Classic Greek Salad","Summer Roll","Chicken Fingers with French Fries","Cold Sake","Hamburger Deluxe","Baked Sweet Potato","Caesar Salad with Chicken","Chana Saag","Soft Shell Taco","Cheeseburger Major Munch","Chicken Enchiladas","Red Curry Lunch Special","Pasta Alla Vodka","Mochi","Veggie Samosa","Tropicana","Vegetarian Omelette","Arnold Palmer","Broccoli","Flavored Iced Coffee","Bacon and Egg Sandwich","Carne Asada Tacos","Mexican Roll","Perrier","Cucumber Raita","Chicken Patty","Chicken Cutlet"," Fresh Mozzarella"," Roasted Red Peppers Sub","Garlic Bread with Mozzarella","Bowl of Chili","Al Roker Pizza","Yellow Rice","Bareburger Special Sauce","Chocolate Milk Shake","Teriyaki Entree"],g=d.concat(f),h=g.length,i=a.toLowerCase(),j=i.length,k=null,l=[],m=[],n=!1,o=0;h>o;o++){c=g[o].toLowerCase(),k=0;
for(var p=0;j>p;p++)c.indexOf(i[p])>-1&&k++;i===c.substring(0,j)?(k++,n=!0):n=!1,c.length-j<3&&k++,c[0]!==i[0]&&j>4&&(k=null),null!==k&&n===!0?l.push({name:e(c),weight:k}):null!==k&&n===!1&&m.push({name:e(c),weight:k})}return l.length<1&&m.length>0?(l=m,b.isSuggestion=!0,b.resultsLimit=1):(b.isSuggestion=!1,b.resultsLimit=3),l}function e(a){for(var b=a.split(" "),c=b.length,d=[],e=0;c>e;e++)d.push(b[e].substr(0,1).toUpperCase()+b[e].substr(1));return d.join(" ")}function f(a){if(40===a.which)b.selectedIndex+1>b.matches.length||b.selectedIndex+1>b.resultsLimit?b.selectedIndex=0:b.selectedIndex++;else if(38===a.which)b.selectedIndex-1<0?b.selectedIndex=b.resultsLimit:b.selectedIndex--;else if(13===a.which){a.preventDefault();var c=angular.element(document.querySelector(".hover")),d=c.text();(b.selectedIndex===b.resultsLimit||b.selectedIndex===b.matches.length||-1===b.selectedIndex)&&(d=b.itemSearch),g(d)}}function g(a){h(b.itemSearch,a,b.groupName),b.itemKeyword=a,b.matchedItem=a}function h(b,c,d){a.dataLayer.push({category:"Item Search",action:"("+d+") Auto Complete Used",label:b+" - "+c})}function i(){b.matchedItem="",b.matches=[],b.getMatches=d,b.isSuggestion=!1,b.resultsLimit=3,b.selectedIndex=-1,b.keyboardNav=f,b.setItem=g,b.groupName=c.getGroupFromAnyKey(b.currentGroup,"key").name}a.dataLayer=a.dataLayer||[],i(),b.$watch(function(){return b.itemSearch},function(a){a!==b.matchedItem&&"f"===b.currentGroup?b.matches.length>0&&b.matches[0].name.toLowerCase()===a.toLowerCase()?b.matches=[]:(b.selectedIndex=-1,b.matches=b.getMatches(a)):b.matches=[]})}],link:function(a,c){var d='<ul ng-if="matches.length > 0 && itemSearch.length > 2 && inFocus===\'true\'" class="search-suggestions"><li ng-repeat="match in matches | orderBy: \'-weight\' | limitTo: resultsLimit as result" ng-click="setItem(match.name)" ng-class="{\'hover\':selectedIndex===$index}"><span ng-bind-html="match.name | highlightText:itemSearch" ng-class="{\'suggestion\':isSuggestion}"></span></li> <li ng-click="inFocus=\'false\'" ng-class="{\'hover\':selectedIndex===resultsLimit || selectedIndex===matches.length}"><em>or</em> search "<strong>{{itemSearch}}</strong>"</li> </ul>';c.after(b(d)(a)),c.on("keydown",function(b){a.keyboardNav(b)})}}}]),angular.module("dcomApp").directive("dcomStickyArrow",["$rootScope","$window","$timeout","ScrollHandler","JqliteHelper",function(a,b,c,d,e){return{template:'<a dcom-scrollto="#site-header-wrapper" ><span class="icon-up-arrow-thick"></span></a>',restrict:"A",link:function(a,f){function g(){h=d.getPosition(),j=h+i-o,j>=l&&n?(angular.element(m).css("position","absolute"),angular.element(m).css("bottom",p+"px"),n=!1):l>j&&!n&&(angular.element(m).css("position","fixed"),angular.element(m).css("bottom",o+"px"),n=!0)}var h,i,j,k,l,m=f[0],n=!0,o=parseInt(e.getStyle(m,"bottom").replace("px",""),10),p=parseInt(e.getStyle(document.getElementById("main-content"),"padding-bottom").replace("px",""),10),q=document.body,r=document.documentElement;a.$watch(function(){i=window.innerHeight,k=Math.max(q.scrollHeight,q.offsetHeight,r.clientHeight,r.scrollHeight,r.offsetHeight),l=k-p}),b.addEventListener("scroll",function(){g(),c(function(){g()},300)})}}}]),angular.module("dcomApp").directive("dcomStickySearch",["$rootScope","$timeout",function(a,b){return{template:'<div class="sticky-search" ng-class="{\'visible\':showStickySearch,\'hidden\':!showStickySearch}" ><div class="search-directive-wrapper" ng-class="{\'no-toggle\':currentGroup===\'l\'}"><div class="help-text">Enter your address<span class="desktop-only">&nbsp;to get started</span><span class="icon-quick-search-arrow"></span></div><div dcom-address-search checkbox-id="sticky-checkbox" is-sticky="true" ng-model="search.query" data-placeholder="{{ getSearchPlaceholder() }}" data-search-input-id="sticky-address-search" data-pickup-toggle="{{currentGroup!==\'l\'?\'true\':\'false\'}}" data-cta-text="{{ getCtaText() }}" class="search-form sticky-search-form" data-no-address-submit="noAddressSubmit"></div></div></div>',replace:!0,restrict:"A",scope:{spyOn:"@",currentGroup:"@"},link:function(c){var d=navigator.userAgent.toLowerCase();c.disabled=-1===d.search("safari")||-1===d.search("iphone")&&-1===d.search("ipad")||-1!==d.search("crios")||a.small?!1:!0,b(function(){c.showStickySearch=!1,c.$on(c.spyOn+"OutsideViewport",function(){return c.showStickySearch=!0,c.disabled?(c.showStickySearch=!1,!1):void(c.$$phase||c.$root.$$phase||c.$apply())}),c.$on(c.spyOn+"InsideViewport",function(){return c.disabled?(c.showStickySearch=!1,!1):(c.showStickySearch=!1,void(c.$$phase||c.$root.$$phase||c.$apply()))}),c.getSearchPlaceholder=function(){return"Street Address, City, State"},c.getCtaText=function(){return a.matchMedia.small?"Search":"Go"},document.getElementById("sticky-address-search")&&document.getElementById("sticky-address-search").addEventListener(function(a){a.preventDefault()})},100)}}}]),angular.module("dcomApp").directive("dcomDefaultResult",["$rootScope","Group","$compile","highlightTextFilter",function(a,b,c,d){return{restrict:"A",scope:{merchant:"=",filterText:"@",orderType:"=",sponsored:"="},controller:["$scope","$element","$rootScope","Group",function(a,b,c,d){a.matchMedia=c.matchMedia,a.group=d.currentGroup()}],link:function(a,b){function e(){var b=d(a.merchant.summary.name,a.filterText),c=0,e='<div class="result-item-wrapper">';if(a.matchMedia.smallPortrait&&a.merchant.merchant_logo&&(e+='<img class="merchant-logo b-lazy" src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" data-src="'+a.merchant.merchant_logo+'" width="94"  height="94"/>'),e+='<div class="merchant-info"><div class="row"><span class="textual-information name">'+b+"</span>",e+='<span class="ratings aside">',a.merchant.summary.num_ratings>0){for(var f=a.merchant.summary.star_ratings,g=Math.floor(a.merchant.summary.star_ratings),h=2*(f-g),i=5-g-h,j=0;g>j;j++)e+=0===h?'<span class="icon-star"></span>':'<span class="icon-star half-offset"></span>';for(var k=0;h>k;k++)e+='<span class="icon-half-star half-offset"></span><span class="icon-star grey"></span>';for(var l=0;i>l;l++)e+='<span class="icon-star grey"></span>';angular.isDefined(a.merchant.summary.num_ratings)&&(e+='<span class="votes">('+a.merchant.summary.num_ratings+")</span>")}if(e+='</span></div><div class="categories">',"f"===a.group){var m=d(a.merchant.merchant_cuisines,a.filterText);e+='<span class="textual-information cuisines">'+m+"</span>"}else{for(e+='<div class="textual-information icons">',c=0,c=0;c<a.merchant.summary.icons.length;c++){var n=a.merchant.summary.icons[c];e+='<span  class="'+n.icon+' tooltip-append-to-body="true" tooltip="'+n.tooltip+'" tooltip-placement="bottom"></span>'}e+="</div>"}var o="";(a.sponsored||a.merchant.summary.logistics_enabled||a.merchant.isNew)&&(o="has-tag"),e+='</div><div class="row middle"><div class="textual-information full-width-mobile '+o+'">';var p=Object.keys(a.merchant.summary.recommended_items).length>0||a.merchant.is_matching_items;if(p){var q=a.merchant.topItems,r="<b>"+("f"===a.group?"Top dishes: ":"Top items: ")+"</b>";if(""!==a.filterText&&a.merchant.is_matching_items||a.merchant.is_matching_name){r='<b class="matching">'+("f"===a.group?"Matching dishes: ":"Matching items: ")+"</b>";var s=[];angular.forEach(a.merchant.matched_items,function(a){s.push(a.name)}),s.length>0&&(q=s.join(", "))}var t=q;""!==a.filterText&&(t=d(q,a.filterText)),e+='<div class="top-dishes"><span>'+r+"</span><span>"+t+"</span></div>"}else!a.sponsored&&a.merchant.summary.logistics_enabled&&(e+='<div class="top-dishes"><span>&nbsp;</span></div>');return a.merchant.summary.timeConstraints&&(e+='<div class="alert time-constraints">'+a.merchant.summary.timeConstraints+"</div>"),e+='</div><div class="aside tags">',a.sponsored&&(e+='<div class="tag yellow">Sponsored</div>'),!a.sponsored&&a.merchant.summary.logistics_enabled&&(e+=a.matchMedia.small?'<div class="tag violet order-tracker" tooltip-append-to-body="true" tooltip-html-unsafe="Get automatic updates and<br /> track your order in real time<br />with your smartphone" tooltip-placement="bottom">Order<br />tracker</div>':'<div class="tag violet order-tracker">Order<br />tracker</div>'),a.sponsored||a.merchant.summary.logistics_enabled||!a.merchant.isNew||(e+='<div class="tag green">New!</div>'),e+='</div></div><hr><div class="row footer"><div class="textual-information">',a.merchant.ordering.minimum&&"delivery"===a.orderType&&a.matchMedia.mobileNew&&(e+='<span class="atom">$'+a.merchant.ordering.minimum+" min.</span>"),a.merchant.ordering.freeDelivery&&(e+='<span class="atom special"> Free delivery </span>'),a.merchant.deliveryFee&&(e+='<span class="atom">'+a.merchant.deliveryFee+"</span>"),a.merchant.ordering.highestDiscount>0&&(e+='<span class="atom special" tooltip-append-to-body="true" tooltip-html-unsafe="'+a.merchant.ordering.all_specials+'" tooltip-placement="bottom" >'+a.merchant.ordering.highestDiscount+"% off</span>"),e+="</div>",a.merchant.location.distance&&(e+=a.matchMedia.small?'<strong  class="aside" tooltip-append-to-body="true" tooltip-html-unsafe="'+a.merchant.location.street+" <br>	"+a.merchant.location.city+", "+a.merchant.location.state+" "+a.merchant.location.zip+'" tooltip-placement="bottom"> Distance:'+a.merchant.location.distance+" mi</strong>":'<strong  class="aside"> Distance:'+a.merchant.location.distance+" mi</strong>"),e+="</div></div></div>"}if(angular.isDefined(a.merchant)){if(b[0].innerHTML=e(),a.matchMedia.small){var f=c(b[0].innerHTML)(a),g=b[0].childNodes[0];angular.element(g).replaceWith(f)}a.$watch("filterText",function(d,f){if(""!==d&&d!==f||""===d&&""!==f){var g=c(e())(a),h=b[0].childNodes[0];angular.element(h).replaceWith(g)}})}}}}]).directive("dcomLaundryResult",["$rootScope","$compile","highlightTextFilter",function(a,b,c){return{restrict:"A",scope:{merchant:"=",filterText:"@",orderType:"=",sponsored:"=",showCartPrice:"="},controller:["$scope","$element","$rootScope","$filter",function(a,b,c,d){a.matchMedia=c.matchMedia,a.group="l",a.currencyFilter=d("currency")}],link:function(a,d){function e(){var b="<div>",d=0;a.matchMedia.smallPortrait&&a.merchant.merchant_logo&&(b+='<img class="merchant-logo" src="'+a.merchant.merchant_logo+'"/>');var e=c(a.merchant.summary.name,a.filterText);if(b+='<div class="merchant-info"><div class="row"><span class="textual-information name">'+e+"</span>",b+='<span class="ratings aside">',a.merchant.summary.num_ratings>0){var f=Math.round(a.merchant.summary.overall_rating/20);for(d=0;f>d;d++)b+='<span class="icon-star"></span>';for(var g=0;5-f>g;g++)b+='<span class="icon-star grey"></span>';angular.isDefined(a.merchant.summary.num_ratings)&&(b+='<span class="votes">('+a.merchant.summary.num_ratings+")</span>")}if(b+="</span></div>",a.matchMedia.smallPortrait){for(b+='<div class="categories"><div class="textual-information icons">',d=0,d=0;d<a.merchant.summary.icons.length;d++){var h=a.merchant.summary.icons[d];b+='<span  class="'+h.icon+' tooltip-append-to-body="true"  tooltip="'+h.tooltip+'" tooltip-placement="bottom"></span>'}b+="</div></div>"}return a.showCartPrice&&(b+='<div class="cart-price"><span>'+a.currencyFilter(a.merchant.ordering.anonymous_cart_price)+"</span></div>"),b+='<div class="row middle"><div class="textual-information full-width-mobile"><div class="delivery-times" ><span> Next pickup: </span><span> '+a.merchant.ordering.availability.firstPickupWindow+' </span></div><div class="delivery-times" ><span> Next delivery: </span><span> '+a.merchant.ordering.availability.firstDeliveryWindow+" </span></div></div>",b+=a.showCartPrice?'<div class="aside tags push-down">':'<div class="aside tags">',a.sponsored&&(b+='<div class="tag yellow">Sponsored</div>'),!a.sponsored&&a.merchant.summary.logistics_enabled&&(b+=a.matchMedia.small?'<div class="tag violet order-tracker" tooltip-append-to-body="true"  tooltip-html-unsafe="Get automatic updates and<br /> track your order in real time<br />with your smartphone" tooltip-placement="bottom">Order<br />tracker</div>':'<div class="tag violet order-tracker">Order<br />tracker</div>'),a.sponsored||a.merchant.summary.logistics_enabled||!a.merchant.isNew||(b+='<div class="tag green">New!</div>'),b+='</div></div><hr><div class="row footer"><div class="textual-information">',a.merchant.ordering.minimum&&(b+='<span class="atom" ng-if="::scope.merchant.ordering.minimum">$'+a.merchant.ordering.minimum+" minimum</span>"),a.merchant.ordering.freeDelivery&&a.matchMedia.smallPortrait&&(b+='<span class="atom special"> Free delivery </span>'),a.merchant.deliveryFee&&a.matchMedia.smallPortrait&&(b+='<span class="atom">'+a.merchant.deliveryFee+"</span>"),a.merchant.ordering.highestDiscount>0&&(b+='<span class="atom special" tooltip-append-to-body="true" tooltip-html-unsafe="'+a.merchant.ordering.all_specials+'" tooltip-placement="bottom" >'+a.merchant.ordering.highestDiscount+"% off</span>"),b+="</div>",a.merchant.location.distance&&(b+=a.matchMedia.small?'<strong  class="aside" tooltip-append-to-body="true"  tooltip-html-unsafe="'+a.merchant.location.street+" <br>	"+a.merchant.location.city+", "+a.merchant.location.state+" "+a.merchant.location.zip+'" tooltip-placement="bottom"> Distance:'+a.merchant.location.distance+" mi</strong>":'<strong  class="aside"> Distance:'+a.merchant.location.distance+" mi</strong>"),b+="</div></div></div>"}if(angular.isDefined(a.merchant)){if(d[0].innerHTML=e(),a.matchMedia.small){var f=b(d[0].innerHTML)(a),g=d[0].childNodes[0];angular.element(g).replaceWith(f)}a.$watch("filterText",function(c,f){if(""!==c&&c!==f||""===c&&""!==f){var g=b(e())(a),h=d[0].childNodes[0];angular.element(h).replaceWith(g)}})}}}}]),angular.module("dcomApp").directive("dcomTimeRemaining",function(){return{restrict:"A",template:'<div ng-if="displayCountdown" class="order-countdown"><span ng-if="timeLeft===0">&lt;1</span> <span ng-if="timeLeft!==0">{{timeLeft}}</span> min left to order</div>',scope:{timeLeft:"=ngModel",masterCounter:"="},controller:["$rootScope","$scope","$timeout","$location","$modal","Group","SearchLocation",function(a,b,c,d,e){function f(){var d=c(function(){b.timeLeft--,-1===b.timeLeft?(b.displayCountdown=!1,a.$broadcast("merchantClosed"),g()):f()},6e4);b.$on("$destroy",function(){c.cancel(d)})}function g(){e.open({template:'<div class="modal-header"><button type="button" class="close" ng-click="$dismiss(\'close\')" aria-hidden="true">&times;</button><h3>{{titleText}}</h3></div><div class="modal-body"><p ng-bind-html="message"></p></div><div class="modal-footer"><a ng-click="goTo(ctaLink)" class="button primary">{{ctaCopy}}</a></div>',windowClass:"future-confirm-modal",controller:["$scope","$location","Group","SearchLocation",function(a,b,c,d){var e,f=d.get();e=angular.isDefined(f.query)?"search":"home",a.titleText="No time left to order",a.message="This merchant has stopped accepting ASAP orders. Click to see who is still available.",a.ctaCopy="Search",a.ctaLink=e,a.goTo=function(a){switch(a){case"search":var d=c.getCurrentGroupPath();""!==d&&(d="/"+d),b.path("/search"+d),b.search({address:f.query});break;default:b.path("/")}}}]})}function h(a){return b.timeLeft<=a&&b.timeLeft>-1?!0:!1}function i(){var a=15;h(a)&&(b.displayCountdown=!0,b.masterCounter&&f()),b.$watch("timeLeft",function(){b.displayCountdown=h(a)})}i()}]}}),angular.module("dcomApp").directive("dcomSeoImage",["$timeout",function(a){return{restrict:"A",scope:{lazyLoad:"="},link:function(b,c){b.lazyLoad?(c[0].src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==",a(angular.isDefined(window.bLazy)&&null!==window.bLazy?function(){window.bLazy.revalidate()}:function(){window.bLazy=new Blazy})):a(function(){c[0].src=c[0].getAttribute("data-src"),c[0].classList.add("b-loaded")})}}}]),angular.module("dcomApp").directive("dcomTafShareLink",function(){return{restrict:"E",template:'<input type="text" value="{{shareLink}}">',replace:!0,link:function(a,b){b.on("click",function(){this.select(),this.focus(),this.setSelectionRange(0,9999)})}}}),angular.module("dcomApp").directive("dcomTooltipCloseOnClickAnywhere",["HammerEvents",function(a){return{restrict:"A",link:function(b,c,d){function e(){b.bind_id=a.onClick(document.body,h)}function f(){b.bind_id&&a.unbindClick(b.bind_id,h)}function g(a){return a&&"undefined"!=typeof a&&null!==a}var h=function(a){if("undefined"==typeof a)return!1;var b,d,e=c,f=angular.element(e);f.next()&&f.next()[0]&&(b=f.next()[0].querySelector(".tooltip-content"),d=f.next()[0].querySelector(".arrow")),e[0].getAttribute("id")!==a.target.getAttribute("id")&&a.target!==b&&a.target!==d&&f.next().hasClass("tooltip")&&(f.next().scope().$parent.isOpen=!1,f.next().scope().$parent.$apply())};g(d.tooltip)&&e(),d.$observe("tooltip",function(a){g(a)?e():f()}),b.$on("$destroy",function(){f()})}}}]),angular.module("dcomApp").filter("highlightText",function(){return function(a,b){if("undefined"==typeof b||"undefined"==typeof a)return a;if(b.length>0&&a.toLowerCase().indexOf(b.toLowerCase())>-1){var c=b.toLowerCase(),d=new RegExp(c,"gi");return a.replace(d,function(a){return'<span class="keyword">'+a+"</span>"})}return a}}),function(){angular.module("dcomApp").filter("phone",function(){function a(a){if("undefined"!=typeof a&&null!==a){var b=a.toString().replace(/[^0-9]/g,"");if(b.length>10&&(b=b.substring(0,10)),null!==b)return b}return null}function b(b){var c=a(b);return null!==c&&10===c.length&&(c="("+c.substring(0,3)+") "+c.substring(3,6)+"-"+c.substring(6,10)),c}return b})}(),angular.module("dcomApp").factory("ConnectionMonitor",["$q","SystemMessages",function(a,b){var c={noConnection:"Oops. We lost you! Please check your internet connection and try again."},d={404:c.noConnection};return{responseError:function(c){var e=c.status,f=!1;try{var g=c.config.url;null!==g.match(/.*\.html$/g)&&(f=!0)}catch(h){}return f&&e in d&&b.printError(d[e]),a.reject(c)}}}]),angular.module("dcomApp").service("Animation",["JqliteHelper",function(a){function b(a,b,c,d){var e,f,g,h=function(a,b){var c;return"easeInQuad"===a&&(c=b*b),"easeOutQuad"===a&&(c=b*(2-b)),"easeInOutQuad"===a&&(c=.5>b?2*b*b:-1+(4-2*b)*b),"easeInCubic"===a&&(c=b*b*b),"easeOutCubic"===a&&(c=--b*b*b+1),"easeInOutCubic"===a&&(c=.5>b?4*b*b*b:(b-1)*(2*b-2)*(2*b-2)+1),"easeInQuart"===a&&(c=b*b*b*b),"easeOutQuart"===a&&(c=1- --b*b*b*b),"easeInOutQuart"===a&&(c=.5>b?8*b*b*b*b:1-8*--b*b*b*b),"easeInQuint"===a&&(c=b*b*b*b*b),"easeOutQuint"===a&&(c=1+--b*b*b*b*b),"easeInOutQuint"===a&&(c=.5>b?16*b*b*b*b*b:1+16*--b*b*b*b*b),c||b},i=function(){return Math.max(document.body.scrollHeight,document.documentElement.scrollHeight,document.body.offsetHeight,document.documentElement.offsetHeight,document.body.clientHeight,document.documentElement.clientHeight)},j=window.pageYOffset,k=b,l=k-j,m=i(),n=0,o=function(a,b,c){var d=window.pageYOffset;(a===b||d===b||window.innerHeight+d>=m)&&clearInterval(c)},p=function(){n+=16,f=n/parseInt(c,10),f=f>1?1:f,g=j+l*h(d,f),window.scrollTo(0,Math.floor(g)),o(g,k,e)},q=function(){e=setInterval(p,16)};0===window.pageYOffset&&window.scrollTo(0,0),q()}function c(b,c,d,e,f){var g=document.getElementById(c);if(g){var h=g.style.position,i=g.style.visibility,j=g.style.display;e&&(g.style.position="absolute",g.style.visibility="hidden",g.style.display="block");var k=parseInt(a.getStyle(g,"height").replace("px",""),10)||g.clientHeight;e&&(g.style.position=h,g.style.visibility=i,g.style.display=j);var l,m,n,o=g.paddingTop||parseInt(a.getStyle(g,"padding-top").replace("px",""),10),p=g.paddingBottom||parseInt(a.getStyle(g,"padding-bottom").replace("px",""),10),q=g.style.overflowY,r=g.style.overflowX,s=g.style;s.overflowY="hidden",s.overflowX="hidden","up"===b?(s.height="0px",s.paddingTop="0px",s.paddingBottom="0px",l=k,m=o,n=p):(l=0,m=0,n=0,"down"===b&&(s.display="block"));var t=30,u=1e3,v=u*d/t,w=u*d/v,x=k/w,y=o/w,z=p/w,A=function(){"down"===b?(l+=x,m+=y,n+=z):(l-=x,m-=y,n-=z),0>l?(l=0,m=0,n=0):l>k&&(l=k,m=o,n=p),s.height=l+"px",s.paddingTop=m+"px",s.paddingBottom=n+"px","down"===b&&(k>l||o>m||p>n)||"up"===b&&(l>0||m>0||n>0)?setTimeout(A,v):("up"===b&&(s.display="none",s.height=k+"px",s.paddingTop=o+"px",s.paddingBottom=p+"px"),"function"==typeof f&&f(),s.overflowY=q,s.overflowX=r)};A()}}return{animateScrollto:b,slide:c}}]),angular.module("dcomApp.service.device",["dcomApp.config"]).provider("Device",["DcomConfig",function(a){var b=this;b.isMobileApp=function(){return"web"!==a.platform?!0:!1},b.$get=function(){return b}}]),angular.module("dcomApp").factory("UserAuthToken",["KeyValueStorage",function(a){var b="userAuthToken";return new a(b)}]).factory("GuestAuthToken",["KeyValueStorage",function(a){var b="guestAuthToken";return new a(b)}]),angular.module("dcomApp").service("CartAPI",["RequestBuilder","SearchLocation","Group",function(a,b,c){function d(a){var b={item_id:a.id,item_qty:a.quantity,option_qty:a.options,instructions:a.instructions};return b}function e(a,b){if(b=b||{},"l"===c.currentGroup()){a.laundry=!0;for(var d in b)angular.isDefined(b[d])&&(a[d]=b[d])}}function f(c,f,g,h){var i=b.get(),j={city:i.city,state:i.state,zip:i.zip,order_type:f.orderType,order_time:f.orderTime,latitude:i.latitude,longitude:i.longitude,item:d(c)};return e(j,{street:i.street,location_id:i.location_id}),g&&(j.recommendation=g,"gb"===g&&(j.recommendation+="-"+h)),a.getRequestPromise({method:"POST",url:l+"/"+f.merchant,authToken:!0,data:j})}function g(c,d){var f=b.get(),g={cart_index:c,order_type:d.orderType,order_time:d.orderTime,city:f.city,state:f.state,zip:f.zip,latitude:f.latitude,longitude:f.longitude};return e(g,{street:f.street,location_id:f.location_id}),a.getRequestPromise({method:"DELETE",url:l+"/"+d.merchant,authToken:!0,params:g})}function h(c,f){var g=b.get(),h={city:g.city,state:g.state,zip:g.zip,order_type:f.orderType,order_time:f.orderTime,item:d(c),cart_index:c.item_key,latitude:g.latitude,longitude:g.longitude};return e(h,{street:g.street,location_id:g.location_id}),a.getRequestPromise({method:"PUT",url:l+"/"+f.merchant,authToken:!0,data:h})}function i(c,d){var f=b.get(),g={order_type:c.orderType,order_time:c.orderTime,city:f.city,state:f.state,zip:f.zip,latitude:f.latitude,longitude:f.longitude};return e(g,{street:f.street,location_id:f.location_id,laundry_pickup_timestamp:null===d?void 0:d}),a.getRequestPromise({method:"GET",url:l+"/"+c.merchant,authToken:!0,disableErrorHandler:!0,params:g})}function j(b,c){var d={order_id:b};return"laundry"===c&&(d.laundry=!0),a.getRequestPromise({method:"POST",url:l+"/reorder",authToken:!0,disableErrorHandler:!0,data:d})}function k(c){var d=b.get(),f={};return e(f,{location_id:d.location_id}),a.getRequestPromise({method:"DELETE",url:l+"/"+c.merchant,authToken:!0,params:f})}var l="/customer/cart";return{addItem:f,removeItem:g,editItem:h,getCart:i,clearCart:k,reorder:j}}]),angular.module("dcomApp").service("Checkout",["$rootScope","$q","Carts","CheckoutAPI","RequestBuilder","$window","MerchantSearch","MerchantAPI",function(a,b,c,d,e,f,g,h){function i(a){var b=K[a],d={};if(d.adjustments=[],d.payments=[],d.tip=null,d.tipCash=!1,d.paymentDiscount=null,!k(a))return d;var e=b.availablePayments,f=b.payments,g=c.getInfo(a);if(d.checkoutTotal=g.total,angular.forEach(g.fees,function(a){d.checkoutTotal+=a.value}),"undefined"==typeof f.mainPayment)return d;if("undefined"==typeof e)return d;if(d.payments=x(a,f),d.phone=b.phone,d.addressUnit=b.addressUnit,d.specialInstructions=b.specialInstructions,v(d.payments))return d.checkoutTotal=g.subtotal+g.tax,angular.forEach(g.fees,function(a){d.checkoutTotal+=a.value}),g.discount&&(d.checkoutTotal-=g.discount),d;if(d.adjustments=y(f,b),d.tip=b.tip,d.paymentDiscount=d.adjustments.reduce(function(a,b){return a+b.amount},0),"undefined"==typeof g.total)return d;var h=parseFloat(d.tip);d.tip=isNaN(h)?0:h.toFixed(2),d.tipPercent=j(d.tip,g.subtotal);var i=g.total-d.paymentDiscount+parseFloat(d.tip);return d.checkoutTotal=i>0?i:0,d}function j(a,b){var c=100*a/b;return c=isNaN(c)?0:c.toFixed(0),"Infinity"===c?0:c}function k(a){return"undefined"!=typeof K[a]}function l(a){K[a];return k(a)?K[a].lastOrderPlaced:null}function m(a,b,c){k(a)&&(K[a].tip=b,K[a].tipCash=c,u())}function n(a){return k(a)?K[a].tip:void 0}function o(a){return k(a)?K[a].tipCash:void 0}function p(a,b){k(a)&&(K[a].addressUnit=b,u())}function q(a,b){k(a)&&(K[a].specialInstructions=b,u())}function r(a,b){k(a)&&(K[a].phone=b,u())}function s(a,b){k(a)&&(K[a].merchantName=b,u())}function t(a){return k(a)?d.getPaymentInfo(a).then(function(b){return K[a].availablePayments=b,b}):b.reject()}function u(){a.$broadcast("CheckoutChange")}function v(a){return a.filter(function(a){return"cash"===a.type}).length>0}function w(a,b){k(a)&&K[a].availablePayments.credit_card.push({id:b})}function x(a,b){var c=[];if("cash"===b.mainPayment.type)return c.push({type:"cash"}),c;if("paypal"===b.mainPayment.type)c.push({type:"paypal"});else{var d=C(a,b.mainPayment.id);c.push(null===d?{type:"credit_card"}:{type:"credit_card",id:d.id})}return b.promo&&c.push({type:"promo",id:b.promo}),angular.forEach(b.creditBalances,function(a,b){a&&c.push({type:"credit_balance",id:b})}),angular.forEach(b.giftCodes,function(a,b){a&&c.push({type:"gift_code",id:b})}),c}function y(a,b){var c=[],d=b.availablePayments,e=B(a.promo,b);null!==e&&c.push(e);var f=z(a.giftCodes,b.availablePayments.gift_code);null!==f&&c.push(f);var g=A(a.creditBalances,d.credit_balance);return null!==g&&c.push(g),c}function z(a,b){var c=0;return angular.forEach(a,function(a,d){if(a)for(var e=0;e<b.length;e++)if(d===b[e].id){c+=b[e].value;break}}),c>0?{type:"giftcard",name:"Credits:",amount:c}:null}function A(a,b){var c=0;return angular.forEach(a,function(a,d){if(a)for(var e=0;e<b.length;e++)if(d===b[e].id){c+=b[e].value;break}}),c>0?{type:"credit",name:"Account credits",amount:c}:null}function B(a,b){var d=b.availablePayments.promo;if("undefined"==typeof d)return null;var e=d.filter(function(b){return a===b.id});if(angular.isDefined(e[0])){if(e=e[0],!a)return null;if("dollar_off"===e.reward)return{type:"promo",name:e.name,amount:e.value,value:e.value,reward:e.reward};if("percent_off"===e.reward){var f=c.getInfo(b.merchant).subtotal,g=c.getInfo(b.merchant).discount;g>0&&(f-=g);var h=e.value/100*f;return null!==e.limitType&&null!==e.valueLimit&&(h=Math.min(h,e.valueLimit)),{type:"promo",name:e.name,value:e.value,amount:h,reward:e.reward}}if("points"===e.reward){var i={type:"promo",name:e.name,amount:0};return e.value&&(i.pointsValue=e.value),i}return{type:"promo",name:e.name,amount:0}}return null}function C(a,b){for(var c=K[a].availablePayments,d=0;d<c.credit_card.length;d++)if(b===c.credit_card[d].id)return c.credit_card[d];return null}function D(a,b){if(k(a)){var c=K[a];c.payments=b,u()}}function E(a){K[a]=K[a]||{merchant:a,lastOrderPlaced:null}}function F(a){f.dishRec&&h.getDishRecOrderInfo(a).then(function(a){if(a&&a.items){{a.items.length}if(a.recType&&a.items.length)for(var b="go_bask"===a.recType.toLowerCase()?"BaskPredict":"Top Dishes",c=0;c<a.items.length;c++)f.dataLayer.push({event:"OrderAction",eventCategory:"Dish Reco",eventAction:"Dish Reco Purchased - "+b+", Logged In",eventLabel:a.items[c].item_name+" - "+a.items[c].restaurant_name,eventValue:a.items[c].price})}})}function G(b){for(var c=[],d=K[b.merchant_id].merchantName,e=b.cartInfo.fees,g=e.length,h=0,i=0;g>i;i++)h+=parseFloat(e[i].value);var j=b.cartInfo.total-b.cartInfo.tax-h;angular.forEach(b.cartItems,function(a){c.push({name:a.name,id:a.id,price:a.price/a.quantity,quantity:a.quantity,brand:d})}),0!==b.cartInfo.discount&&"undefined"!=typeof b.cartInfo.discount&&c.push({id:"DISCOUNT",name:"Discount",price:-b.cartInfo.discount,quantity:1,brand:d}),0!==b.tip&&"undefined"!=typeof b.tip&&c.push({id:"TIP",name:"Tip",price:b.tip,quantity:1,brand:d}),angular.forEach(b.checkoutInfo.adjustments,function(a){c.push({id:a.name,name:a.name,price:-a.amount,quantity:1,brand:d})});var k,l,m=angular.isDefined(a.userData.life_time_delivery_points)&&null!==a.userData.life_time_delivery_points?a.userData.life_time_delivery_points:-1;0===m?(k=1,l=0):(k=0,l=1);var n=angular.isDefined(a.userData.customer_id)&&null!==a.userData.customer_id?a.userData.customer_id:-1,o=angular.isDefined(a.userData.life_time_orders_count)&&null!==a.userData.life_time_orders_count?a.userData.life_time_orders_count:-1;f.dataLayer.push({event:"OrderAction",eventCategory:"Order Confirm",eventAction:"Order Confirm - Checkout Complete",eventLabel:"merchant:"+d+" - id:"+b.merchant_id+" - order#"+b.order_id,ecommerce:{purchase:{actionField:{id:b.order_id,affiliation:b.merchant_id,revenue:j,tax:b.cartInfo.tax},products:c}},userId:n,numOrders:o,firstOrder:k,existingUser:l}),window.optimizely=window.optimizely||[],window.optimizely.push(["trackEvent","orderPlaced",{revenue:100*b.cartInfo.total}])}function H(a){var c=b.defer();return e.getRequestPromise({method:"POST",url:"/paypal/express/start",authToken:!0,data:a}).then(function(a){c.resolve(a)}),c.promise}function I(a,d){{var f=b.defer(),g=K[a];c.getInfo(a)}return e.getRequestPromise({method:"POST",url:"/paypal/express/checkout/"+a,authToken:!0,data:d}).then(function(b){var e=i(a);d.merchant_id=a,d.checkoutInfo=e,d.payments=e.payments,d.cartInfo=c.getInfo(a),d.cartItems=c.getItems(a),null!==d.tip&&(d.tip=g.tip);var h=d;h.order_id=b.order_id,h.delivery_points=b.delivery_points,g.lastOrderPlaced=h,f.resolve(b)}),f.promise}function J(a,e){if(!k(a))return b.reject();{var f=K[a];c.getInfo(a)}return e.merchant_id=a,e.checkoutInfo=i(a),e.cartInfo=c.getInfo(a),e.cartItems=c.getItems(a),e.payments=i(a).payments,null!==e.tip&&(e.tip=f.tip),d.checkout(a,e).then(function(a){g.overrideCacheForNextSearch(),g.overrideCacheForNextMerchantUpdate();var b=e;return b.order_id=a.order_id,b.delivery_points=a.delivery_points,f.lastOrderPlaced=b,b}).then(function(a){return a})}f.dataLayer=f.dataLayer||[];var K={};return{checkout:J,payPalCheckout:I,getCheckoutInfo:i,getPayPalInfo:H,getLastOrder:l,getPaymentMethods:t,initializeCheckout:E,setPaymentMethods:D,makeNewCCAvailable:w,setTip:m,getTip:n,isTipInCash:o,setSpecialInstructions:q,setAddressUnit:p,setPhone:r,setMerchantName:s,sendOrderInfo:G,trackDishRecPurchase:F}}]).service("CheckoutProvider",["Checkout",function(a){function b(b){this.setAddressUnit=function(c){return a.setAddressUnit(b,c)},this.setSpecialInstructions=function(c){return a.setSpecialInstructions(b,c)},this.setTip=function(c,d){return a.setTip(b,c,!!d)},this.getTip=function(){return a.getTip(b)},this.isTipInCash=function(){return a.isTipInCash(b)},this.setPhone=function(c){return a.setPhone(b,c)},this.setMerchantName=function(c){return a.setMerchantName(b,c)},this.getPaymentMethods=function(){return a.getPaymentMethods(b)},this.setPaymentMethods=function(c){return a.setPaymentMethods(b,c)},this.makeNewCCAvailable=function(c){return a.makeNewCCAvailable(b,c)},this.getCheckoutInfo=function(){return a.getCheckoutInfo(b)},this.getPayPalInfo=function(b){return a.getPayPalInfo(b)},this.payPalCheckout=function(c){return a.payPalCheckout(b,c)},this.checkout=function(c){return a.checkout(b,c)},this.getLastOrder=function(){return a.getLastOrder(b)},this.sendOrderInfo=function(b){return a.sendOrderInfo(b)},this.trackDishRecPurchase=function(b){return a.trackDishRecPurchase(b)}}function c(c){return a.initializeCheckout(c),new b(c)}return{get:c}}]),angular.module("dcomApp").service("CheckoutAPI",["$q","RequestBuilder","CartProvider","Group","SearchLocation","MerchantReferral","Cookies",function(a,b,c,d,e,f,g){function h(f){var g=c.get(f),h={order_type:g.getOrderType(),order_time:g.getOrderTime()};if("l"===d.currentGroup()){var i=e.get();h.laundry=!0,h.location_id=i.location_id}return b.getRequestPromise({method:"GET",url:j+"/"+f+"/checkout",authToken:!0,params:h}).then(function(b){if("undefined"==typeof b.payment_methods)return a.reject();var c=b.payment_methods;return c.gift_code=c.gift_code||{},c.credit_balance=c.credit_balance||{},c.allowed_payment_methods=b.allowed_payment_methods||{},c.disallowed_payment_methods=b.disallowed_payment_methods||{},c
})}function i(a,h){var i=c.get(a),k={tip:h.tip,order_type:h.order_type,order_time:h.order_time,location_id:h.location_id,payments:h.checkoutInfo.payments,merchant_id:a,instructions:h.instructions,save_instructions:h.save_instructions},l=angular.isDefined(g.getCookie("uhauid"))?g.getCookie("uhauid"):!1;if(l&&(k.uhau_id=l),angular.isDefined(h.phone_number)&&""!==h.phone_number&&(k.phone_number=h.phone_number),"l"===d.currentGroup()){var m=e.get(),n=i.getInfo();k.laundry=!0,angular.isDefined(k.location_id)&&null!==k.location_id||(k.location_id=m.location_id),k.laundry_pickup_time=n.laundry_pickup_time,k.laundry_delivery_time=n.laundry_delivery_time}return null!==f.param()&&(k.order_tracking=f.param()),b.getRequestPromise({method:"POST",url:j+"/"+a+"/checkout",authToken:!0,data:k})}var j="/customer/cart";return{getPaymentInfo:h,checkout:i}}]),angular.module("dcomApp").service("Cookies",function(){function a(a){var b;try{b=JSON.parse(a)}catch(c){return a}return b}function b(a){var b=a.hoursAfter(Date.create());return b}function c(b){return a(f(b))}function d(a,b,c){return"object"==typeof b&&(b=JSON.stringify(b)),"object"==typeof c?(c.path="/","number"==typeof c.expires&&(c.expires=24*c.expires*60*60)):c={path:"/"},f(a,b,c)}function e(a){return f(a,void 0,{path:"/"})}var f=Cookies;return{setExpInHours:b,getCookie:c,setCookie:d,deleteCookie:e}}),angular.module("dcomApp").service("headerImages",["$rootScope","$filter","$window",function(a,b,c){function d(a,b){if(void 0!==a&&0!==a.length){var d=c.devicePixelRatio;void 0===d&&(d=c.screen.deviceXDPI/c.screen.logicalXDPI);var e,f,g,h,i=b*d,j=null,k=!1,l=a.length;if(d>=2.5){for(e=0;l>e;e++)f=a[e],g=Math.abs(i-f.width),"480"===f.height&&(k||(h=g,j=f,k=!0),h>=g&&(h=g,j=f));if(null!==j)return j.path;k=!1}if(d>=1.5){for(e=0;l>e;e++)f=a[e],g=Math.abs(i-f.width),"160"!==f.height&&(k||(h=g,j=f,k=!0),h>=g&&(h=g,j=f));if(null!==j)return j.path;k=!1}var m=704,n=1280;for(e=0;l>e;e++)f=a[e],g=Math.abs(i-f.width),m>=b&&"160"===f.height||b>m&&n>=b&&"1536"!==f.width&&"1920"!==f.width||(k||(h=g,j=f,k=!0),h>=g&&(h=g,j=f));return null===j&&(j=f),j.path}}return{selectImageHeaderSize:d}}]),angular.module("dcomApp").service("HomeImages",["$rootScope","$window",function(a,b){function c(a,b){for(var c=0;c<e.length;c++)if(e[c].width>a&&e[c].portrait===b)return e[c];return e[e.length-1]}function d(a){if(a){var d=a.height>a.width,e=b.devicePixelRatio||1,f=a.width*e,g=c(f,d);return g.width+"x"+g.height}}var e=[{portrait:!0,width:320,height:330},{portrait:!0,width:640,height:660},{portrait:!0,width:1080,height:1470},{portrait:!1,width:1280,height:660},{portrait:!1,width:1920,height:800}];return{getDimensions:d}}]),angular.module("dcomApp").service("HammerEvents",function(){function a(a){function b(a){for(var b=0;b<f.length;b++){var c=f[b][0],d=f[b][1];if(Math.abs(a.clientX-c)<g&&Math.abs(a.clientY-d)<g){a.stopPropagation(),a.preventDefault();break}}}function c(){f=[]}function d(){f.splice(0,1)}function e(a){if(a.touches.length-a.changedTouches.length<=0){var b=a.changedTouches[0];f.push([b.clientX,b.clientY]),setTimeout(d,h)}}var f=[],g=25,h=2500;"ontouchstart"in window&&(a.addEventListener("touchstart",c,!0),a.addEventListener("touchend",e,!0),document.addEventListener("click",b,!0))}function b(b,c){a(b);var e=(new Date).getTime(),f=new Hammer(b);return d[e]=f,f.on("tap",function(){c.apply(this,arguments)}),e}function c(a,b){var c=d[a];c&&c.off("tap",b)}var d=[];return{onClick:b,unbindClick:c}}),angular.module("dcomApp").service("LaundryPriceCompare",function(){function a(a){var b=[];if(a)for(var c=0;c<a.length;c++){var d=a[c];if(d){var e=d.options;if(e&&e.length)for(var f=0;f<e.length;f++)e[f].id&&b.push({id:e[f].id,qty:1})}}return b}function b(a){var b=[];if(a)for(var c=0;c<a.length;c++){var d=a[c].options;if(d)for(var e=0;e<d.length;e++)d[e]&&d[e].required_option&&d[e].checked_for_default&&b.push({id:d[e].id,qty:1})}return b}function c(a){return/wash/gi.test(a.name)&&/fold/gi.test(a.name)}function d(d,e){c(d)||(e=d.quantity?d.quantity:1);var f;return f=d.price_compare_item&&!d.uuid?b(d.options):a(d.options),{item_id:d.id,item_qty:e,option_qty:f,instructions:d.instructions||""}}function e(a,b){var d;"current"===a?d=v:"previous"===a&&(d=u);for(var e=0,f=0;f<d.length;f++)c(d[f])?"previous"!==a||b||(e+=1):e+=d[f].quantity||1;return b&&b>0&&(e+=1),e}function f(a){for(var b=0,c=0;c<v.length;c++)v[c].id===a&&(b+=v[c].quantity||1);return b}function g(){for(var a=0;a<v.length;a++)if(c(v[a]))return v[a].quantity}function h(a){for(var b=0;b<v.length;b++)if(v[b].id===a)return!0;return!1}function i(a){for(var b=v.length;b--;)v[b].id===a&&v.splice(b,1)}function j(a){for(var b=v.length-1;b>=0;b--)if(v[b].id===a)return void(v[b].quantity&&v[b].quantity>1?v[b].quantity-=1:v.splice(b,1))}function k(){for(var a=0;a<v.length;a++)if(c(v[a]))return void v.splice(a,1)}function l(a){for(var b=0;b<v.length;b++)if(v[b].id===a.id&&!v[b].uuid)return void(v[b].quantity?v[b].quantity++:v[b].quantity=2);v.push(a)}function m(a){return a&&(w=a),w}function n(a){return a&&(u=a),u}function o(a){return a&&(v=a),v}function p(){v=u}function q(){v=[]}function r(a,b){b=b||{};var c;return c=b.wnfQuantity?b.wnfQuantity:g(),a.map(function(a){return d(a,c)})}function s(){for(var a={dryclean:[],tailoring:[]},b=0;b<v.length;b++)v[b].price_compare_item||(v[b].category&&"tailoring"===v[b].category.toLowerCase()?a.tailoring.push(v[b]):a.dryclean.push(v[b]));return a}function t(a,b){var c=f(a);return c>1&&x[b]&&(b=x[b]),c?c+" "+b:b}var u=[],v=[],w={},x={"Bed Spread":"Bed Spreads",Bra:"Bras",Blanket:"Blankets","Blouse/Top":"Blouses/Tops",Button:"Buttons",Coat:"Coats",Curtain:"Curtains",Comforter:"Comforters",Dress:"Dresses","Duvet Cover":"Duvet Covers",Hemming:"Hemming",Jacket:"Jackets",Pants:"Pants",Patch:"Patches",Pillow:"Pillows","Pillow Case":"Pillow Cases",Rug:"Rugs",Scarf:"Scarves",Sheets:"Sheets",Shirt:"Shirts",Shorts:"Shorts",Skirt:"Skirts",Suit:"Suits",Sweater:"Sweaters",Tablecloth:"Tablecloths",Tag:"Tags",Tie:"Ties",Tunic:"Tunics",Zipper:"Zippers"};return{priceCompareItems:m,getCartNbItems:e,getCurrentQuantity:f,getWnfQuantityFromItem:g,inCurrentCart:h,removeAllItemsById:i,removeLastItem:j,removeWashFoldFromCurrent:k,addItem:l,previousCart:n,currentCart:o,syncCarts:p,clearCurrentCart:q,formatCartForPost:r,getExtraCartItems:s,getCountText:t}}),angular.module("dcomApp").service("MerchantSearch",["$q","$rootScope","$location","SearchAPI","SearchLocation","ItemSearchKeyword","Group","$timeout",function(a,b,c,d,e,f,g,h){function i(a,b,c,d){var e=!d||d===f.lastItemKeyword();return!S&&b===Q.orderTime&&c===Q.orderType&&(a===Q.query||a===Q.shortAddress)&&Date.create()<10..minutesAfter(Q.timeRetrieved)&&e}function j(c,e,g,j,k){{var l=a.defer();!j||j===f.lastItemKeyword()}return k&&i(c,e,g,j)?d.searchByAddress(c,j,k).then(function(a){C(a),l.resolve(Q.data)},function(a){l.reject({message:a})}):i(c,e,g,j)?h(function(){l.resolve(Q.data)},1e3):(S=!1,d.searchByAddress(c,j).then(function(a){f.lastItemKeyword(j),c!==Q.query&&c!==Q.shortAddress&&t(),a.merchants&&("undefined"==typeof a.search_address.zip&&(a.search_address.zip=a.search_address.zip_code),s(a.search_address),Q={query:c,shortAddress:a.search_address.street+", "+a.search_address.zip_code,data:a,orderTime:e,orderType:g,timeRetrieved:Date.create()},b.search=b.search||{},b.search.query=Q.query),l.resolve(a)},function(a){l.reject(a)})),R=!1,l.promise}function k(a){var b=!1,c=[{name:"restaurant",key:"R"},{name:"bakery",key:"B"},{name:"butcher",key:"T"},{name:"health-beauty",key:"H"},{name:"wine-liquor",key:"W"}];return angular.forEach(c,function(c){c.name===a&&(b=c.key)}),b}function l(a){return d.searchByTags("city",a)}function m(){return R}function n(a){return"undefined"!=typeof a&&(I=a),I}function o(a){a=a||{};for(var b in a)L[b]=a[b];return L}function p(a){return"undefined"!=typeof a&&(J=a),J}function q(a){return"undefined"!=typeof a&&(K=a),K}function r(a){return"undefined"==typeof a?M:void(M=a)}function s(a){if("undefined"==typeof a)return e.get();var b={query:a.street+", "+a.zip,latitude:a.latitude.toString(),longitude:a.longitude.toString(),street:a.street,city:a.city,state:a.state,zip:a.zip};e.set(b,365)}function t(){I=[],J=[],K=[],M="",N="distance",P=0}function u(a){return"undefined"==typeof a?N:void(N=a)}function v(){N=O}function w(a){return"undefined"==typeof a?P:void(P=a)}function x(){S=!0}function y(){S=!1}function z(){T=!0}function A(){T=!1}function B(){return T}function C(a){D(a.merchants,Q.data.merchants),E(a.categories,Q.data.categories),F(a.vertical_breakdown_count[0],Q.data.vertical_breakdown_count),H(a.verticals,Q.data.verticals),Q.data.anonymous_cart=a.anonymous_cart,Q.data.price_compare_items=a.price_compare_items,Q.data.laundry_filter_times=a.laundry_filter_times}function D(a,b){for(var c=b.length;c--;)"LA"===b[c].summary.type&&b.splice(c,1);for(var d=0;d<a.length;d++)b.push(a[d])}function E(a,b){for(var c=g.getGroupFromAnyKey("l","key").categories,d=b.length;d--;)-1!==c.indexOf(b[d].name)&&b.splice(d,1);for(var e=0;e<a.length;e++)b.push(a[e])}function F(a,b){for(var c=0;c<b.length;c++)if("Laundry"===b[c].name)return void(a?b[c]=a:G(b[c]));a&&b.push(a)}function G(a){for(var b in a)"name"!==b&&(a[b]=0)}function H(a,b){for(var c=g.getGroupFromAnyKey("l","key").verticals,d=b.length;d--;)-1!==c.indexOf(b[d].short_name)&&b.splice(d,1);for(var e=0;e<a.length;e++)b.push(a[e])}var I=[],J=[],K=[],L={},M="",N="distance",O="distance",P=0,Q={query:"",shortAddress:"",data:{},orderTime:"",orderType:"",timeRetrieved:Date.create(0)},R=!1,S=!1,T=!1;return{search:j,showSeoSearch:m,isVertical:k,searchBySeoTag:l,cuisineFilters:n,otherFilters:o,neighborhoodFilters:p,zipFilters:q,filterText:r,resetFilters:t,sortBy:u,setDefaultSort:v,vertical:w,overrideCacheForNextSearch:x,overrideCacheForNextMerchantUpdate:z,removeOverrideSearchCache:y,removeOverrideMerchantCache:A,getOverrideMerchantCache:B}}]),angular.module("dcomApp").service("Storage",["Cookies",function(a){function b(b,c,d){d=void 0===d?null:d;var e={expires:d};a.setCookie(b,c,e)}function c(b){a.deleteCookie(b)}function d(b){return a.getCookie(b)}function e(a){return void 0!==d(a)}return{unset:c,set:b,get:d,has:e}}]).factory("KeyValueStorage",["Storage",function(a){return function(b,c){this.get=function(){var d=a.get(b);return"undefined"==typeof d?c:d},this.set=function(c,d){a.set(b,c,d)},this.isSet=function(){return a.has(b)},this.unset=function(){a.unset(b)}}}]),angular.module("dcomApp").service("FeedbackAPI",["RequestBuilder","Group",function(a,b){function c(c){var d={};return"l"===b.currentGroup()&&(d.laundry=!0),a.getRequestPromise({method:"GET",url:"/merchant/"+c+"/reviews",authToken:!0,params:d})}function d(b){return a.getRequestPromise({method:"POST",url:e,authToken:!0,data:b})}var e="/cs/contact";return{getMerchantReviews:c,sendcontactForm:d}}]),angular.module("dcomApp").service("JqliteHelper",function(){function a(a,b){for(;a;){if(b(a))return a;a=a.parentNode}}function b(a){var b=document.getElementById(a);if(b){for(var c=0;b;)c+=b.offsetTop,b=b.offsetParent;return c}}function c(a){return a?!(0===a.offsetWidth&&0===a.offsetHeight):void 0}function d(a,b){var c,d=document.defaultView||window;return d.getComputedStyle?(c=d.getComputedStyle(a,""),c?c.getPropertyValue(b):""):a.currentStyle?(c=a.currentStyle,c.currentStyle[b]):(c=a.style,c[b])}function e(a,b,c){for(var d=document.querySelectorAll(a),e=0;e<d.length;e++)b.call(c,d[e])}function f(a,b,c){e(a,function(a){a[b]=c})}return{getOffsetTop:b,isVisible:c,getStyle:d,closest:a,applyToElements:e,addPropertyToElements:f}}),angular.module("dcomApp").service("ItemSearchKeyword",function(){function a(a){return"undefined"!=typeof a&&(g=a),g}function b(a){return"undefined"!=typeof a&&(h=a),h}function c(a){i={};for(var b in a)i[a[b].name.toLowerCase()]={name:a[b].name,score:a[b].score}}function d(){return i}function e(){return Object.keys(i)}function f(){return j}var g="",h="",i={},j=4;return{lastItemKeyword:a,menuSearchKeyword:b,setMatchedItems:c,getMatchedItems:d,getMatchedItemNames:e,getDefaultAlgo:f}}),angular.module("dcomApp").service("Group",["$q","$rootScope","$routeParams","$location",function(a,b,c,d){function e(a,b){var c=0,d=null;return angular.forEach(u,function(e){e[b].toLowerCase()===a.toLowerCase()&&(d=c),c++}),d}function f(a,b){var c=null;return angular.forEach(u,function(d){d[b].toLowerCase()===a.toLowerCase()&&(c=d)}),c}function g(){var a=c.group;if(d.search().alcohol?a="alcohol":d.search().groceries?a="groceries":d.search().laundry&&(a="laundry"),"undefined"==typeof a)return f("","param");var b=f(a,"param");return null===b&&(b=f(a,"name")),b}function h(){if("undefined"==typeof c.group)return null;var a=e(c.group,"param");return null!==a?a:-1}function i(a){return e(a,"key")}function j(){var a=[];return angular.forEach(u,function(b){b.show_home&&a.push(b)}),a}function k(){var a=[];return angular.forEach(u,function(b){b.show_search&&a.push(b)}),a}function l(a){var b=null;return angular.forEach(u,function(c){c.key.toLowerCase()===a.toLowerCase()&&(b=c.param)}),b}function m(a){if("undefined"!=typeof a)v=a;else if(null!==v)return v;return null}function n(){return null===v?"":l(v)}function o(a,b){for(var c=[],d=0;d<u.length;d++)-1!==u[d][a].indexOf(b)&&c.push(u[d]);return c.length>0?c:null}function p(a){return o("verticals",a)}function q(a){return o("categories",a)}function r(){if("undefined"==typeof c.vertical)return null;for(var a=0;a<u.length;a++)if(-1!==u[a].verticals.indexOf(c.vertical))return v=u[a].key;return null}function s(a,b){return a.order<b.order?-1:a.order>b.order?1:0}function t(a){return a.sort(s)}var u=[{name:"Food",SEOname:"Restaurants",SEOUrl:"/categories/food",key:"f",categories:["Restaurant","Catering"],param:"",verticals:["restaurant","caterer"],show_search:!0,show_home:!0,show_futureOrdering:!0,order:1,searchTemplate:"food-result.html",filters:["single","cuisines","categories","rating","minimums"]},{name:"Alcohol",SEOname:"Wine & Liquor stores",SEOUrl:"/categories/alcohol",SEOHeaderTitle:"Beer, Wine & Alcohol Delivery and Pickup",SEOTextTitle:"Your alcohol. Delivered.",SEOTextDescription:"Get drinks delivered to your door with delivery.com. Whether you need a few of your favorite beers, a quick bottle of wine, or a full bar worth of liquor, ordering online is the fastest and easiest option.",key:"b",categories:["Wine and Liquor","Beer","Tobacco"],param:"alcohol",verticals:["wine-and-liquor-store","tobacco-shop"],show_search:!0,show_home:!0,show_futureOrdering:!0,order:2,searchTemplate:"food-result.html",filters:["single","categories","rating","minimums"]},{name:"Groceries",SEOname:"Grocery stores",SEOUrl:"/categories/groceries",SEOHeaderTitle:"Groceries and Essentials for Delivery and Pickup",SEOTextTitle:"Your neighborhood. Delivered.",SEOTextDescription:"Need something from the store? Don’t get up, get delivery! From snacks and drinks to toothpaste and paper towels, everything you need is closer than you think.",key:"g",categories:["Grocery","Butcher Shop","Tobacco","Pets"],param:"groceries",verticals:["grocery-store","butcher-shop"],show_search:!0,show_home:!0,show_futureOrdering:!0,order:3,searchTemplate:"food-result.html",filters:["single","categories","rating","minimums"]},{name:"Laundry",SEOname:"Dry Cleaners and Laundry Services",SEOUrl:"/categories/laundry",SEOHeaderTitle:"Schedule Laundry and Dry Cleaning in Your Neighborhood",SEOTextTitle:"Your clean clothes. Delivered.",SEOTextDescription:"Forget about doing laundry! You can get your dirty duds picked up and your clean clothes delivered. Find the best local cleaner based on reviews and ratings; choose from wash & fold, dry cleaning, tailoring and more; and easily arrange pickup and delivery with flexible scheduling.",key:"l",categories:["Wash & fold","Dry cleaning","Tailoring"],param:"laundry",verticals:["cleaner"],show_search:!0,show_home:!0,show_futureOrdering:!1,order:4,searchTemplate:"laundry-result.html",sort:[{key:"pickup",displayName:"Pickup time",activeText:"pickup",sortField:"pickup"}],filters:["single","categories","rating","minimums"]},{name:"Household",key:"h",categories:["Home Essentials","Health and Beauty","Office Supply"],param:"household",verticals:["household","health-and-beauty-store","office-supply","florist"],show_search:!1,show_home:!1,show_futureOrdering:!0,order:6,searchTemplate:"food-result.html",filters:[]}],v=null;return{getHomeEnabled:j,getSearchEnabled:k,getIndexFromAnyKey:e,getIndexFromUrl:h,getIndexFromKey:i,getPath:l,currentGroup:m,getGroupFromAnyKey:f,getGroupFromUrl:g,loadFromVerticalUrl:r,getCurrentGroupPath:n,getFromCategory:q,getFromVertical:p,sortByOrder:t}}]),angular.module("dcomApp").service("LocationAPI",["RequestBuilder","Group",function(a,b){function c(c){var d=g,e={};return"l"===b.currentGroup()&&(e.laundry=!0),angular.isDefined(c)&&"recent"===c&&(e.recent=!0),a.getRequestPromise({method:"GET",url:d,authToken:!0,params:e})}function d(c){var d={street:c.street,city:c.city,state:c.state,zip_code:c.zipCode,unit_number:c.unit,company:c.company,cross_streets:c.crossStreet,phone:c.phone};return"l"===b.currentGroup()&&(d.laundry=!0),a.getRequestPromise({method:"POST",url:g,authToken:!0,data:d})}function e(c){var d={street:c.street,city:c.city,state:c.state,zip_code:c.zipCode,unit_number:c.unit,company:c.company,cross_streets:c.crossStreet,phone:c.phone};return"l"===b.currentGroup()&&(d.laundry=!0),a.getRequestPromise({method:"PUT",url:g+"/"+c.id,authToken:!0,data:d})}function f(b){return a.getRequestPromise({method:"DELETE",url:g+"/"+b,authToken:!0})}var g="/customer/location";return{get:c,create:d,edit:e,remove:f}}]),angular.module("dcomApp").service("ModalPages",["$q","$modal","User",function(a,b,c){function d(d){var f=a.defer();if(d=e[d],d.mustBeGuest&&c.getUserAuthToken())f.reject();else{var g=b.open({templateUrl:d.template,windowClass:d.windowClass,controller:d.controller});g.result.then(function(a){f.resolve(a)},function(){f.reject()})}return f.promise}var e={login:{template:"views/modals/userLogin.html",windowClass:"user-login-modal",controller:"LoginCtrl",mustBeGuest:!0},signup:{template:"views/modals/userSignUp.html",windowClass:"user-signup-modal",controller:"RegisterCtrl",mustBeGuest:!0},password_reset:{template:"/views/modals/userPasswordReset.html",windowClass:"user-password-reset-modal",controller:"PasswordResetCtrl"}};return{openPage:d}}]),angular.module("dcomApp").service("Merchant",["MerchantAPI","$q","SearchLocation","$routeParams","$rootScope","SessionCache",function(a,b,c,d,e,f){function g(){var a=f.get("merchant");return a.data?a.data:null}function h(a,b){var c={};c.merchant_id=a.merchant.id,c.merchant_stub=a.merchant.summary.url.short_tag,c.merchant_data=a,c.user_address=b,f.store("merchant",c)}function i(){var a=d.merchantId;return angular.isDefined(a)||(a=d.urlStub),a}function j(d){var e=b.defer(),g=f.get("merchant");if(angular.isDefined(d)||(d=i()),angular.isDefined(d)){var j=c.get(),l=!1;if(!g.data||g.data.merchant_id!==d&&g.data.merchant_stub!==d?l=!0:angular.isDefined(j.query)&&""!==j.query&&(g.data.user_address!==j.query||f.hasExpired("merchant"))&&(l=!0),l){var m=!1;a.getMerchantInfo(d,j.query,m).then(function(a){h(a,j.query),e.resolve(a),k(a)},function(){e.reject()})}else e.resolve(g.data.merchant_data),k(g.data.merchant_data)}else e.reject();return e.promise}function k(a){e.$broadcast("merchantInfoLoaded",a)}function l(a){var e=b.defer(),g=f.get("merchant");return angular.isDefined(d.merchantId)?(e.resolve(d.merchantId),e.promise):(angular.isDefined(a)||(a=d.urlStub),angular.isDefined(a)||(a=d.urlStub),angular.isDefined(a)||e.reject(),g.data&&g.data.merchant_stub===a?(e.resolve(g.data.merchant_id),e.promise):j(a).then(function(a){var b=c.get();return h(a,b.query),a.merchant.id?a.merchant.id:e.reject()},function(){return e.reject()}))}function m(a){var d=b.defer(),e=f.get("merchant");return angular.isDefined(a)||(a=i()),angular.isDefined(a)||d.reject(),!e.data||e.data.merchant_id!==a&&e.data.merchant_stub!==a?j(a).then(function(a){var b=c.get();return h(a,b.query),a.merchant.ordering?a.merchant.ordering:d.reject()},function(){return d.reject()}):(d.resolve(e.data.merchant_data.merchant.ordering),d.promise)}var n=1;return f.initialize("merchant",n),{getId:l,getInfo:j,getOrderingInfo:m,getFromCache:g}}]),angular.module("dcomApp").service("MerchantAPI",["$q","$window","$routeParams","SearchLocation","RequestBuilder","Group",function(a,b,c,d,e,f){function g(a,b,c){var g={};if("l"===f.currentGroup()){var h=d.get();angular.isDefined(h.location_id)&&(g.location_id=h.location_id),g.laundry=!0}return c&&(g.order_time=c),e.getRequestPromise({method:"GET",url:o+"/"+a+"/menu/"+b,authToken:!0,params:g})}function h(){var b=a.defer(),e=c.merchantId,f=c.urlStub;if("undefined"==typeof e&&"undefined"==typeof f&&b.reject(),"undefined"!=typeof e)b.resolve(e);else{var g=d.get();k(c.urlStub,g.query).then(function(a){b.resolve(a.merchant.id)},function(){b.reject()})}return b.promise}function i(b){var c=d.get();return k(b,c.query).then(function(b){var c=b.merchant;return c.ordering?c.ordering:a.reject()})}function j(a){var b={};if("l"===f.currentGroup()){var c=d.get();angular.isDefined(c.location_id)&&(b.location_id=c.location_id),b.laundry=!0}return e.getRequestPromise({method:"GET",url:o+"/"+a+"/menu",params:b})}function k(a,b,c){c=c===!1?!1:!0,d.validate();var g=d.get();b=b||g.query;var h={address:b,iso:!0};return"l"===f.currentGroup()&&(angular.isDefined(g.location_id)&&null!==g.location_id&&(h.location_id=g.location_id),h.laundry=!0),e.getRequestPromise({cache:c,method:"GET",url:o+"/"+a,params:h,authToken:!0}).then(function(a){return a.merchant&&a.merchant.summary&&""===a.merchant.summary.notes&&(a.merchant.summary.notes=[]),a})}function l(a,b){for(var c in a)a[c]&&("number"==typeof a[c]||a[c].length)&&(b[c]="min"===c?parseFloat(a[c]):a[c])}function m(a,c,d,f){var g=b.igb,h=2,i=4,j={address:a,reco_sort:h,reco_depth:i,order_type:c,order_time:d};return g&&(j.igb=!0),l(f,j),e.getRequestPromise({method:"POST",url:o+"/recommendations/v2",authToken:!0,disableErrorHandler:!0,data:j})}function n(a){return e.getRequestPromise({method:"GET",url:o+"/recommendations/v2/"+a,authToken:!0})}var o="/merchant";return{getItem:g,getMenu:j,getMerchantInfo:k,getMerchantId:h,getOrderingInfo:i,getDishRecommendations:m,getDishRecOrderInfo:n}}]),angular.module("dcomApp").service("OrderAPI",["RequestBuilder","MerchantAPI","Group",function(a,b,c){function d(a){return p("recent",a,{laundry:!0})}function e(a){return p("favorite",a,{laundry:!0})}function f(a,b,c){return p("recent",b,{merchant_id:a,laundry:c})}function g(a){var d;return h(a,!0).then(function(a){return d=a,c.currentGroup("l"),b.getMerchantInfo(a.merchant_id,a.delivery_address.street+", "+a.delivery_address.zip_code)}).then(function(a){return d.minimum_order_amount=Math.max((a.merchant.ordering.minimum.delivery||0).lowest||0,(a.merchant.ordering.minimum.pickup||0).lowest||0),d})}function h(a,b){return m("recent",a,b)}function i(a){return m("favorite",a)}function j(b,c){return a.getRequestPromise({method:"POST",authToken:!0,url:q+"/favorite/"+b,params:{order_name:c}})}function k(b){return a.getRequestPromise({method:"DELETE",authToken:!0,url:q+"/favorite/"+b})}function l(b,c){return a.getRequestPromise({method:"POST",authToken:!0,url:r+"/"+b,params:{laundry:c.isLaundry},data:{feedback:{quality_rating:c.rating,price_rating:c.rating,speed_rating:c.rating,accuracy_rating:c.rating,overall_rating:c.rating,user_review:c.content,anonymous:!1}}})}function m(b,c,d){var e=q+"/"+b+"/"+c;return"undefined"!=typeof d&&d&&(e+="?laundry=true"),a.getRequestPromise({method:"GET",url:e,authToken:!0}).then(function(a){return a.order})}function n(a){return a.reduce(function(a,b){return a.price>b.price?a:b},{price:0})}function o(a){a.cart=a.cart||a.items||[],a.maxPricedItem=n(a.cart),a.itemNames=a.cart.map(function(a){return a.name}),a.itemCount=a.cart.length,a.detailsLink=a.order_id?"account/orders/"+a.order_id:"account/orders/"+a.orders_id,a.is_laundry_order&&(a.detailsLink+="?laundry=true")}function p(b,c,d){var e={start:0,limit:c};return"undefined"!=typeof d&&angular.extend(e,d),a.getRequestPromise({method:"GET",url:q+"/"+b,authToken:!0,params:e}).then(function(a){return a.orders.forEach(o),a.orders})}var q="/customer/orders",r="/customer/feedback";return{getFavoriteOrders:e,getRecentOrders:d,getRecentMerchantOrders:f,getLaundryOrderWithMinAmount:g,getRecentOrder:h,getFavoriteOrder:i,unsetFavorite:k,setFavorite:j,rateOrder:l}}]),angular.module("dcomApp").service("PriceCompareAPI",["$q","RequestBuilder",function(a,b){function c(){return b.getRequestPromise({method:"GET",url:g+"/show",authToken:!0})}function d(a,c){c=c||{};var d={items:a};return c.clearExisting&&(d.clear_existing_items=!0),b.getRequestPromise({method:"POST",url:g+"/add",authToken:!0,data:d})}function e(){var a;return b.getRequestPromise({method:"DELETE",url:g+"/remove",authToken:!0,data:a})}function f(){return b.getRequestPromise({method:"POST",url:g+"/clear",authToken:!0})}var g="/customer/anoncart";return{getAnonCart:c,addItems:d,removeItems:e,clearAnonCart:f}}]),angular.module("dcomApp").service("RequestBuilder",["$http","$q","$rootScope","UserMessages","DcomConfig","UserAuthToken","GuestAuthToken","$window",function(a,b,c,d,e,f,g,h){function i(a){return"undefined"!=typeof a}function j(f){var g=b.defer();return f.url=e.apiPath+f.url,f.apiKey!==!1&&k(f),f.authToken&&l(f),a(f).success(function(a){g.resolve(a)}).error(function(a,b){if(b>=500)try{h.trackJs.console.error("Error in requestBuilder.js\n   status: "+b+"\n   request: "+JSON.stringify(f)+"\n   data: "+JSON.stringify(a))}catch(e){}var j=i(a)&&i(a.message)?a.message:m.defaultMsg;return 401===b&&angular.isDefined(a.error)&&"unauthorized"===a.error?(g.reject(),void c.$broadcast("fatalError",{code:b})):503===b?(g.reject(),void c.$broadcast("fatalError",{code:b,error_message:j})):f.disableErrorHandler?(a.message=j,void g.reject(a)):(g.reject(j),b in n&&d.printError(n[b]),void(404===b&&""===a&&d.printError(m.noConnection)))}),g.promise}function k(a){var b=["GET","DELETE"],c=["POST","PUT"];-1!==b.indexOf(a.method)?(a.params=a.params||{},a.params.client_id=e.apiKey):-1!==c.indexOf(a.method)?(a.data=a.data||{},a.data.client_id=e.apiKey):angular.noop()}function l(a){a.headers=a.headers||{},f.isSet()?a.headers.Authorization=f.get():g.isSet()?a.headers["Guest-Token"]=g.get():angular.noop()}var m={defaultMsg:[{user_msg:"Oops. There was an error with your request."}],noConnection:[{user_msg:"Oops. We lost you! Please check your internet connection and try again."}]},n={500:m.defaultMsg,502:m.noConnection,504:m.noConnection,0:m.noConnection};return{getRequestPromise:j}}]),angular.module("dcomApp").service("Schedule",["$rootScope","$q","CartProvider","Cookies","RequestBuilder","Group",function(a,b,c,d,e,f){function g(a){var b="/merchant/"+a+"/hours?iso=true";return"l"===f.currentGroup()&&(b+="&laundry=true"),e.getRequestPromise({method:"GET",url:b,authToken:!0})}function h(a,b){var e;if("menu"===a){var f=c.get(b);e=f.getOrderTime()}else"search"===a&&(e=d.getCookie("globalOrderTime"));return"undefined"!=typeof e&&e?e:!1}function i(a,e,f){var g=b.defer();if("menu"===a){var h=c.get(f);h.setOrderTime(e).then(function(){h.reload().then(function(a){n("orderTimeUpdate",e),g.resolve(a)})})}else if("search"===a){var i=d.setExpInHours(3);d.setCookie("globalOrderTime",e,{expires:i}),g.resolve()}return g.promise}function j(a,b){var e;if("menu"===a){var f=c.get(b);e=f.getOrderType()}else"search"===a&&(e=d.getCookie("globalOrderType"));return e}function k(a,e,f){var g=b.defer(),h=d.setExpInHours(3);if(d.setCookie("globalOrderType",e,{expires:h}),g.resolve(),"menu"===a){var i=c.get(f);i.setOrderType(e).then(function(){i.reload().then(function(){n("cartChange"),g.resolve()})})}return g.promise}function l(a,b){var d="";if("menu"===a){var e=c.get(b);d=e.getAvailableOrderTimes()}else if("search"===a){var f=[],g=Date.create(),h=g.getMinutes()/15,i=15*Math.floor(h)%60;g=g.getHours()+":"+("0"+i).slice(-2),g=Date.create(g);var j=1;0===i&&(j=2),g=j.hoursAfter(g);for(var k,l=15,m=6,n=24*(60/l),o=m*n,p=g,q=0;o>q;q++)k=Date.create(p).format(Date.ISO8601_DATETIME),f.push(k),p=Date.create(p.getTime()+6e4*l);Date.create(f[0]).is("today")||(f.unshift(Date.create().format(Date.ISO8601_DATETIME)),f.pop()),d=f}return d}function m(a,b){if("menu"===a){var c=[],d=b.ordering.availability.pickup&&(null!==b.ordering.availability.next_pickup_time||null!==b.ordering.availability.last_pickup_time),e=null!==b.ordering.availability.next_delivery_time||null!==b.ordering.availability.last_delivery_time;return d&&c.unshift("pickup"),e&&c.unshift("delivery"),c}return"search"===a?["delivery","pickup"]:void 0}function n(b,c){a.$broadcast(b,c)}return{getSchedule:g,getOrderTime:h,setOrderTime:i,getOrderType:j,setOrderType:k,getOrderableTimes:l,getOrderableTypes:m}}]).service("ScheduleProvider",["Schedule",function(a){function b(b){this.getSchedule=function(b){return a.getSchedule(b)},this.getOrderTime=function(c){return a.getOrderTime(b,c)},this.setOrderTime=function(c,d){return a.setOrderTime(b,c,d)},this.getOrderType=function(c){return a.getOrderType(b,c)},this.setOrderType=function(c,d){return a.setOrderType(b,c,d)},this.getOrderableTimes=function(c){return a.getOrderableTimes(b,c)},this.getOrderableTypes=function(c){return a.getOrderableTypes(b,c)}}function c(a){return new b(a)}return{set:c}}]),angular.module("dcomApp").service("SearchAPI",["RequestBuilder","Cookies","$location","Group",function(a,b,c,d){function e(e,f,h){var i="undefined"!=typeof b.getCookie("globalOrderType")?b.getCookie("globalOrderType"):"delivery",j="undefined"!=typeof b.getCookie("globalOrderTime")?b.getCookie("globalOrderTime"):"ASAP",k={address:e,order_type:i,order_time:j,enable_recommendations:!0,iso:!0,vertical:d.currentGroup()};return h&&(k.merchant_type="LA"),f&&f.length>0&&(k.keyword=f),c.search().item_name_boost&&(k.item_name_boost=c.search().item_name_boost),c.search().item_description_boost&&(k.item_description_boost=c.search().item_description_boost),c.search().cuisine_boost&&(k.cuisine_boost=c.search().cuisine_boost),c.search().item_name_boost&&(k.item_name_boost=c.search().item_name_boost),c.search().merchant_name_boost&&(k.merchant_name_boost=c.search().merchant_name_boost),c.search().algo&&(k.algo=c.search().algo),c.search().return_all&&(k.return_all=c.search().return_all),a.getRequestPromise({method:"GET",url:g+"/"+i,authToken:!0,params:k,disableErrorHandler:!0})}function f(b,c){var d=angular.extend({iso:!0},c);return a.getRequestPromise({method:"GET",url:"/merchant/"+b,params:d})}var g="/merchant/search";return{searchByAddress:e,searchByTags:f}}]),angular.module("dcomApp").factory("SearchLocation",["$rootScope","KeyValueStorage","Storage","Cookies",function(a,b,c,d){function e(){var a={query:d.getCookie("searchAddress"),latitude:d.getCookie("searchLatitude").toString(),longitude:d.getCookie("searchLongitude").toString(),street:d.getCookie("searchStreet"),city:d.getCookie("searchCity"),state:d.getCookie("searchState"),zip:d.getCookie("searchZip").toString()};h.set(a,365),d.deleteCookie("searchAddress"),d.deleteCookie("searchLatitude"),d.deleteCookie("searchLongitude"),d.deleteCookie("searchStreet"),d.deleteCookie("searchCity"),d.deleteCookie("searchState"),d.deleteCookie("searchZip")}var f="SearchLocation",g={},h=new b(f,g);return"undefined"!=typeof d.getCookie("searchCity")&&e(),h.set=function(b,d){if(b&&b.query){var e=b.query.split(", ");if(e[0].length<=0||isNaN(e[1]))return}c.set(f,b,d),a.search=a.search||{},a.search.query=b.query,a.$broadcast("locationChange",b)},h.unset=function(){c.unset(f),a.$broadcast("locationChange")},h.validate=function(){var b=c.get(f);if(b&&b.query){var d=b.query.split(", ");if(d[0].length>0&&!isNaN(d[1]))return;c.unset(f),a.$broadcast("locationChange")}},h}]),angular.module("dcomApp").service("SystemMessages",["$timeout","$window","Animation",function(a,b,c){function d(){angular.forEach(g.timeouts,function(b){a.clear(b)}),g.timeouts=[],g.outstandingErrors=0,null!==document.getElementById("system-message")&&document.getElementById("system-message").remove()
}function e(d,e,f){var h='<div id="system-message" class="system-message '+e+'"><span>'+d+"</span> <div>";if(angular.element(document.getElementById("site-wrapper")).prepend(angular.element(h)),document.getElementById("system-message").style.display="none",c.slide("down","system-message",.28,!0),b.scrollTo(0,0),"number"==typeof f){var i=g.timeouts,j=a(function(){c.slide("up","system-message",.28,!1,function(){angular.element(document.getElementById("system-message")).remove(),g.outstandingErrors-=1});var a=i.indexOf(j);-1!==a&&i.splice(a,1)},f);g.timeouts.push(j)}}function f(a){g.outstandingErrors>=g.maxOutstandingErrors||(g.outstandingErrors+=1,e(a,"error"))}var g={maxOutstandingErrors:1,outstandingErrors:0,timeouts:[]};return{printError:f,clear:d}}]),angular.module("dcomApp").service("TafAPI",["RequestBuilder",function(a){function b(b){return a.getRequestPromise({method:"GET",url:g+"/verify",authToken:!0,params:{email:b}})}function c(b){var c={method:"GET",url:g+"/bounty"};return angular.isDefined(b)&&(c.params={share_code:b}),a.getRequestPromise(c)}function d(b){return a.getRequestPromise({method:"POST",url:g+"/email",authToken:!0,data:{emails:b}})}function e(){return a.getRequestPromise({method:"GET",url:g+"/report",authToken:!0})}function f(){return a.getRequestPromise({method:"GET",url:g+"/share",authToken:!0})}var g="/taf";return{verifyEmail:b,getBounty:c,addFriends:d,getReport:e,share:f}}]),angular.module("dcomApp").service("User",["$rootScope","$window","$location","$routeParams","$route","$q","UserAPI","OrderAPI","UserAuthToken","GuestAuthToken","Cookies","KeyValueStorage","MerchantSearch",function(a,b,c,d,e,f,g,h,i,j,k,l,m){function n(){return i.get()}function o(){return j.get()}function p(){var a=f.defer();if(n())a.resolve();else{if(!o())return t();a.resolve()}return a.promise}function q(){g.getUserInfo().then(function(c){a.userData=c.user,C.get()===!0?(i.set(i.get(),90),C.set(!0,90)):(i.set(i.get()),C.set(!1)),b.trackJs&&b.trackJs.configure({sessionId:i.get(),userId:c.user.email}),a.$broadcast("authReturn",c.user)},function(){u()})}function r(b,c){c===!1?(i.set(b.access_token),C.set(c),k.setCookie("userIdForGA",b.user.customer_id)):(i.set(b.access_token,90),C.set(c,90),k.setCookie("userIdForGA",b.user.customer_id,{expires:90})),j.unset(),a.userData=b.user,a.$broadcast("authSuccess",b.user),y()}function s(c,d,e){z||(z=!0,g.authenticate(c,d).then(function(a){r(a,e),z=!1,b.dataLayer.push({event:"userAuthenticated"}),window.optimizely=window.optimizely||[],window.optimizely.push(["trackEvent","userAuthenticated"]),b.trackJs&&b.trackJs.configure({sessionId:i.get(),userId:a.user.email}),v()},function(b){a.$broadcast("authFailure",{messages:b}),z=!1}))}function t(){return g.authenticateGuest().then(function(c){j.set(c["Guest-Token"],30),a.$broadcast("guestCreateSuccess",c.guest_token),b.trackJs&&b.trackJs.configure({sessionId:j.get(),userId:"GuestUser"})},function(b){a.$broadcast("guestCreateFailure",{messages:b})})}function u(){i.unset(),C.unset(),k.deleteCookie("userIdForGA"),a.userData=null,b.dataLayer.push({event:"UserAction",eventCategory:"User",eventAction:"Logout"});var d=c.search();d.logout=1,c.search(d),c.replace(b.location.href),a.$broadcast("logout"),y()}function v(){var a=k.getCookie("deal_id"),b=k.getCookie("deal_code");a?g.applyPromoDeal(a).then(function(){k.deleteCookie("deal_id")}):b&&g.applyPromoDealByCode(b).then(function(){g.applyPromoDealByCode(b,null,!0).then(function(){}),k.deleteCookie("deal_code")})}function w(a,c,d,e,f){var h={first_name:a,last_name:c,email:d,password:e};return k.getCookie("uhauid")?h.uhauid=k.getCookie("uhauid"):k.getCookie("tafshareid")&&(h.share_code=k.getCookie("tafshareid")),g.createUser(h).then(function(a){r(a,f);var c=angular.isDefined(a.user.customer_id)&&null!==a.user.customer_id?a.user.customer_id:-1,d=angular.isDefined(a.user.life_time_orders_count)&&null!==a.user.life_time_orders_count?a.user.life_time_orders_count:-1;b.dataLayer.push({event:"userSignup",userId:c,numOrders:d}),window.optimizely=window.optimizely||[],window.optimizely.push(["trackEvent","userSignup"]),b.trackJs&&b.trackJs.configure({sessionId:i.get(),userId:a.user.email}),(k.getCookie("deal_id")||k.getCookie("deal_code"))&&v()})}function x(){var a,b=c.url();return n()?!1:(a=c.search().logout?1:null,a&&(b=null),c.path("/account/login"),void c.search({next:b,logout:a}))}function y(){m.overrideCacheForNextSearch(),m.overrideCacheForNextMerchantUpdate(),(d.address||d.geo)&&e.reload()}var z=!1,A="RememberMe",B=!1,C=new l(A,B);return b.dataLayer=b.dataLayer||[],i.isSet()&&(q(),v()),{getUserAuthToken:n,getGuestAuthToken:o,authenticateUser:s,createGuestSession:t,updateUserInfo:q,initializeSession:p,logout:u,createUser:w,pageRequiresLogin:x}}]),angular.module("dcomApp").service("Carts",["$rootScope","$q","CartAPI","Cookies","UserMessages","SessionCache",function(a,b,c,d,e,f){function g(a,b,c,d){var e={orderType:b,orderTime:c,cart_data:d},g="cart_"+a;f.get(g)||f.initialize(g,J),f.store(g,e)}function h(a){var b="cart_"+a;f.clear(b)}function i(a,d,f,i){var j=b.defer();if(!z(d))return b.reject(O.cartNotReady);w();var k=L[d];return c.addItem(a,{merchant:d,orderType:k.orderType,orderTime:k.orderTime},f,i).then(function(a){g(d,k.orderType,k.orderTime,a),A(a,k),x(),B(),j.resolve()},function(a){x(),e.printAPIMessage(a),h(d),j.reject(a)}),j.promise}function j(a,d){var f=b.defer();if(!z(d))return b.reject(O.cartNotReady);var i=L[d];return w(),c.editItem(a,{merchant:d,orderType:i.orderType,orderTime:i.orderTime}).then(function(a){g(d,i.orderType,i.orderTime,a),A(a,i),x(),B(),f.resolve()},function(a){x(),e.printAPIMessage(a),h(d),f.reject(a)}),f.promise}function k(a,d){var f=b.defer();if(!z(d))return b.reject(O.cartNotReady);w();var i=L[d];return c.removeItem(a,{merchant:d,orderType:i.orderType,orderTime:i.orderTime}).then(function(a){g(d,i.orderType,i.orderTime,a),A(a,i),x(),B(),f.resolve()},function(a){x(),e.printAPIMessage(a),h(d),f.reject(a)}),f.promise}function l(a){if(E(a)){var b=L[a],c={subtotal:b.subtotal,total:b.total,tax:b.tax,item_count:b.item_count,order_time:b.order_time,fees:b.fees,discount:b.discount,discount_percent:b.discount_percent,delivery_points:b.delivery_points,minutes_left_for_asap_order:b.minutes_left_for_asap_order};return angular.isDefined(b.laundry_pickup_time)&&(c.laundry_pickup_time=b.laundry_pickup_time),angular.isDefined(b.laundry_pickup_options)&&(c.laundry_pickup_options=b.laundry_pickup_options),angular.isDefined(b.laundry_delivery_time)&&(c.laundry_delivery_time=b.laundry_delivery_time),angular.isDefined(b.laundry_delivery_options)&&(c.laundry_delivery_options=b.laundry_delivery_options),c}}function m(a){if(E(a)){var b=L[a];return b.orderable_times}}function n(a){if(E(a)){var b=L[a];return b.laundry_pickup_times}}function o(a,b){E(a)&&(L[a].laundry_pickup_time=b)}function p(a,b){E(a)&&(L[a].laundry_delivery_time=b)}function q(a,b){E(a)&&(L[a].laundry_delivery_options=b)}function r(a,b){E(a)&&(L[a].laundry_pickup_options=b)}function s(a){return E(a)?L[a].cart:void 0}function t(a,d){var e,i,j=b.defer(),k=L[a];angular.isDefined(d)?(e=d.orderType,i=d.orderTime):(e=G(a),i=I(a));var l=f.get("cart_"+a);if(l.data&&l.data.orderType===e&&l.data.orderTime===i&&!f.hasExpired("cart_"+a))x(),B(),j.resolve(l.data.cart_data);else{if(y())return j.reject({message:"cart_locked"}),j.promise;w(),c.getCart({merchant:a,orderType:e,orderTime:i}).then(function(b){g(a,e,i,b),A(b,k),x(),k.orderType!==e&&(k.orderType=e),B(),j.resolve(b)},function(b){A(b,k),x(),h(a),B(),j.reject(b)})}return j.promise}function u(a,b){return K++,v(a,b)}function v(a,c){var d=b.defer();return K>0&&t(a,c).then(function(a){K--,d.resolve(a),x()},function(a){d.reject("cart_locked"===a.message?a:a)}),d.promise}function w(){M=!0}function x(){M=!1}function y(){return M}function z(a){return M||!E(a)?!1:!0}function A(a,b){b=angular.extend(b,a)}function B(){a.$broadcast("cartChange")}function C(){a.$broadcast("externalCartChange")}function D(a){if(!E(a)){L[a]={merchant:a,orderType:G(a),orderTime:I(a)};var b="cart_"+a;f.initialize(b,J)}}function E(a){return"undefined"!=typeof L[a]}function F(a,c){var e=b.defer();if(E(c)){var f=L[c];if(-1!==N.orderTypes.indexOf(a)){f.orderType=a;var g=d.setExpInHours(3);return d.setCookie(c+"_orderType",a,{expires:g}),B(),e.resolve(),e.promise}}}function G(a){return E(a)?d.getCookie("globalOrderType")&&!d.getCookie(a+"_orderType")?d.getCookie("globalOrderType"):d.getCookie(a+"_orderType")?d.getCookie(a+"_orderType"):"delivery":void 0}function H(a,c){var e=b.defer();if(E(c)){var f=L[c];f.orderTime="ASAP"===a?a:Date.create(a).format(Date.ISO8601_DATETIME);var g=d.setExpInHours(3);return d.setCookie(c+"_orderTime",a,{expires:g}),B(),e.resolve(),e.promise}}function I(a){return E(a)?d.getCookie("globalOrderTime")&&!d.getCookie(a+"_orderTime")?d.getCookie("globalOrderTime"):d.getCookie(a+"_orderTime")?d.getCookie(a+"_orderTime"):"ASAP":void 0}var J=1,K=0,L={},M=!1,N={defaultOrderType:"delivery",orderTypes:["delivery","pickup"]},O={cartNotReady:{message:{user_msg:"Please try again.",dev_msg:"The cart is not ready."}}};return{add:i,edit:j,remove:k,reload:u,getInfo:l,isInUse:y,getItems:s,setOrderType:F,getOrderType:G,setOrderTime:H,getOrderTime:I,getAvailableOrderTimes:m,getLaundryPickupTimes:n,setLaundryDeliveryTime:p,setLaundryPickupTime:o,setLaundryPickupOptions:r,setLaundryDeliveryOptions:q,initializeCart:D,broadcastExternalChange:C,clearCachedCart:h}}]).service("CartProvider",["Carts",function(a){function b(b){this.add=function(c,d,e){return a.add(c,b,d,e)},this.remove=function(c){return a.remove(c,b)},this.edit=function(c){return a.edit(c,b)},this.getInfo=function(){return a.getInfo(b)},this.getItems=function(){return a.getItems(b)},this.reload=function(c){return a.reload(b,c)},this.setOrderType=function(c){return a.setOrderType(c,b)},this.getOrderType=function(){return a.getOrderType(b)},this.getAvailableOrderTimes=function(){return a.getAvailableOrderTimes(b)},this.setOrderTime=function(c){return a.setOrderTime(c,b)},this.getOrderTime=function(){return a.getOrderTime(b)},this.isInUse=function(){return a.isInUse()},this.getLaundryPickupTimes=function(){return a.getLaundryPickupTimes(b)},this.setLaundryPickupTime=function(c){return a.setLaundryPickupTime(b,c)},this.setLaundryDeliveryTime=function(c){return a.setLaundryDeliveryTime(b,c)},this.setLaundryDeliveryOptions=function(c){return a.setLaundryDeliveryOptions(b,c)},this.setLaundryPickupOptions=function(c){return a.setLaundryPickupOptions(b,c)},this.broadcastExternalChange=function(){return a.broadcastExternalChange()},this.clearCachedCart=function(){return a.clearCachedCart(b)}}function c(c){return a.initializeCart(c),new b(c)}return{get:c}}]),angular.module("dcomApp").service("UserAPI",["DcomConfig","RequestBuilder","Group",function(a,b,c){function d(c,d){return b.getRequestPromise({method:"POST",url:p+"/auth",authToken:!0,data:{username:c,password:d,grant_type:"password",client_secret:a.clientSecret,scope:"payment,global"}})}function e(){return b.getRequestPromise({method:"GET",url:p+"/auth/guest"})}function f(c){return b.getRequestPromise({method:"POST",url:p+"/account",authToken:!0,data:angular.extend(c,{grant_type:"password",client_secret:a.clientSecret,scope:"payment,global"})})}function g(a,d,e){var f={deal_code:a};return angular.isDefined(d)&&null!==d&&(f.merchant_id=d),("l"===c.currentGroup()||angular.isDefined(e)&&e===!0)&&(f.laundry=!0),b.getRequestPromise({method:"POST",url:p+"/promo/deal",data:f,authToken:!0})}function h(a){return b.getRequestPromise({method:"POST",url:p+"/promo/deal",data:{deal_id:a},authToken:!0})}function i(){return b.getRequestPromise({method:"GET",url:p+"/account",authToken:!0})}function j(a){return b.getRequestPromise({method:"DELETE",url:p+"/password/reset/"+a})}function k(a,c){return b.getRequestPromise({method:"PUT",url:p+"/password/token",data:{token:a,password:c}})}function l(c){return b.getRequestPromise({method:"PUT",url:p+"/account",authToken:!0,data:{first_name:c.firstName,last_name:c.lastName,email:c.email,password:c.confirmPassword,client_secret:a.clientSecret}})}function m(){var a={};return"l"===c.currentGroup()&&(a.laundry=!0),b.getRequestPromise({method:"GET",url:p+"/cc",authToken:!0,params:a})}function n(a){var d={cc_number:a.ccNumber.replace(/ /g,""),exp_month:a.expMonth,exp_year:a.expYear,cvv:a.cvv,billing_zip:a.billingZip};return angular.isDefined(a.save)&&(d.save=a.save,d.merchant_id=a.merchant_id),"l"===c.currentGroup()&&(d.laundry=!0),b.getRequestPromise({method:"POST",url:p+"/cc",authToken:!0,data:d})}function o(a){var d={};return"l"===c.currentGroup()&&(d.laundry=!0),b.getRequestPromise({method:"DELETE",url:p+"/cc/"+a,authToken:!0,data:d})}var p="/customer";return{authenticate:d,authenticateGuest:e,getUserInfo:i,createUser:f,applyPromoDeal:h,applyPromoDealByCode:g,resetPassword:j,setNewPassword:k,getCreditCards:m,addCreditCard:n,removeCreditCard:o,updateProfile:l}}]),angular.module("dcomApp").service("UserMessages",["$q","$modal","ModalService",function(a,b,c){function d(a){if(!(j.outstandingErrors>=j.maxOutstandingErrors)){j.outstandingErrors+=1;var b=e(a);b.closePromise.then(function(){j.outstandingErrors-=1},function(){j.outstandingErrors-=1})}}function e(a){var b=angular.copy(k),c=angular.extend(b,{message:a});return g(c)}function f(a){a.message;a.message instanceof Array||(a.message=[a.message]),a.message=a.message.map(function(a){return{user_msg:a}});var b=angular.copy(k),c=angular.extend(b,a);return g(c)}function g(a){var b=c.open({templateUrl:"views/modals/defaultError.html",data:{message:a.message,ok:a.ok,title:a.title},className:"medium default-notice-modal"});return b}function h(c){c=c||{};var d=a.defer(),e='<div class="modal-header"><button type="button" class="close" ng-click="$dismiss()" aria-hidden="true">&times;</button><h3>{{settings.title}}</h3></div><div class="modal-body"><p ng-bind-html=\'settings.message\'></p></div><div class="modal-footer"><div><a ng-if="settings.cancel" ng-click="$dismiss()" class="button secondary">{{settings.cancel}}</a><a ng-click="$close()" class="button primary">{{settings.ok}}</a></div></div>',f=b.open({template:e,windowClass:c.windowClass||"confirmation-modal",controller:["$scope","settings",function(a,b){a.settings=b}],backdrop:"static",resolve:{settings:function(){return c}}});return f.result.then(function(a){d.resolve(a)},function(){d.reject()}),d.promise}function i(a,b,c,d,e){e&&(c="<"+c+">",d="</"+d+">");for(var f in b)if(b.hasOwnProperty(f)){var g=new RegExp(":"+f,"g");a=a.replace(g,c+b[f]+d)}return a}var j={maxOutstandingErrors:1,outstandingErrors:0},k={message:[{user_msg:""}],title:"Oops",ok:"Ok"};return{printError:d,printMessage:f,printAPIMessage:e,askConfirmation:h,buildErrorString:i}}]),angular.module("dcomApp").service("MarketingAPI",["RequestBuilder",function(a){function b(){return a.getRequestPromise({method:"GET",url:e+"/deals",authToken:!0})}function c(b,c){return a.getRequestPromise({method:"POST",url:e+"/acq_method",authToken:!0,data:{uhau_name:b,uhau_deal_id:c}})}function d(b){var c={order_id:b};return a.getRequestPromise({method:"GET",url:e+"/fortunecookie",params:c,disableErrorHandler:!0,authToken:!0})}var e="/marketing";return{getDealsAndUhau:b,postNewUhau:c,getFortuneCookieText:d}}]),function(){function a(a,b){return angular.forEach(b,function(b,c){a=a.replace("{"+c+"}",b)}),a}function b(a){return a&&a.prizes&&a.prizes.gift_prizes?(a.prizes.buckets=p.map(function(b){return{bucket:b,prizes:e(a.prizes.gift_prizes,b)}}),a):a}function c(a){return a&&a.prizes&&a.prizes.charity_prizes?(a.prizes.charity_prizes=a.prizes.charity_prizes.map(d),a):a}function d(a){return angular.forEach(a.prize_options,function(b){a.minValue=Math.min(b.charity_amount,a.minValue||b.charity_amount),a.maxValue=Math.max(b.charity_amount,a.maxValue||b.charity_amount),a.minPoint=Math.min(b.points_needed,a.minPoint||b.points_needed),a.maxPoint=Math.max(b.points_needed,a.maxPoint||b.points_needed)}),a}function e(a,b){return a.filter(function(a){return a.points_needed===b.point}).sort(f)}function f(a,b){var c=g(a)?0:1,d=g(b)?0:1;return c-d}function g(a){return angular.isDefined(a)&&-1!==a.name.search("delivery.com Credit")}function h(a){return angular.isDefined(a)&&!!a.charity_id}function i(a){return!g(a)&&!h(a)}function j(){return p}function k(a){return a.name.split(" ").filter(function(a){return-1!==a.indexOf("$")})[0]||"$5"}function l(a){return n=a,a}function m(a,b){var c=a.defer();return c.resolve(b),c.promise}var n,o={GET_PRIZES:"/marketing/prizes",REDEEM_PRIZE:"/marketing/redeem/{prize_id}"},p=[{point:5e3,value:5},{point:9500,value:10},{point:18e3,value:20}];angular.module("dcomApp").service("DeliveryPoints",["RequestBuilder","$q",function(d,e){function f(){return n?m(e,n):d.getRequestPromise({method:"GET",url:o.GET_PRIZES,authToken:!0}).then(b).then(c).then(l)}function p(b){return d.getRequestPromise({method:"POST",data:b,url:a(o.REDEEM_PRIZE,b),authToken:!0})}return{getPrizes:f,redeemPrize:p,isDonation:h,isDeliveryDollars:g,isItem:i,getPrizeValue:k,getBuckets:j}}])}(),angular.module("dcomApp").service("MerchantReferral",["RequestBuilder","$location","Cookies",function(a,b,c){function d(){angular.isDefined(b.search().cq)?(g=b.search().cq,e(g).then(function(a){angular.isDefined(a.decrypted.tracking_rid)&&(h=a.decrypted.tracking_rid,c.setCookie("order_tracking",h,{expires:365}))})):angular.isDefined(c.getCookie("order_tracking"))&&(h=c.getCookie("order_tracking"))}function e(b){return a.getRequestPromise({method:"GET",url:"/decrypt",params:{order_tracking:b}})}function f(){return h}var g=null,h=null;return{loadParam:d,decrypt:e,param:f}}]),angular.module("dcomApp").service("Urls",function(){function a(a,b){var c=b?a:a.summary.url,d=c.geo_tag,e=c.merchant_type,f=c.short_tag;return"/cities/"+d+"/categories/"+e+"/"+f}function b(a){var b=a.summary.url.merchant_type;return"/checkout/"+b+"/"+a.id}return{getMerchantUrl:a,getCheckoutUrl:b}}),angular.module("dcomApp").service("Visitors",["Cookies",function(a){function b(){e=a.getCookie("firstVisit")||!1;var b=!0;return e&&(b=!1),d(),b}function c(a){return e&&e.isAfter(a)?!0:!1}function d(){var b=a.getCookie("firstVisit")||Date.create().format();a.setCookie("firstVisit",b,{expires:365})}var e;return{isNew:b,firstVisitedAfter:c,recordVisit:d}}]),angular.module("dcomApp").service("olarkChat",["$rootScope","$window","User","OrderAPI","DateService",function(a,b,c,d,e){function f(a,c){b.dataLayer.push({event:"HeaderAction",eventCategory:"Chat",eventAction:"Chat initiated - "+a+" checkout",eventLabel:"Logged "+c})}function g(){c.getUserAuthToken()?d.getRecentOrders(1).then(function(a){var b=!a.length||a[0]&&!e.isWithinHours(Date.create(a[0].order_date),24)?"pre":"post";f(b,"in")}):f("pre","out")}function h(){m||(b.olark("api.chat.onBeginConversation",g),m=!0)}var i,j,k,l,m=!1;return b.dataLayer=b.dataLayer||[],i=function(){a.userData&&this.updateUserInfo(),b.olark("api.box.expand"),h()},j=function(){k=String(a.userData.email),l=String(a.userData.first_name+" "+a.userData.last_name),b.olark("api.visitor.updateEmailAddress",{emailAddress:k}),b.olark("api.visitor.updateFullName",{fullName:l})},{open:i,updateUserInfo:j}}]),angular.module("dcomApp").service("ScrollHandler",["$rootScope","$window",function(a,b){function c(){return h?(g=b.getScrollTop(),!0):!1}function d(){h=!0}function e(){h=!1}function f(){return g}var g=0,h=!1;return b.getScrollTop=function(){return window.scrollY||document.documentElement.scrollTop},{updatePosition:c,startRecording:d,stopRecording:e,getPosition:f}}]),angular.module("dcomApp").service("NewUserPromo",["$q","$modal","$modalStack","$location","$window","User","Cookies","Visitors","ModalPages",function(a,b,c,d,e,f,g,h,i){e.dataLayer=e.dataLayer||[];var j,k,l;return j=function(){var a=d.search();return 0!==Object.keys(a).length?(h.recordVisit(),!1):f.getUserAuthToken()?(h.recordVisit(),!1):g.getCookie("newUserPromo")?(h.recordVisit(),l(),!1):"undefined"!=typeof c.getTop()?(h.recordVisit(),!1):h.isNew()?!0:void 0},k=function(){var c=a.defer();if(this.userValidForPromo()){if(window.newUserModalType&&2===window.newUserModalType)g.setCookie("deal_code",window.newUserDiscountCode,{expires:7}),i.openPage("signup");else if(window.newUserModalType&&1===window.newUserModalType){var f=b.open({templateUrl:"/views/modals/newUserPromoModal.html",windowClass:"new-user-promo-modal",controller:"NewUserPromoCtrl"});f.result.then(function(a){c.resolve(a)},function(){c.reject()})}else i.openPage("signup");e.dataLayer.push({event:"HomePageAction",eventCategory:"Homepage",eventAction:"New User Promo Displayed",eventLabel:d.absUrl()}),this.setPromoCookie()}else c.reject();return c.promise},l=function(){g.setCookie("newUserPromo","yes",{expires:365})},{activateModal:k,userValidForPromo:j,setPromoCookie:l}}]),angular.module("dcomApp").service("SEOUrlBuilder",["Group","$location","$rootScope",function(a,b,c){function d(a){return a.toLowerCase().replace(/\s/g,"-").replace("&","and")}function e(){return s}function f(){return p}function g(){return l}function h(){return o}function i(a){var b=a.split("/").splice(1);if(-1!==b.indexOf("zipcodes"))return null;var c=null,d=null,e=null,f=null;if(m[b[1]]&&(c=m[b[1]]),-1!==b.indexOf("neighborhoods")){var g=b[b.indexOf("neighborhoods")+1];if(!o[g])return null;d=g}if(-1!==b.indexOf("categories")){var h=b[b.indexOf("categories")+1];if(!s.indexOf(-1!==h))return null;f=h}if(d&&7===b.length||!d&&-1!==b.indexOf("food")&&5===b.length){if(!q[b[4]])return null;e=q[b[4]]}return d&&e?"/"+d+"/"+e:d&&f?"/"+d+"/"+f:c&&e?"/"+c+"/"+e:c&&f?"/"+c+"/"+f:null}function j(a){var b="/cities/"+a.city;a.group?(b+="/categories/"+a.group,a.cuisine&&(b+="/"+a.cuisine)):a.category?b+="/categories/"+a.category:a.merchant_type?b+="/categories/"+a.merchant_type:a.merchant_type&&(b+="/categories/"+a.merchant_type),a.zipcode&&(b+="/zipcodes/"+a.zipcode),a.neighborhood&&(b+="/neighborhoods/"+a.neighborhood),b=d(b);var c=i(b);return c?c:b}function k(){var a="";if(c.tempCanonicalUrl){var d=c.tempCanonicalUrl;return c.tempCanonicalUrl=null,b.search().page&&(a="?page="+b.search().page),d+a}var e=i(b.path());return e&&b.path()!==e?(b.search().page&&(a="?page="+b.search().page),b.protocol()+"://"+b.host()+e+a):null}var l={"new-york":"nyc","san-francisco":"sf",sf:"sf",chicago:"chicago",ch:"ch",la:"la","los-angeles":"la",dc:"dc",washington:"dc",austin:"austin",boston:"boston",bronx:"bronx",brooklyn:"brooklyn","jersey-city":"jersey-city",queens:"queens",arlington:"arlington","san-jose":"san-jose",somerville:"somerville",stamford:"stamford",cambridge:"cambridge",dallas:"dallas",denver:"denver",philadelphia:"philadelphia",atlanta:"atlanta",hoboken:"hoboken",miami:"miami"},m={};for(var n in l)l.hasOwnProperty(n)&&(m[l[n]]=n);var o={"east-village":"nyc",downtown:"nyc","upper-east-side":"nyc",midtown:"nyc","kips-bay":"nyc","theater-district-times-square":"nyc","lincoln-square":"nyc","upper-west-side":"nyc","garment-district":"nyc","manhattan-valley":"nyc",chelsea:"nyc","lenox-hill":"nyc","midtown-east":"nyc","morningside-heights":"nyc",uptown:"nyc",clinton:"nyc","gramercy-park":"nyc","greenwich-village":"nyc","lower-east-side":"nyc",yorkville:"nyc",nolita:"nyc","hamilton-heights":"nyc","midtown-center":"nyc","flatiron-district":"nyc",tribeca:"nyc","murray-hill":"nyc","alphabet-city":"nyc",harlem:"nyc","union-square":"nyc","west-village":"nyc","two-bridges":"nyc","midtown-south-central":"nyc",soho:"nyc","east-harlem":"nyc","financial-district":"nyc","little-italy":"nyc","stuyvesant-town":"nyc","washington-heights":"nyc",noho:"nyc",bowery:"nyc","hell's-kitchen":"nyc",chinatown:"nyc",manhattanville:"nyc",koreatown:"nyc",inwood:"nyc","sutton-place":"nyc","fort-george":"nyc","meatpacking-district":"nyc","civic-center":"nyc","battery-park-city":"nyc",greenpoint:"brooklyn",williamsburg:"brooklyn","east-williamsburg":"brooklyn","columbia-street-waterfront-district":"brooklyn","brooklyn-heights":"brooklyn","sunset-park":"brooklyn",greenwood:"brooklyn","fort-greene":"brooklyn","prospect-heights":"brooklyn",bushwick:"brooklyn",gravesend:"brooklyn","boerum-hill":"brooklyn","bedford-stuyvesant":"brooklyn","park-slope":"brooklyn","clinton-hill":"brooklyn","borough-park":"brooklyn","prospect-lefferts-gardens":"brooklyn",gowanus:"brooklyn",bensonhurst:"brooklyn","sheepshead-bay":"brooklyn","bay-ridge-fort-hamilton":"brooklyn","ocean-hill":"brooklyn","cobble-hill":"brooklyn","windsor-terrace":"brooklyn","crown-heights":"brooklyn","downtown-brooklyn":"brooklyn",flatlands:"brooklyn","carroll-gardens":"brooklyn",midwood:"brooklyn","ocean-parkway":"brooklyn","flatbush-ditmas-park":"brooklyn","kensington-parkville":"brooklyn","dyker-heights":"brooklyn","coney-island":"brooklyn","bath-beach":"brooklyn","east-flatbush":"brooklyn",mapleton:"brooklyn","east-new-york":"brooklyn","city-line":"brooklyn","marine-park":"brooklyn",dumbo:"brooklyn","prospect-park-south":"brooklyn","bergen-beach":"brooklyn",georgetown:"brooklyn","brighton-beach":"brooklyn",brownsville:"brooklyn"},p={pizza:"pizza","chinese-food":"chinese","mexican-food":"mexican","thai-food":"thai",sushi:"sushi","fast-food":"fast-food",american:"american",bbq:"BBQ",deli:"deli","indian-food":"indian","mediterranean-food":"mediterranean","vegetarian-food":"vegetarian","asian-food":"asian",breakfast:"breakfast",desserts:"desserts","italian-food":"italian","middle-eastern-food":"middle-eastern",wings:"wings",bagels:"bagels",burgers:"burgers",fusion:"fusion","japanese-food":"japanese",sandwiches:"sandwiches"},q={};for(var r in p)p.hasOwnProperty(r)&&(q[p[r]]=r);for(var s=[],t=a.getSearchEnabled(),u=0;u<t.length;u++){var v=t[u];s.push(d(v.name));for(var w=0;w<v.categories.length;w++)s.push(d(v.categories[w]));for(var x=0;x<v.verticals.length;x++)s.push(d(v.verticals[x]))}return{urlFriendlyFormat:d,getShortUrl:i,buildUrl:j,getCanonical:k,getSupportedCities:g,getSupportedNeighborhoods:h,getSupportedCuisines:f,getSupportedCategories:e}}]),angular.module("dcomApp").service("PopularItems",function(){function a(a){-1===e.indexOf(a.id)&&(d.push(a),e.push(a.id))}function b(){return d}function c(){d=[],e=[]}var d=[],e=[];return{appendPopularItem:a,getPopularItems:b,initializePopularItems:c}}).service("PopularItemsProvider",["PopularItems",function(a){function b(){this.appendItem=function(b){return a.appendPopularItem(b)},this.getItems=function(){return a.getPopularItems()}}function c(){return a.initializePopularItems(),e=new b}function d(){return e}var e;return{getNewInterface:c,getCurrentInterface:d}}]),angular.module("dcomApp").service("MenuSchedules",["DateService",function(a){function b(b,c){for(var d,e=c,f=0;f<e.length;f++)if(e[f].id===b){d=e[f].times;break}return d.sort(function(b,c){return a.getStandardizedDate(b.from).getTime()-a.getStandardizedDate(c.from).getTime()}),d}function c(b){var c,d,e,f,g,h=[];for(var i in b)c=a.getStandardizedDate(b[i].from),d=a.getRelativeDayOfTheWeek(c),e=a.formatTime(c),f=a.formatTime(a.getStandardizedDate(b[i].to)),g=e+" - "+f,h.push({day:d,hours:g});return h}return{sortedRelativeSchedule:b,formatMenuSchedule:c}}]),angular.module("dcomApp").service("DateService",["$rootScope",function(){function a(){return(new Date).getTimezoneOffset()}function b(b){if(b.length<=19)return 0;var c="+"===b.substr(19,1)?-1:1,d=parseInt(b.substr(20,2),10)||0,e=parseInt(b.substr(22,2),10)||0;return c*(60*d+e)-a()}function c(a){return a instanceof Date?a:"number"==typeof a?new Date(a):"string"!=typeof a?new Date:new Date(parseInt(a.substr(0,4),10),parseInt(a.substr(5,2),10)-1,parseInt(a.substr(8,2),10),parseInt(a.substr(11,2),10),parseInt(a.substr(14,2),10)+b(a),parseInt(a.substr(17,2),10))}function d(a){var b=a.getDate(),c=a.setDate(b+1);return c=new Date(c)}function e(a){var b=angular.copy(a);return b.setHours(0),b.setMinutes(0),b.setSeconds(0),b}function f(a,b){var c=e(b),f=e(d(b));return a>=c.getTime()&&a<f.getTime()?!0:!1}function g(a){var b=new Date;return f(a,b)}function h(a){var b=new Date,c=d(b);return f(a,c)}function i(a){if(g(a.getTime()))return"Today";if(h(a.getTime()))return"Tomorrow";var b=["Sun","Mon","Tue","Wed","Thu","Fri","Sat","Sun"];return b[a.getWeekday()]}function j(a){var b,c=a.getHours(),d=a.getMinutes();return c>=12?(c>12&&(c-=12),b="pm"):(0===c&&(c=12),b="am"),10>d&&(d="0"+d),c+":"+d+b}function k(a,b){var c=(Date.now()-a.getTime())/1e3/60/60;return b>=c}function l(a){var b=new Date,c=b.getMonth()+1;a&&(c=m[c-1]);var d=b.getDate(),e=b.getFullYear();return[c,d,e]}var m=["Jan","Feb","Mar","Apr","May","June","July","Aug","Sep","Oct","Nov","Dec"];return{getStandardizedDate:c,isToday:g,isTomorrow:h,getRelativeDayOfTheWeek:i,formatTime:j,isWithinHours:k,formatCurrentDay:l}}]),angular.module("dcomApp").service("Reorder",["$rootScope","$route","$q","$modal","$location","UserMessages","CartAPI","SearchLocation","ScheduleProvider",function(a,b,c,d,e,f,g,h,i){function j(j,k,l,m){var n,o=c.defer(),p=j.order_id?j.order_id:j.orders_id;return g.reorder(p,k).then(function(c){var g=c.location;if(h.set({query:g.street+", "+g.zip_code,latitude:g.latitude,longitude:g.longitude,street:g.street,city:g.city,state:g.state,zip:g.zip_code},365),l){var p=i.set("menu");p.setOrderType(j.type,j.merchant_id),a.$broadcast("cartChange",{change:"orderType"})}if("laundry"===k)n=!0;else{var q=c.message_raw;if(0!==q.length){c.message_formatted=[];for(var r=0;r<q.length;r++)q[r].msg_obj.user_msg&&c.message_formatted.push(f.buildErrorString(q[r].msg_obj.user_msg,q[r].replacements,"strong","strong",!0));d.open({templateUrl:"views/modals/reorderErrorMessage.html",windowClass:"reorder-error-modal",controller:["$scope",function(a){a.isOrderDetails=!0,a.errors=c.message_formatted,a.location=c.location,a.okay=function(){a.$dismiss("okay"),e.path("/cities/"+c.url.geo_tag+"/categories/"+c.url.merchant_type+"/"+c.url.short_tag)}}]}),n=!1}else n=!0,m&&b.reload()}n?o.resolve(c):o.reject(c)},function(a){o.reject(a)}),o.promise}return{reorder:j}}]),angular.module("dcomApp").service("SessionCache",["MerchantAPI","$q","SearchLocation","$routeParams","$rootScope",function(){function a(a,b){g[a]={expiration:b,data:null,time_stored:null}}function b(a,b){g[a].data=b,g[a].time_stored=Date.now()}function c(b){a(b,g[b].expiration)}function d(a){return g[a]}function e(a){return a/1e3/60}function f(a){var b=Date.now(),c=e(b-g[a].time_stored);return c>g[a].expiration?!0:!1}var g={};return{initialize:a,get:d,store:b,clear:c,hasExpired:f}}]),function(){function a(a,c){var d=a;for(var e in c)d=b(d,"{"+e+"}",c[e]);return d}function b(a,b,c){for(var d=a;-1!==d.indexOf(b);)d=d.replace(b,c);return d}function c(a){return function(b){return b[a]}}var d={TIME_WINDOW:"/brinkmat/merchant/{merchantId}",RECURRING_ORDER_LIST:"/brinkmat/customer/recurringOrders",RECURRING_ORDER_DETAIL:"/brinkmat/customer/recurringOrders/{orderId}"};angular.module("dcomApp").service("LaundryRepeatOrderService",["RequestBuilder",function(b){var e={};return e.getPickupTimes=function(e,f,g){return b.getRequestPromise({method:"GET",url:a(d.TIME_WINDOW,{merchantId:e}),authToken:!0,params:{location_id:f,type:g}}).then(c("times"))},e.getDeliveryTimes=function(e,f,g,h){return b.getRequestPromise({method:"GET",url:a(d.TIME_WINDOW,{merchantId:e}),authToken:!0,params:{location_id:f,type:g,pickup_time:h}}).then(c("times"))},e.getOrders=function(){return b.getRequestPromise({method:"GET",url:d.RECURRING_ORDER_LIST,authToken:!0}).then(c("orders"))},e.getOrderDetails=function(e){return b.getRequestPromise({method:"GET",url:a(d.RECURRING_ORDER_DETAIL,{orderId:e}),authToken:!0}).then(c("order"))},e.createOrder=function(a){return b.getRequestPromise({method:"POST",url:d.RECURRING_ORDER_LIST,authToken:!0,params:a}).then(c("orders"))},e.updateOrder=function(e,f){return b.getRequestPromise({method:"PUT",url:a(d.RECURRING_ORDER_DETAIL,{orderId:e}),authToken:!0,params:f}).then(c("orders"))},e.deleteOrder=function(e){return b.getRequestPromise({method:"DELETE",url:a(d.RECURRING_ORDER_DETAIL,{orderId:e}),authToken:!0}).then(c("orders"))},e}])}();